(function(n){function i(n){Array.prototype[n]=function(){var t=this.asQueryable();return t[n].apply(t,arguments)}}var s,h,c,l,a,v,y,p,w,b,k,d,g,nt;if(n&&n.beetle){var t=n.beetle,e={indexOutOfRange:"Specified argument was out of the range of valid values. Parameter name: %1"},r=function(){var n=function(n){t.baseTypes.ExpressionBase.call(this,n,3,!0,!0)},i;return t.helper.inherit(n,t.baseTypes.ExpressionBase),i=n.prototype,i.toODataQuery=function(){throw t.helper.createError(t.i18N.notImplemented,[this.name,"toODataQuery"]);},i.toBeetleQuery=function(){throw t.helper.createError(t.i18N.notImplemented,[this.name,"toBeetleQuery"]);},i.execute=function(t,i){return n.execute(t,this.func,this.seed,i)},n}(),o=Array.prototype,u=t.querying.ArrayQuery.prototype,f=t.querying.EntityQuery.prototype,tt=function(){var n=function(n,i){if(!t.Assert.isFunction(n))throw new Error(t.helper.formatString(t.i18N.typeError,"aggregate: func","function"));r.call(this,"aggregate");this.func=n;this.seed=i;this.isExecuter=!0},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.func,this.seed)},i.execute=function(n,t){if(n.length==0)return null;var i=0,r=this.seed!==undefined?this.seed:n[i++];if(n.length==1)return r;for(;i<n.length;i++)r=this.func.call(t,r,n[i]);return r},n}();u.aggregate=function(n,t){var i=this.clone();return i.addExpression(new tt(n,t))};s=function(){var n=function(n){r.call(this,"concat");this.other=n},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other)},i.execute=function(n){return n.concat(this.other)},n}();u.concat=function(n){var t=this.clone();return t.addExpression(new s(n))};h=function(){var n=function(n){r.call(this,"contains");this.item=n;this.isExecuter=!0},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.item)},i.execute=function(n){for(var i=0;i<n.length;i++)if(t.helper.objEquals(n[i],this.item))return!0;return!1},n}();u.contains=function(n){var t=this.clone();return t.addExpression(new h(n))};c=function(){var n=function(n){r.call(this,"except");this.other=n},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other)},i.execute=function(n){for(var f,i,r,o,e=[],u=0;u<n.length;u++){for(f=n[u],i=!1,r=0;r<this.other.length;r++)if(o=this.other[r],i=t.helper.objEquals(f,o),i)break;i||e.push(f)}return e},n}();u.except=function(n){var t=this.clone();return t.addExpression(new c(n))};l=function(){var n=function(n,t,i,u){r.call(this,"groupJoin");this.other=n;this.thisKey=t;this.otherKey=i;this.selector=u},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.thisKey,this.otherKey,this.selector)},i.execute=function(n,i){var r=[],f=t.Assert.isFunction(this.thisKey)?this.thisKey:t.helper.jsepToProjector(t.libs.jsep(this.thisKey),i),e=t.Assert.isFunction(this.otherKey)?this.otherKey:t.helper.jsepToProjector(t.libs.jsep(this.otherKey),i),u=this;return t.helper.forEach(n,function(n){var s=f(n),o=[];t.helper.forEach(u.other,function(n){var i=e(n);t.helper.objEquals(s,i)&&o.push(n)});r.push(u.selector.call(i,n,o))}),r},n}();u.groupJoin=function(n,t,i,r){var u=this.clone();return u.addExpression(new l(n,t,i,r))};a=function(){var n=function(n){r.call(this,"intersect");this.other=n},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other)},i.execute=function(n){for(var r,o,u,s,f,i=[],e=0;e<n.length;e++){for(r=n[e],o=!1,u=0;u<i.length;u++)if(o=t.helper.objEquals(r,i[u]))break;if(!o){for(s=!1,f=0;f<this.other.length;f++)if(s=t.helper.objEquals(r,this.other[f]))break;s&&i.push(r)}}return i},n}();u.intersect=function(n){var t=this.clone();return t.addExpression(new a(n))};v=function(){var n=function(n,t,i,u){r.call(this,"join");this.other=n;this.thisKey=t;this.otherKey=i;this.selector=u},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.thisKey,this.otherKey,this.selector)},i.execute=function(n,i){var r=[],u=this.selector||t.helper.combine,f=t.Assert.isFunction(this.thisKey)?this.thisKey:t.helper.jsepToProjector(t.libs.jsep(this.thisKey),i),e=t.Assert.isFunction(this.otherKey)?this.otherKey:t.helper.jsepToProjector(t.libs.jsep(this.otherKey),i),o=this;return t.helper.forEach(n,function(n){var h=f(n),s=[];t.helper.forEach(o.other,function(n){var i=e(n);t.helper.objEquals(h,i)&&s.push(n)});t.helper.forEach(s,function(t){r.push(u.call(i,n,t))})}),r},n}();u.join=function(n,t,i,r){var u=this.clone();return u.addExpression(new v(n,t,i,r))};u.innerJoin=u.join;y=function(){var n=function(n,t,i,u){r.call(this,"leftJoin");this.other=n;this.thisKey=t;this.otherKey=i;this.selector=u},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.thisKey,this.otherKey,this.selector)},i.execute=function(n,i){var r=[],u=this.selector||t.helper.combine,f=t.Assert.isFunction(this.thisKey)?this.thisKey:t.helper.jsepToProjector(t.libs.jsep(this.thisKey),i),e=t.Assert.isFunction(this.otherKey)?this.otherKey:t.helper.jsepToProjector(t.libs.jsep(this.otherKey),i),o=this;return t.helper.forEach(n,function(n){var h=f(n),s=[];t.helper.forEach(o.other,function(n){var i=e(n);t.helper.objEquals(h,i)&&s.push(n)});s.length==0?r.push(u.call(i,n,null)):t.helper.forEach(s,function(t){r.push(u.call(i,n,t))})}),r},n}();u.leftJoin=function(n,t,i,r){var u=this.clone();return u.addExpression(new y(n,t,i,r))};p=function(){var n=function(n,t,i,u){r.call(this,"rightJoin");this.other=n;this.thisKey=t;this.otherKey=i;this.selector=u},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.thisKey,this.otherKey,this.selector)},i.execute=function(n,i){var r=[],u=this.selector||t.helper.combine,f=t.Assert.isFunction(this.thisKey)?this.thisKey:t.helper.jsepToProjector(t.libs.jsep(this.thisKey),i),e=t.Assert.isFunction(this.otherKey)?this.otherKey:t.helper.jsepToProjector(t.libs.jsep(this.otherKey),i),o=this;return t.helper.forEach(this.other,function(o){var h=f(o),s=[];t.helper.forEach(n,function(n){var i=e(n);t.helper.objEquals(h,i)&&s.push(n)});s.length==0?r.push(u.call(i,null,o)):t.helper.forEach(s,function(n){r.push(u.call(i,n,o))})}),r},n}();u.rightJoin=function(n,t,i,r){var u=this.clone();return u.addExpression(new p(n,t,i,r))};w=function(){var n=function(n,t,i,u){r.call(this,"fullJoin");this.other=n;this.thisKey=t;this.otherKey=i;this.selector=u},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.thisKey,this.otherKey,this.selector)},i.execute=function(n,i){var r=[],f=this.selector||t.helper.combine,u=t.helper.filterArray(this.other,function(){return!0}),e=t.Assert.isFunction(this.thisKey)?this.thisKey:t.helper.jsepToProjector(t.libs.jsep(this.thisKey),i),o=t.Assert.isFunction(this.otherKey)?this.otherKey:t.helper.jsepToProjector(t.libs.jsep(this.otherKey),i);return t.helper.forEach(n,function(n){var h=e(n),s=[];t.helper.forEach(u,function(n){var i=o(n);t.helper.objEquals(h,i)&&s.push(n)});s.length==0?r.push(f.call(i,n,null)):t.helper.forEach(s,function(t){r.push(f.call(i,n,t));u.splice(u.indexOf(t),1)})}),t.helper.forEach(u,function(n){r.push(f.call(i,null,n))}),r},n}();u.fullJoin=function(n,t,i,r){var u=this.clone();return u.addExpression(new w(n,t,i,r))};b=function(){var n=function(n,t){r.call(this,"crossJoin");this.other=n;this.selector=t},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.selector)},i.execute=function(n,i){var r=[],u=this.selector||t.helper.combine,f=this;return t.helper.forEach(n,function(n){t.helper.forEach(f.other,function(t){r.push(u.call(i,n,t))})}),r},n}();u.crossJoin=function(n,t){var i=this.clone();return i.addExpression(new b(n,t))};k=function(){var n=function(n){r.call(this,"sequenceEqual");this.other=n;this.isExecuter=!0},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other)},i.execute=function(n){if(n.length!=this.other.length)return!1;for(var i=0;i<n.length;i++)if(!t.helper.objEquals(n[i],this.other[i]))return!1;return!0},n}();u.sequenceEqual=function(n){var t=this.clone();return t.addExpression(new k(n))};d=function(){var n=function(n,t){r.call(this,"toLookup",3,!0,!0);this.keySelector=n;this.elementSelector=t},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.keySelector,this.elementSelector)},i.execute=function(n,i){var r=[],o,f,u,s,e,h,c;if(this.keySelector)for(o=t.Assert.isFunction(this.keySelector)?this.keySelector(n):t.helper.runSelectExp(n,this.keySelector,i),f=0;f<o.length;f++){for(u=null,s=o[f],e=0;e<r.length;e++)if(h=r[e],t.helper.objEquals(h.Key,s)){u=h;break}u||(u={Key:s,Items:[]},r.push(u));u.Items.push(n[f])}else r.push({Key:null,Items:n});return this.elementSelector&&(c=t.Assert.isFunction(this.elementSelector)?this.elementSelector:t.helper.jsepToFunction(t.libs.jsep(this.elementSelector),i),t.helper.forEach(r,function(n,t){var f=n.Items,u;f.Key=n.Key;u=c.call(i,n.Items,n.Key);r[t]=u})),r},n}();u.toLookup=function(n,t){var i=this.clone();return i.addExpression(new d(n,t))};g=function(){function u(n,i){var r,f,e,u;if(n!=null)for(r=0;r<n.length;r++){for(f=n[r],e=!1,u=0;u<i.length;u++)if(t.helper.objEquals(f,i[u])){e=!0;break}e||i.push(f)}}var n=function(n){r.call(this,"union");this.other=n},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other)},i.execute=function(n){var t=[];return u(n,t),u(this.other,t),t},n}();u.union=function(n){var t=this.clone();return t.addExpression(new g(n))};nt=function(){var n=function(n,t){r.call(this,"zip");this.other=n;this.selector=t},i;return t.helper.inherit(n,r),i=n.prototype,i.clone=function(){return new n(this.other,this.selector)},i.execute=function(n,i){for(var u=[],f=this.selector||t.helper.combine,e=Math.min(n.length,this.other.length),r=0;r<e;r++)u.push(f.call(i,n[r],this.other[r]));return u},n}();u.zip=function(n,t){var i=this.clone();return i.addExpression(new nt(n,t))};i("inlineCount");i("ofType");i("where");i("orderBy");i("orderByDesc");i("select");i("skip");i("take");i("top");i("groupBy");i("distinct");i("selectMany");i("skipWhile");i("takeWhile");i("all");i("any");i("avg");i("max");i("min");i("sum");i("count");i("first");i("firstOrDefault");i("single");i("singleOrDefault");i("last");i("lastOrDefault");i("aggregate");i("contains");i("except");i("groupJoin");i("intersect");i("innerJoin");i("leftJoin");i("rightJoin");i("fullJoin");i("crossJoin");i("sequenceEqual");i("toLookup");i("union");i("zip");Array.hasOwnProperty("range")||(Array.range=function(n,i){var u,r;if(arguments.length==0)return[];if(arguments.length==1&&(i=n,n=0),i<0)throw t.helper.createError(e.indexOutOfRange,["count"]);for(u=[],r=0;r<i;r++)u[r]=n+r;return u});Array.hasOwnProperty("repeat")||(Array.repeat=function(n,i){var r,u;if(arguments.length==0)return[];if(arguments.length==1&&(i=n,n=null),i<0)throw t.helper.createError(e.indexOutOfRange,["count"]);for(r=[],u=0;u<i;u++)r.push(n);return r});o.hasOwnProperty("forEach")||(o.forEach=function(n){t.helper.forEach(this,n)});u.hasOwnProperty("forEach")||(u.forEach=function(n){t.helper.forEach(this,n)});f.hasOwnProperty("forEach")||(f.forEach=function(n){this.execute(null,function(i){t.Assert.isArray(i)?i.forEach(n):n.call(i,i)})});f.hasOwnProperty("then")||(f.then=function(n,t,i){var r=this.execute(i);return t?r.hasOwnProperty("fail")?r.then(n).fail(t):r.then(n,t):r.then(n)});Object.hasOwnProperty("defineProperty")&&(u.length=Object.defineProperty(u,"length",{get:function(){var t=this.execute(),n;for(t instanceof Array||(t=[t]),n=t.length;this[n]!==undefined;)delete this[n++];for(n=0;n<t.length;n++)this[n]=t[n];return t.length},set:function(){},enumerable:!0,configurable:!0}))}})(window);