(function(n,t){var i={jquery:n.$,angular:n.angular,ko:n.ko,Q:n.Q},u,r;if(typeof define=="function"&&define.amd){u=[];for(r in i)require.specified(r)&&u.push(r);define(u,function(){for(var f,r=0;r<arguments.length;r++)f=arguments[r],f&&(i[u[r]]=f);n.beetle=t(n,i.jquery,i.angular,i.ko,i.Q)})}else if(typeof exports=="object"){for(r in i)try{i[r]=require(r)}catch(f){}module.exports=t(n,i.jquery,i.angular,i.ko,i.Q)}else n.beetle=t(n,i.jquery,i.angular,i.ko,i.Q)})(this,function(n,t,i,r,u){"use strict";var f=function(){return{assertPrm:function(n,t){return new s(n,t)},combine:function(n,t){var i,u,r;if(n==t)return n;if(i={},n!=null)for(u in n)i[u]=n[u];if(t!=null)for(r in t){var o=i[r],e=t[r],h=s.isTypeOf(o,"object")&&s.isTypeOf(e,"object")?f.combine(o,e):e;i[r]=h}return i},extend:function(n,t){if(n!=null&&t!=null)for(var i in t)n.hasOwnProperty(i)||(n[i]=t[i])},objEquals:function(n,t){var r,u,i,e;if(n==t)return!0;if(n==null||t==null)return!1;if(s.isObject(n)&&s.isObject(t)){r=0;u=0;for(i in n){if(!t.hasOwnProperty(i)||f.getValue(n,i)!=f.getValue(t,i))return!1;r++}for(e in t)u++;return r==u}return!1},isCaseSensitive:function(n){var t=n&&n.isCaseSensitive;return t==null?a.isCaseSensitive:t},ignoreWhiteSpaces:function(n){var t=n&&n.ignoreWhiteSpaces;return t==null?a.ignoreWhiteSpaces:t},handleStrOptions:function(n,t){return n==null?n:(f.isCaseSensitive(t)||(n=n.toLowerCase()),f.ignoreWhiteSpaces(t)&&(n=n.trim()),n)},equals:function(n,t,i,r){return typeof n=="string"&&typeof t=="string"&&(n=f.handleStrOptions(n,r),t=f.handleStrOptions(t,r)),n!=null&&t!=null&&c.dataTypes.date.isValid(n)&&c.dataTypes.date.isValid(t)&&(n=n.valueOf(),t=t.valueOf()),i?n===t:n==t},formatString:function(n){var t=arguments,i=RegExp("%([0-"+(arguments.length-1)+"])","g"),r=RegExp("{([0-"+(arguments.length-2)+"])}","g");return n.replace(i,function(n,i){return t[Number(i)+1]||""}).replace(r,function(n,i){return t[Number(i)+1]||""})},tryFreeze:function(n,t){var r,i;if(!n||!Object.freeze)return n;if(Object.freeze(n),t===!0)for(r in n)i=n[r],s.isArray(i)?this.tryFreezeArray(i,t):s.isObject(i)&&this.tryFreeze(i,t);return n},tryFreezeArray:function(n,t){if(n&&Object.freeze)for(var i=0;i<n.length;i++)this.tryFreeze(n[i],t)},indexOf:function(n,t,i){for(var r=i||0;r<n.length;r++)if(n[r]===t)return r;return-1},forEach:function(n,t){for(var r,i=0;i<n.length;i++)r=n[i],t.call(null,r,i)},forEachProperty:function(n,t){var i,r;for(i in n)i[0]!="$"&&((r=n[i],s.isFunction(r))||t(i,r))},findInArray:function(n,t,i){for(var r=0;r<n.length;r++)if(i){if(n[r][i]===t)return n[r]}else if(n[r]===t)return t;return null},filterArray:function(n,t){for(var r,u=[],i=0;i<n.length;i++)r=n[i],t(r)===!0&&u.push(r);return u},removeFromArray:function(n,t,i){var r=[],u;for(this.forEach(n,function(n,u){i?n[i]===t&&r.push(u):n===t&&r.push(u)}),u=r.length-1;u>=0;u--)n.splice(r[u],1);return r.length},mapArray:function(n,t){for(var r,u=[],i=0;i<n.length;i++)r=n[i],u.push(t.call(r,r,i));return u},createGuid:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},funcToLambda:function(n){var e,i,r,o,u;f.assertPrm(n,"func").isFunction().check();var t=n.toString().replace(/function(.*?){/g,"$1=>").replace(/{|}|;|return /g,"").trim(),s=t.indexOf("=>"),h=t.substr(0,s).trim();for(t=t.substr(s+2).trim(),e=t.split(","),i=[],r=0;r<e.length;r++)o=e[r],u=o.split(":"),u.length>1?i.push(u[1].trim()+" as "+u[0].trim()):i.push(o.trim());return t=i.join(", "),h?h+" => "+t:t},getFuncName:function(n){var t=/function (.{1,})\(/.exec(n.toString());return t[1]},inherit:function(n,t){var i=new Function;i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n;n.baseClass=t.prototype},getValue:function(n,t){function e(n,t){var i=n.$tracker;return i?i.getValue(t):u.isObservable(n,t)?u.getValue(n,t):n[t]}var r;if(n==null)return undefined;var u=a.getObservableProvider(),f=t.trim().split("."),i=n;for(r=0;r<f.length;r++)if(i=e(i,f[r]),i==null)break;return i},getResourceValue:function(n,t){var i=a.getLocalizeFunction();return i&&n&&i(n)||t},createValidationError:function(n,t,i,r,u){var f={message:r,entity:n,validator:u,value:t,property:i};return this.tryFreeze(f)},createError:function(n,t,i){var r=null,u=i,e,o;if(s.isArray(t)?r=t:s.isObject(t)&&(u=t),r&&r.length>0&&(r.splice(0,0,n),n=f.formatString.apply(null,r)),e=new Error(n),u)for(o in u)e[o]=u[o];return b.error.notify(e),e},runSelectExp:function(n,t,i){if(n.length==0)return n;t=v.jsep(t);var r=t.type=="Compound"?t.body:[t],u=f.jsepToProjector(r,i);return f.mapArray(n,u)},setForeignKeys:function(n,t,i){for(var u,e,o,s,h,r=0;r<t.foreignKeyNames.length;r++)u=t.foreignKeyNames[r],e=n.$tracker,i?(o=i.$tracker.entityType.keys[r],s=i.$tracker.getValue(o.name),e.setValue(u,s)):(h=f.findInArray(e.entityType.dataProperties,u,"name"),e.setValue(u,h.getDefaultValue()))},createTrackableArray:function(n,t,i,r){function e(n,t){var u=t.object,i=t.property,r;i&&(u.$tracker&&u.$tracker.manager&&(r=u.$tracker.manager.handleUnmappedProperties),r==null&&(r=a.handleUnmappedProperties),s.isInstanceOf(i,w.NavigationProperty)?f.forEach(n,function(n){i.checkAssign(n)}):s.isInstanceOf(i,w.DataProperty)?f.forEach(n,function(t,r){n[r]=i.handle(t)}):r===!0&&f.forEach(n,function(t,i){n[i]=c.dataTypes.handle(t)}))}var u=n||[];return u.object=t,u.property=i,u.after=r,u.changing=new c.Event(i+"ArrayChanging",u),u.changed=new c.Event(i+"ArrayChanged",u),u.pop=function(){var n=[this[this.length-1]],t;return this.changing.notify({added:[],removed:n}),t=Array.prototype.pop.call(this),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),t},u.push=function(){this.changing.notify({added:arguments,removed:[]});e(arguments,this);var n=Array.prototype.push.apply(this,arguments);return this.after(this.object,this.property,this,null,arguments),this.changed.notify({added:arguments,removed:[]}),n},u.unshift=function(){this.changing.notify({added:arguments,removed:[]});e(arguments,this);var n=Array.prototype.unshift.apply(this,arguments);return this.after(this.object,this.property,this,null,arguments),this.changed.notify({added:arguments,removed:[]}),n},u.shift=function(){var n=[this[0]],t;return this.changing.notify({added:[],removed:n}),t=Array.prototype.shift.call(this),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),t},u.splice=function(n,t){var i,r,u;return t=t||this.length,i=null,arguments.length>2&&(i=Array.prototype.slice.call(arguments).slice(2)),r=this.slice(n,n+t),this.changing.notify({added:i,removed:r}),i&&e(i,this),u=Array.prototype.splice.apply(this,arguments),this.after(this.object,this.property,this,r,i),this.changed.notify({added:i,removed:r}),u},u.remove=function(){var n=[],t;return this.changing.notify({added:[],removed:arguments}),t=this,f.forEach(arguments,function(i){var r=f.indexOf(t,i);r>=0&&(Array.prototype.splice.call(t,r,1),n.push(i))}),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),n},u.load=function(n,t,i,r,u){return this.object.$tracker.loadNavigationProperty(this.propertyName,n,t,i,r,u)},u},jsepToODataQuery:function(n,t,i){var ft,d,g,nt,v,u,a,w,ut,b,k,ot;if(i=i||n,t?t.aliases||(t.aliases=[]):t={aliases:[]},n.type=="LogicalExpression"||n.type=="BinaryExpression"){if(n.operator=="=>"){if(n!=i)throw f.createError(o.odataDoesNotSupportAlias);return t.aliases.push({alias:n.left.name,value:null}),ft=f.jsepToODataQuery(n.right,t,i),n!=i&&t.aliases.pop(),ft}if(d=h.langOperators.find(n.operator).oData,!d)throw f.createError(o.operatorNotSupportedForOData,[n.operator],{expression:n});return"("+f.jsepToODataQuery(n.left,t,i)+" "+d+" "+f.jsepToODataQuery(n.right,t,i)+")"}if(n.type=="UnaryExpression")return n.operator+f.jsepToODataQuery(n.argument,t,i);if(n.type=="Identifier"){var r=n.name,y=undefined,et=!1;if(r[0]=="@"&&(et=!0,r=r.slice(1)),t.expVarContext&&t.expVarContext[r]!==undefined?y=t.expVarContext[r]:t.varContext&&t.varContext[r]!==undefined&&(y=t.varContext[r]),y!==undefined)return c.dataTypes.toODataValue(y);if(et)throw f.createError(o.unknownParameter,[r],{expression:n,queryContext:t});return(g=f.findInArray(t.aliases,r,"alias"),g)?g.value:r}if(n.type=="Literal")return c.dataTypes.toODataValue(n.value);if(n.type=="MemberExpression")return t.currentAlias&&n.object.name==t.currentAlias.alias?n.property.name:(nt=f.findInArray(t.aliases,n.object.name,"alias"),v=nt?nt.value:f.jsepToODataQuery(n.object,t,i),v[n.property.name]!==undefined)?c.dataTypes.toODataValue(v[n.property.name]):v?v+"/"+n.property.name:n.property.name;if(n.type=="Compound"){for(u=[],a=0;a<n.body.length;a++){var tt=n.body[a],it=f.jsepToODataQuery(tt,t),rt=it.toLowerCase();if(rt=="desc"||rt=="asc"){if(u.length==0)throw f.createError(o.invalidStatement,{expression:n,statement:tt});u[u.length-1]+=" "+it}else if(rt=="as"){if(u.length==0||n.body.length<a+1)throw f.createError(o.invalidStatement,{expression:n,statement:tt});u[u.length-1]+=" as "+n.body[a+1].name;a++}else u.push(it)}return u.join(", ")}if(n.type=="CallExpression"){var e=n.arguments,p=[],s=null;for(e.length==1&&e[0]&&e[0].type=="BinaryExpression"&&e[0].operator=="=>"&&(s={alias:e[0].left.name},s.value=s.alias,e=[e[0].right]),s&&(t.currentAlias=s,t.aliases.push(s)),w=0;w<e.length;w++)ut=e[w],ut!=null&&p.push(f.jsepToODataQuery(ut,t,i));if(n.callee.type=="MemberExpression"?(p.splice(0,0,f.jsepToODataQuery(n.callee.object,t,i)),b=n.callee.property.name):b=n.callee.name,k=l.queryFuncs.getFunc(b),k.needsAlias==!0)if(s)p.splice(0,0,s);else throw f.createError(o.functionNeedsAlias,[b],{expression:n});return ot=k.toODataFunction.apply(k,p),s&&(t.currentAlias=null,t.aliases.pop()),ot}throw f.createError(o.unknownExpression,{expression:n});},jsepToBeetleQuery:function(n,t,i){var ut,ft,w,b,y,u,s,p,tt,it,rt,ot;if(i=i||n,t?t.aliases||(t.aliases=[]):t={aliases:[]},n.type=="LogicalExpression"||n.type=="BinaryExpression")return n.operator=="=>"?(t.aliases.push({alias:n.left.name,value:"it"}),ut=f.jsepToBeetleQuery(n.right,t,i),n!=i&&t.aliases.pop(),ut):(ft=h.langOperators.find(n.operator).code,"("+f.jsepToBeetleQuery(n.left,t,i)+" "+ft+" "+f.jsepToBeetleQuery(n.right,t,i)+")");if(n.type=="UnaryExpression")return n.operator+f.jsepToBeetleQuery(n.argument,t,i);if(n.type=="Identifier"){var r=n.name,v=undefined,et=!1;if(r[0]=="@"&&(et=!0,r=r.slice(1)),t.expVarContext&&t.expVarContext[r]!==undefined?v=t.expVarContext[r]:t.varContext&&t.varContext[r]!==undefined&&(v=t.varContext[r]),v!==undefined)return c.dataTypes.toBeetleValue(v);if(et)throw f.createError(o.unknownParameter,[r],{expression:n,queryContext:t});return(w=f.findInArray(t.aliases,r,"alias"),w)?w.value:r}if(n.type=="Literal")return c.dataTypes.toBeetleValue(n.value);if(n.type=="MemberExpression")return t.currentAlias&&n.object.name==t.currentAlias.alias?n.property.name:(b=f.findInArray(t.aliases,n.object.name,"alias"),y=b?b.value:f.jsepToBeetleQuery(n.object,t,i),y[n.property.name]!==undefined)?c.dataTypes.toBeetleValue(y[n.property.name]):y+"."+n.property.name;if(n.type=="Compound"){for(u=[],s=0;s<n.body.length;s++){var k=n.body[s],d=f.jsepToBeetleQuery(k,t),g=d.toLowerCase();if(g=="desc"||g=="asc"){if(u.length==0)throw f.createError(o.invalidStatement,{expression:n,statement:k});u[u.length-1]+=" "+d}else if(g=="as"){if(u.length==0||n.body.length<s+1)throw f.createError(o.invalidStatement,{expression:n,statement:k});u[u.length-1]+=" as "+n.body[s+1].name;s++}else u.push(d)}return u.join(", ")}if(n.type=="CallExpression"){var e=n.arguments,nt=[],a=null;for(e.length==1&&e[0]&&e[0].type=="BinaryExpression"&&e[0].operator=="=>"&&(a={alias:e[0].left.name},a.value=a.alias,e=[e[0].right]),a&&(t.currentAlias=a,t.aliases.push(a)),p=0;p<e.length;p++)tt=e[p],tt!=null&&nt.push(f.jsepToBeetleQuery(tt,t,i));return n.callee.type=="MemberExpression"?(nt.splice(0,0,f.jsepToBeetleQuery(n.callee.object,t,i)),it=n.callee.property.name):it=n.callee.name,rt=l.queryFuncs.getFunc(it),ot=rt.toBeetleFunction.apply(rt,nt),a&&(t.currentAlias=null,t.aliases.pop()),ot}throw f.createError(o.unknownExpression,{expression:n});},jsepToFunction:function(n,t){return function(i){var nt,it,rt,r,v,y,b,k,d,c,g,s,a,w;if(t?t.aliases||(t.aliases=[]):t={aliases:[]},t.currentAlias&&(t.currentAlias.value=i),n.type===undefined)return i;if(n.type=="LogicalExpression"||n.type=="BinaryExpression"){if(n.operator=="=>")return t.currentAlias&&t.aliases.push(t.currentAlias),t.currentAlias={alias:n.left.name},nt=f.jsepToFunction(n.right,t)(i),t.currentAlias=t.aliases.pop(),nt;var ut=h.langOperators.find(n.operator),tt=t.varContext,ft=function(){return f.jsepToFunction(n.left,t)(i)},et=function(){return f.jsepToFunction(n.right,t)(i)};return ut.asFunc.call(tt,ft,et)}if(n.type=="UnaryExpression")return it=function(){return f.jsepToFunction(n.argument,t)(i)},rt=h.langOperators.find(n.operator),rt.asFunc.call(tt,it);if(n.type=="Identifier"){if(r=n.name,r=="null")return null;if(r=="true")return!0;if(r=="false")return!1;if(r[0]=="@"){if(v=undefined,y=r.slice(1),t.expVarContext&&t.expVarContext[y]!==undefined?v=t.expVarContext[y]:t.varContext&&(v=t.varContext[y]),v===undefined)throw f.createError(o.unknownParameter,[r],{expression:n,queryContext:t});return v}return t.currentAlias&&t.currentAlias.alias==r?i:(b=f.findInArray(t.aliases,r,"alias"),b)?b.value:(k=f.getValue(i,r),k===undefined)?window[r]:k}if(n.type=="Literal")return n.value;if(n.type=="MemberExpression"){if(n.object.name){if(t.currentAlias&&n.object.name==t.currentAlias.alias)return f.getValue(i,n.property.name);if(d=f.findInArray(t.aliases,n.object.name,"alias"),d)return f.getValue(d.value,n.property.name)}return f.getValue(f.jsepToFunction(n.object,t)(i),n.property.name)}if(n.type=="CallExpression"){var u=n.arguments,e=[],p=null;if(u.length==1&&u[0]&&u[0].type=="BinaryExpression"&&u[0].operator=="=>"&&(p=u[0].left.name,u=[u[0].right]),p&&(t.currentAlias&&t.aliases.push(t.currentAlias),t.currentAlias={alias:p}),f.forEach(u,function(n){n!=null&&e.push(f.jsepToFunction(n,t))}),c=n.callee.type=="MemberExpression"?n.callee.property.name:n.callee.name,s=l.queryFuncs.getFunc(c,!1),s)n.callee.type=="MemberExpression"&&e.splice(0,0,f.jsepToFunction(n.callee.object,t)),e.splice(0,0,i),g=s.impl.apply(t,e);else{if(c[0]=="@")if(a=c.slice(1),t.expVarContext&&t.expVarContext[a])s=t.expVarContext[a];else if(t.varContext&&t.varContext[a])s=t.varContext[a];else throw f.createError(o.unknownParameter,[a],{expression:n,queryContext:t});else if(w=n.callee.type=="MemberExpression"?f.jsepToFunction(n.callee.object,t)(i):window,w==null||(s=w[c])==null)throw f.createError(o.unknownFunction,[c]);e=f.mapArray(e,function(){return this(i)});g=s.apply(w,e)}return p&&(t.currentAlias=t.aliases.pop()),g}throw f.createError(o.unknownExpression,{expression:n});}},jsepToProjector:function(n,t){var h=[],i,r,u,e;for(s.isArray(n)||(n=[n]),i=0;i<n.length;i++){r=null;u=n[i];switch(u.type){case"Identifier":r=u.name;break;case"MemberExpression":r=u.property.name}if(n.length>i+2&&n[i+1].name&&n[i+1].name.toLowerCase()=="as"){if(i=i+2,e=n[i],e.type!="Identifier")throw f.createError(o.invalidPropertyAlias,{expressions:n,aliasExpression:e});r=e.name}if(n.length>1&&!r)throw f.createError(o.projectionsMustHaveAlias,{expressions:n,expression:u});h.push({p:r,func:f.jsepToFunction(u,t)})}return function(t){for(var r,u,f={},i=0;i<h.length;i++){if(r=h[i],u=r.func(t),n.length==1)return u;f[r.p]=u}return f}}}}(),s=function(){var n=function(n,t){this.value=n;this.name=t;this.errors=[];f.tryFreeze(this)},t=n.prototype;return t.hasValue=function(){return n.hasValue(this.value,this.errors,this.name),this},t.isObject=function(){return n.isObject(this.value,this.errors,this.name),this},t.isFunction=function(){return n.isFunction(this.value,this.errors,this.name),this},t.isNotEmptyString=function(){return n.isNotEmptyString(this.value,this.errors,this.name),this},t.isTypeOf=function(t){return n.isTypeOf(this.value,t,this.errors,this.name),this},t.isArray=function(){return n.isArray(this.value,this.errors,this.name),this},t.isEnum=function(t){return n.isEnum(this.value,t,this.errors,this.name),this},t.isInstanceOf=function(t){return n.isInstanceOf(this.value,t,this.errors,this.name),this},t.check=function(){if(this.errors.length>0)throw f.createError(this.errors.join("\n"),{name:this.name,value:this.value});},n.hasValue=function(n,t,i){return n==null?(t&&t.push(f.formatString(o.valueCannotBeNull,i)),!1):!0},n.isObject=function(n,t,i){return n==null||!c.dataTypes.object.isValid(n)?(t&&t.push(f.formatString(o.typeError,i,"object")),!1):!0},n.isFunction=function(n,t,i){return n==null||!c.dataTypes.func.isValid(n)?(t&&t.push(f.formatString(o.typeError,i,"function")),!1):!0},n.isNotEmptyString=function(t,i,r){return t==null||t===""||!n.isTypeOf(t,"string",i)?(i&&i.push(f.formatString(o.cannotBeEmptyString,r)),!1):!0},n.isTypeOf=function(t,i,r,u){if(!n.hasValue(t))return!1;var e=c.dataTypes.byName(i);return e.isValid(t)?!0:(r&&r.push(f.formatString(o.typeMismatch,u,i,e,t)),!1)},n.isArray=function(n,t,i){return n==null||!c.dataTypes.array.isValid(n)?(t&&t.push(f.formatString(o.typeError,i,"array")),!1):!0},n.isEnum=function(n,t,i){return t.contains(n)?!0:(i&&i.push(f.formatString(o.invalidEnumValue,t,n)),!1)},n.isInstanceOf=function(n,t,i,r){return n==null?(i&&i.push(o.cannotCheckInstanceOnNull),!1):(n instanceof t)?!0:(i&&i.push(f.formatString(o.instanceError,r,t)),!1)},n}(),v=function(){var n={};return n.Enum=function(){function i(n,t){for(var i in t)n[i]=t[i];return n}function n(n,t){this.name=n;t&&i(this,t);f.tryFreeze(this)}n.prototype={};n.prototype.constructor=n;n.prototype.toString=function(){return this.name};f.tryFreeze(n.prototype);var t=function(t){var r=this,i;if(arguments.length===1&&t!==null&&typeof t=="object")for(i in t)r[i]=new n(i,t[i]);else f.forEach(arguments,function(t){r[t]=new n(t)});f.tryFreeze(this)};return t.prototype.symbols=function(){var t=[],i,n;for(i in this)(n=this[i],s.isFunction(n))||t.push(n);return t},t.prototype.contains=function(t){return(t instanceof n)?this[t.name]===t:!1},t}(),n.jsep=function(){var c="Compound",p="Identifier",l="MemberExpression",o="Literal",w="ThisExpression",b="CallExpression",k="UnaryExpression",d="BinaryExpression",g="LogicalExpression",i=!0,r={"-":i,"!":i,"~":i,"+":i},t={"=>":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},e=function(n){var t=0,i;for(var r in n)(i=r.length)>t&&n.hasOwnProperty(r)&&(t=i);return t},s=e(r),u=e(t),a={"true":!0,"false":!1,"null":null},nt="this",v=function(n){return t[n]||0},y=function(n,t,i){var r=n==="||"||n==="&&"?g:d;return{type:r,operator:n,left:t,right:i}},f=function(n){return n>=48&&n<=57},h=function(n){return n===36||n===95||n===64||n>=65&&n<=90||n>=97&&n<=122},tt=function(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57},n=function(n){for(var i=0,ct=n.charAt,lt=n.charCodeAt,e=function(t){return ct.call(n,t)},d=function(t){return lt.call(n,t)},it=n.length,g=function(){for(var n=d(i);n===32||n===9;)n=d(++i)},ot=function(){g();for(var r=n.substr(i,u),f=r.length;f>0;){if(t.hasOwnProperty(r))return i+=f,r;r=r.substr(0,--f)}return!1},rt=function(){var r,t,o,n,s,f,e,u;if(f=ut(),t=ot(),!t)return f;if(s={value:t,prec:v(t)},e=ut(),!e)throw new Error("Expected expression after "+t+" at character "+i);for(n=[f,s,e];t=ot();){if(o=v(t),o===0)break;for(s={value:t,prec:o};n.length>2&&o<=n[n.length-2].prec;)e=n.pop(),t=n.pop().value,f=n.pop(),r=y(t,f,e),n.push(r);if(r=ut(),!r)throw new Error("Expected expression after "+t+" at character "+i);n.push(s);n.push(r)}for(u=n.length-1,r=n[u];u>1;)r=y(n[u-1].value,n[u-2],r),u-=2;return r},ut=function(){var t,u,e;if(g(),t=d(i),f(t)||t===46)return at();if(t===39||t===34)return vt();if(h(t))return pt();if(t===40)return wt();for(u=n.substr(i,s),e=u.length;e>0;){if(r.hasOwnProperty(u))return i+=e,{type:k,operator:u,argument:ut(),prefix:!0};u=u.substr(0,--e)}return!1},at=function(){for(var n="";f(d(i));)n+=e(i++);if(e(i)===".")for(n+=e(i++);f(d(i));)n+=e(i++);if(e(i)==="e"||e(i)==="E"){for(n+=e(i++),(e(i)==="+"||e(i)==="-")&&(n+=e(i++));f(d(i));)n+=e(i++);if(!f(d(i-1)))throw new Error("Expected exponent ("+n+e(i)+") at character "+i);}if(h(d(i)))throw new Error("Variable names cannot start with a number ("+n+e(i)+") at character "+i);return{type:o,value:parseFloat(n),raw:n}},vt=function(){for(var n="",r=e(i++),u=!1,t;i<it;)if(t=e(i++),t===r){u=!0;break}else if(t==="\\"){t=e(i++);switch(t){case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\x0b"}}else n+=t;if(!u)throw new Error('Unclosed quote after "'+n+'"');return{type:o,value:n,raw:r+n+r}},st=function(){var r=d(i),u=i,t;if(h(r))i++;else throw new Error("Unexpected "+e(i)+"at character "+i);while(i<it)if(r=d(i),tt(r))i++;else break;return t=n.slice(u,i),a.hasOwnProperty(t)?{type:o,value:a[t],raw:t}:t===nt?{type:w}:{type:p,name:t}},yt=function(){for(var t,r=[],n;i<it;)if(g(),t=e(i),t===")"){i++;break}else if(t===",")i++;else{if(n=rt(),!n||n.type===c)throw new Error("Expected comma at character "+i);r.push(n)}return r},pt=function(){var n,t,r;for(t=st(),g(),n=e(i);n==="."||n==="["||n==="(";){if(n===".")i++,g(),t={type:l,computed:!1,object:t,property:st()};else if(n==="["){if(r=i,i++,t={type:l,computed:!0,object:t,property:rt()},g(),n=e(i),n!=="]")throw new Error("Unclosed [ at character "+i);i++;g()}else n==="("&&(i++,t={type:b,arguments:yt(),callee:t});g();n=e(i)}return t},wt=function(){i++;var n=rt();if(g(),e(i)===")")return i++,n;throw new Error("Unclosed ( at character "+i);},ft=[],et,ht;i<it;)if(et=e(i),et===";"||et===",")i++;else if(ht=rt())ft.push(ht);else if(i<it)throw new Error("Unexpected '"+e(i)+"' at character "+i);return ft.length===1?ft[0]:{type:c,body:ft}};return n.version="0.2.8",n.toString=function(){return"JavaScript Expression Parser (JSEP) v"+n.version},n.addUnaryOp=function(n){return r[n]=i,this},n.addBinaryOp=function(n,i){return u=Math.max(n.length,u),t[n]=i,this},n.removeUnaryOp=function(n){return delete r[n],n.length===s&&(s=e(r)),this},n.removeBinaryOp=function(n){return delete t[n],n.length===u&&(u=e(t)),this},n}(),n}(),e=function(){return{DateConverterBase:function(){var t=function(n){this.name=n},n=t.prototype;return n.toString=function(){return this.name},n.parse=function(){throw f.createError(o.notImplemented,["DateConverterBase","parse"]);},n.toISOString=function(){throw f.createError(o.notImplemented,["DateConverterBase","toISOString"]);},t}(),DataTypeBase:function(){var t=function(n){this.name=n||"DataTypeBase";this.isComplex=!1},n=t.prototype;return n.toString=function(){return this.name},n.getRawValue=function(n){return n},n.isValid=function(n){return typeof n===this.name},n.toODataValue=function(n){return n.toString()},n.toBeetleValue=function(n){return n.toString()},n.defaultValue=function(){throw f.createError(o.notImplemented,[this.name,"defaultValue"]);},n.autoValue=function(){throw f.createError(o.notImplemented,[this.name,"autoValue"]);},n.handle=function(){throw f.createError(o.notImplemented,[this.name,"handle"]);},t}(),ExpressionBase:function(){var t=function(n,t,i,r){this.name=n||"ExpressionBase";this.order=t;this.onlyBeetle=i;this.isProjection=r},n=t.prototype;return n.toString=function(){return this.toBeetleQuery({})},n.toODataQuery=function(n){if(this.onlyBeetle===!0)return this.toBeetleQuery(n);var t=s.isFunction(this.exp)?f.funcToLambda(this.exp):this.exp;return f.jsepToODataQuery(v.jsep(t),n)},n.toBeetleQuery=function(n){if(!this.exp)return"";var t=s.isFunction(this.exp)?f.funcToLambda(this.exp):this.exp;return f.jsepToBeetleQuery(v.jsep(t),n)},n.clone=function(){throw f.createError(o.notImplemented,[this.name,"clone"]);},n.execute=function(){throw f.createError(o.notImplemented,[this.name,"execute"]);},t}(),QueryFuncBase:function(){var t=function(n,t,i){this.name=n;this.beetleName=t;this.argCount=i},n=t.prototype;return n.toODataFunction=function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);return this.name+"("+t.join(", ")+")"},n.toBeetleFunction=function(){var i="",n=0,t;for(arguments.length==this.argCount&&(i=arguments[0]+".",++n),t=[],n;n<arguments.length;n++)t.push(arguments[n]);return i+this.beetleName+"("+t.join(", ")+")"},n.impl=function(){throw f.createError(o.notImplemented,[this.name,"impl"]);},t}(),QueryBase:function(){var t=function(){this.expressions=[];this.inlineCountEnabled=!1;this.lastExpOrder=0;this.isMultiTyped=!1;this.lastProjection=0;this.isClosed=!1;this.hasBeetlePrm=!1;this.options=null},n=t.prototype;return n.executeAfterExecuter=!1,n.toString=function(){var n=[],t;return f.forEach(this.parameters,function(t){n.push(t.name+": "+(t.value==null?"":t.value))}),this.inlineCountEnabled===!0&&n.push("inlinecount: allpages"),t={},f.forEach(this.expressions,function(i){t.expVarContext=i.varContext;n.push(i.name+": "+i.toBeetleQuery(t));t.expVarContext=undefined}),n.join(", ")},n.addExpression=function(n){if(this.isClosed)throw f.createError(o.queryClosed,null,{query:this});if(f.assertPrm(n,"expression").isInstanceOf(e.ExpressionBase).check(),this.expressions.push(n),n.isExecuter===!0){var t=this.options&&this.options.executeAfterExecuter;if(t==null&&(t=this.executeAfterExecuter),t)return this.execute();this.isClosed=!0}return(n.order<this.lastExpOrder||this.hasBeetlePrm&&!n.onlyBeetle)&&(this.isMultiTyped=!0),n.isProjection===!0&&(this.lastProjection=this.expressions.length-1),n.onlyBeetle&&(this.hasBeetlePrm=!0),this},n.inlineCount=function(n){var t=this.clone();return t.inlineCountEnabled=n!==!1,t},n.ofType=function(n){var t=this.clone();return t.addExpression(new l.expressions.OfTypeExp(n))},n.where=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.WhereExp(n,t))},n.orderBy=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.OrderByExp(n,t))},n.orderByDesc=function(n){return this.orderBy(n,!0)},n.select=function(n){var i=this.clone(),t;return arguments.length==1?(t=arguments[0],s.isArray(t)&&(n=t.join(", "))):n=Array.prototype.slice.call(arguments).join(", "),i.addExpression(new l.expressions.SelectExp(n))},n.skip=function(n){var t=this.clone();return t.addExpression(new l.expressions.SkipExp(n))},n.take=function(n){return this.top(n)},n.top=function(n){var t=this.clone();return t.addExpression(new l.expressions.TopExp(n))},n.groupBy=function(n,t){var i=this.clone();return s.isArray(n)&&(n=n.join(", ")),s.isArray(t)&&(t=t.join(", ")),i.addExpression(new l.expressions.GroupByExp(n,t))},n.distinct=function(n){var t=this.clone();return s.isArray(n)&&(n=n.join(", ")),t.addExpression(new l.expressions.DistinctExp(n))},n.reverse=function(){var n=this.clone();return n.addExpression(new l.expressions.ReverseExp)},n.selectMany=function(n){var t=this.clone();return t.addExpression(new l.expressions.SelectManyExp(n))},n.skipWhile=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.SkipWhileExp(n,t))},n.takeWhile=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.TakeWhileExp(n,t))},n.all=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.AllExp(n,t))},n.any=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.AnyExp(n,t))},n.avg=function(n){var t=this.clone();return t.addExpression(new l.expressions.AvgExp(n))},n.max=function(n){var t=this.clone();return t.addExpression(new l.expressions.MaxExp(n))},n.min=function(n){var t=this.clone();return t.addExpression(new l.expressions.MinExp(n))},n.sum=function(n){var t=this.clone();return t.addExpression(new l.expressions.SumExp(n))},n.count=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.CountExp(n,t))},n.first=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.FirstExp(n,t))},n.firstOrDefault=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.FirstOrDefaultExp(n,t))},n.single=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.SingleExp(n,t))},n.singleOrDefault=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.SingleOrDefaultExp(n,t))},n.last=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.LastExp(n,t))},n.lastOrDefault=function(n,t){var i=this.clone();return i.addExpression(new l.expressions.LastOrDefaultExp(n,t))},n.withOptions=function(n){var t=this.clone();return t.options=f.combine(this.options,n),t},n.execute=function(){throw f.createError(o.notImplemented,["Query","execute"]);},n.x=function(){return this.execute.apply(this,arguments)},n.toFunction=function(){var n=this;return function(t,i){var r={varContext:i};return r.aliases=[],n.inlineCountEnabled&&(r.inlineCount=t.length),f.forEach(n.expressions,function(i){r.expVarContext=i.varContext;t=i.execute(t,r);!n.inlineCountEnabled||s.isInstanceOf(i,l.expressions.TopExp)||s.isInstanceOf(i,l.expressions.SkipExp)||(r.inlineCount=t.length);r.expVarContext=undefined}),n.inlineCountEnabled&&(t.$inlineCount=r.inlineCount),t}},n.clone=function(){throw f.createError(o.notImplemented,["Query","clone"]);},n.copy=function(n){f.forEach(this.expressions,function(t){n.expressions.push(t.clone())});n.inlineCountEnabled=this.inlineCountEnabled;n.lastExpOrder=this.lastExpOrder;n.isMultiTyped=this.isMultiTyped;n.lastProjection=this.lastProjection;n.isClosed=this.isClosed;n.hasBeetlePrm=this.hasBeetlePrm;this.options&&(n.options=f.combine(null,this.options))},n.getExpression=function(n,t){for(var r,i=this.lastProjection;i<this.expressions.length;i++)if(r=this.expressions[i],s.isInstanceOf(r,n))return r;if(t===!0)throw f.createError(o.expressionCouldNotBeFound,{type:n,query:this});return null},n.removeExpression=function(n){for(var i,t=this.expressions.length-1;t>=0;t--)i=this.expressions[t],s.isInstanceOf(i,n)&&this.expressions.splice(t,1);return this},t}(),ObservableProviderBase:function(){var t=function(n){this.name=n||"ObservableProviderBase"},n=t.prototype;return n.toString=function(){return this.name},n.isObservable=function(){throw f.createError(o.notImplemented,[this.name,"isObservable"]);},n.toObservable=function(){throw f.createError(o.notImplemented,[this.name,"toObservable"]);},n.getValue=function(){throw f.createError(o.notImplemented,[this.name,"getValue"]);},n.setValue=function(){throw f.createError(o.notImplemented,[this.name,"setValue"]);},t}(),AjaxProviderBase:function(){var n=function(n){this.name=n||"AjaxProviderBase";this.syncSupported=!0},t=n.prototype;return t.toString=function(){return this.name},t.doAjax=function(){throw f.createError(o.notImplemented,[this.name,"doAjax"]);},n}(),SerializationServiceBase:function(){var t=function(n){this.name=n||"SerializationServiceBase"},n=t.prototype;return n.toString=function(){return this.name},n.serialize=function(){throw f.createError(o.notImplemented,[this.name,"serialize"]);},n.deserialize=function(){throw f.createError(o.notImplemented,[this.name,"deserialize"]);},t}(),PromiseProviderBase:function(){var t=function(n){this.name=n||"PromiseProviderBase"},n=t.prototype;return n.toString=function(){return this.name},n.deferred=function(){throw f.createError(o.notImplemented,[this.name,"deferred"]);},n.getPromise=function(){throw f.createError(o.notImplemented,[this.name,"getPromise"]);},n.resolve=function(){throw f.createError(o.notImplemented,[this.name,"resolve"]);},n.reject=function(){throw f.createError(o.notImplemented,[this.name,"reject"]);},t}(),DataServiceBase:function(){function h(n,t,e,h){if(h._awaitingMetadata=!1,h._readyCallbacks=[],n==null?n="":n[n.length-1]!=="/"&&(n+="/"),h.uri=n,e=e||{},h.ajaxProvider=e.ajaxProvider||a.getAjaxProvider(),h.serializationService=e.serializationService||a.getSerializationService(),h.ajaxTimeout=e.ajaxTimeout,h.dataType=e.dataType||"json",h.contentType=e.contentType||"application/json; charset=utf-8",i=e.registerMetadataTypes,i==null&&(i=a.registerMetadataTypes),t!==!1||t===undefined)if(t==null){var c=null;a.cacheMetadata===!0&&(c=f.findInArray(u,n,"uri"));c?h.metadataManager=c.data:(h._awaitingMetadata=!0,h.fetchMetadata(null,function(t){h._awaitingMetadata=!1;h.metadataManager=new w.MetadataManager(t);a.cacheMetadata===!0&&u.push({uri:n,data:h.metadataManager});r(h)},function(n){throw f.createError(o.couldNotLoadMetadata,{exception:n,args:arguments,dataService:this});}))}else if(s.isInstanceOf(t,w.MetadataManager))h.metadataManager=t;else if(s.isObject(t))try{h.metadataManager=new w.MetadataManager(t)}catch(l){throw f.createError(o.invalidArguments,{exception:l,args:arguments,dataService:this});}h._awaitingMetadata||r(h)}function r(t){var u,f,e,r,o;if(t.isReady())for(u=t.metadataManager,i&&u&&(f=u.name,n.hasOwnProperty(f)||(n[f]=c.EntityManager)),e=t._readyCallbacks.slice(0),t._readyCallbacks=[],r=0;r<e.length;r++)o=e[r],o&&o.call(t)}var u=[],e=function(n,t,i){h(n,t,i,this)},t=e.prototype,i;return t.toString=function(){return this.uri},t.isReady=function(){return!this._awaitingMetadata},t.ready=function(n){this._readyCallbacks.push(n);r(this)},t.getEntityType=function(n){return this.metadataManager?this.metadataManager.getEntityType(n):null},t.createQuery=function(n,t,i){return(f.assertPrm(n,"resourceName").isNotEmptyString().check(),t)?this.createEntityQuery(t,n,i):this.metadataManager?this.metadataManager.createQuery(n,null,i):new l.EntityQuery(n,null,i)},t.createEntityQuery=function(n,t,i){if(!this.metadataManager)throw f.createError(o.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createQuery(t,n,i)},t.registerCtor=function(n,t,i){if(this.metadataManager==null)throw f.createError(o.noMetadataEntityQuery);this.metadataManager.registerCtor(n,t,i)},t.createEntity=function(n,t){if(!this.metadataManager)throw f.createError(o.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createEntity(n,t)},t.createRawEntity=function(n,t){if(!this.metadataManager)throw f.createError(o.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createRawEntity(n,t)},t.toEntity=function(n,t){var i=null;return this.metadataManager&&(i=this.metadataManager.getEntityTypeByFullName(t)),i||(i=new w.EntityType(t)),c.EntityTracker.toEntity(n,i,a.getObservableProvider())},t.toODataQueryParams=function(n,t){if(n.isMultiTyped===!0)throw f.createError(o.oDataNotSupportMultiTyped,{query:n});var i={varContext:t},r=[];return f.forEach(n.parameters,function(n){r.push({name:n.name,value:n.value==null?"":n.value})}),n.inlineCountEnabled===!0&&r.push({name:"$inlinecount",value:"allpages"}),f.forEach(n.expressions,function(n,t){i.expVarContext=n.varContext;var f,u;n.onlyBeetle===!0?(f="!e"+t,u=n.toBeetleQuery(i),u=n.name+":"+u):(f="$"+n.name,u=n.toODataQuery(i));r.push({name:f,value:u});i.expVarContext=undefined}),r},t.toBeetleQueryParams=function(n,t){var r={varContext:t},i=[];return f.forEach(n.parameters,function(n){i.push({name:n.name,value:n.value==null?"":n.value})}),n.inlineCountEnabled===!0&&i.push({name:"!e0",value:"inlinecount:allpages"}),f.forEach(n.expressions,function(n,t){r.expVarContext=n.varContext;i.push({name:"!e"+(t+1),value:n.name+":"+n.toBeetleQuery(r)});r.expVarContext=undefined}),i},t.fetchMetadata=function(){throw f.createError(o.notImplemented,["DataServiceBase","fetchMetadata"]);},t.createEntityAsync=function(){throw f.createError(o.notImplemented,["DataServiceBase","createEntityAsync"]);},t.executeQuery=function(){throw f.createError(o.notImplemented,["DataServiceBase","executeQuery"]);},t.executeQueryParams=function(){throw f.createError(o.notImplemented,["DataServiceBase","executeQueryParams"]);},t.saveChanges=function(){throw f.createError(o.notImplemented,["DataServiceBase","saveChanges"]);},e}()}}(),y=function(){return{defaultDateConverterInstance:function(){var n=function(){e.DateConverterBase.call(this,"Default Date Converter")},t;return f.inherit(n,e.DateConverterBase),t=n.prototype,t.parse=function(n){if(typeof n!="string"||n.length<10||!/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(n.substr(0,10)))return null;/.\d{3}$/.test(n)&&(n+="Z");try{var t=Date.parse(n);return isNaN(t)?null:new Date(t)}catch(i){return null}},t.toISOString=function(n){return n.toISOString()},new n}(),koObservableProviderInstance:function(){var t,n;return r&&(r.extenders.intercept=function(n,t){return r.computed({read:n,write:function(i){var r=t&&t.callback;r&&r(t.object,t.property,n,i)}})}),t=function(){e.ObservableProviderBase.call(this,"Knockout Observable Provider");f.tryFreeze(this)},f.inherit(t,e.ObservableProviderBase),n=t.prototype,n.isObservable=function(n,t){return r.isObservable(n[t])},n.toObservable=function(n,t,i){function e(t,i,u){var f=r.observable(i);return u?r.observable(i).extend({intercept:{object:n,property:t,callback:u}}):f}function h(t,i,u,e,o){var s;return u=u||[],e&&(u=f.createTrackableArray(u,n,t,function(t,r,u,f,o){s.$fromKo!==!0&&n[i].valueHasMutated();s.$fromKo=!1;e(t,r,u,f,o)})),s=r.observableArray(u),s.subscribe(function(){s.$fromKo=!0},null,"beforeChange"),o&&(s.equalityComparer=function(i,r){o(n,t,i,r)}),s}var c=i&&i.propertyChange,l=i&&i.arrayChange,a=i&&i.dataPropertyChange,v=i&&i.scalarNavigationPropertyChange,y=i&&i.pluralNavigationPropertyChange,o=i&&i.arraySet,u=[];f.forEachProperty(n,function(n,t){u.push({p:n,v:t})});t&&t.hasMetadata&&(f.forEach(t.dataProperties,function(t){var i=n[t.name];i=i===undefined?null:t.handle(i);n[t.name]=e(t,i,a);f.removeFromArray(u,t.name,"p")}),f.forEach(t.navigationProperties,function(t){var i=n[t.name];i===undefined&&(i=null);n[t.name]=t.isScalar?e(t,i,v):h(t,t.name,i,y,o);f.removeFromArray(u,t.name,"p")}));f.forEach(u,function(i){var r=i.p,u=i.v;n[r]=s.isArray(u)?h(r,r,u,l,o):e(r,u,c);f.findInArray(t.properties,r)||t.properties.push(r)})},n.getValue=function(n,t){return r.utils.unwrapObservable(n[t])},n.setValue=function(n,t,i){n[t](i)},new t}(),propertyObservableProviderInstance:function(){var t=function(){e.ObservableProviderBase.call(this,"Property Observable Provider");f.tryFreeze(this)},n;return f.inherit(t,e.ObservableProviderBase),n=t.prototype,n.isObservable=function(n,t){return n.$fields!==undefined&&n.$fields[t]!==undefined},n.toObservable=function(n,t,i){function e(t,i,r){return Object.defineProperty(n,i,{get:function(){return n.$fields[i]},set:function(u){if(r){var f=p(n,i);r(n,t,f,u)}else n.$fields[i]=u},enumerable:!0,configurable:!0})}function h(t,i,u,e,o){return u=u||[],e&&(u=f.createTrackableArray(u,n,t,e)),r[i]=u,Object.defineProperty(n,i,{get:function(){return n.$fields[i]},set:function(r){o?o(n,t,items,r):n.$fields[i]=r}})}function p(n,t){return function(){return arguments.length==0?n.$fields[t]:n.$fields[t]=arguments[0]}}var c=i&&i.propertyChange,l=i&&i.arrayChange,a=i&&i.dataPropertyChange,v=i&&i.scalarNavigationPropertyChange,y=i&&i.pluralNavigationPropertyChange,o=i&&i.arraySet,r={},u=[];return f.forEachProperty(n,function(n,t){u.push({p:n,v:t})}),t&&t.hasMetadata&&(f.forEach(t.dataProperties,function(t){var i=n[t.name];i=i===undefined?null:t.handle(i);delete n[t.name];e(t,t.name,a);f.removeFromArray(u,t.name,"p");r[t.name]=i}),f.forEach(t.navigationProperties,function(t){var i=n[t.name];i===undefined&&(i=null);delete n[t.name];t.isScalar?(e(t,t.name,v),r[t.name]=i):h(t,t.name,i,y,o);f.removeFromArray(u,t.name,"p")})),f.forEach(u,function(i){var u=i.p,a=i.v;delete n[u];s.isArray(a)?h(u,u,a,l,o):(e(u,u,c),r[u]=a);f.findInArray(t.properties,u)||t.properties.push(u)}),n.$fields=r,n},n.getValue=function(n,t){return n[t]},n.setValue=function(n,t,i){n[t]=i},new t}(),jQueryAjaxProviderInstance:function(){function r(n){var t={status:n.status,xhr:n};if(n.responseText)try{t.detail=JSON.parse(n.responseText)}catch(i){}return f.createError(n.statusText,t)}function u(n){return function(t){return n.getResponseHeader(t)}}var n=function(){e.AjaxProviderBase.call(this,"jQuery Ajax Provider");f.tryFreeze(this)},i;return f.inherit(n,e.AjaxProviderBase),i=n.prototype,i.doAjax=function(n,i,f,e,o,s,h,c,l,a,v){var y={url:n,accepts:{json:"application/json; odata=verbose",xml:"text/xml; application/xhtml+xml;application/xml",text:"text/xml"},type:i,dataType:f,contentType:e,traditional:!1,data:o,async:s,timeout:h,headers:l,success:function(n,t,i){if(i.onreadystatechange=null,i.abort=null,n&&n.Error){var f=r(i);f.message=n.Error;v(f)}else a(n,u(i),i)},error:function(n){n.onreadystatechange=null;n.abort=null;v(r(n))}};return c!=null&&t.extend(y,c),y.cache==null&&(y.cache=!1),t.ajax(y)},new n}(),angularAjaxProviderInstance:function(){function u(n){return function(t){return t?n[t.toLowerCase()]:n}}var n=function(){e.AjaxProviderBase.call(this,"Angular Ajax Provider");this.syncSupported=!1;f.tryFreeze(this)},t,r;return f.inherit(n,e.AjaxProviderBase),t=n.prototype,i&&(r=i.injector(["ng"]).get("$http")),t.doAjax=function(n,t,i,e,s,h,c,l,a,v,y){if(h===!1)throw f.createError(o.syncNotSupported,[this.name]);var p={method:t,url:n,contentType:e,data:s,timeout:c,headers:a,responseType:i,transformResponse:[function(n){return n}]};return l!=null&&f.extend(p,l),p.cache==null&&(p.cache=!1),r(p).success(function(n,t,i){v(n,u(i()))}).catch(function(n){var t={status:n.status,config:n.config,detail:n.data,error:n};y(f.createError(n.statusText,t))})},new n}(),jsonSerializationServiceInstance:function(){var n=function(){e.SerializationServiceBase.call(this,"Json Serializer");f.tryFreeze(this)},t;return f.inherit(n,e.SerializationServiceBase),t=n.prototype,t.serialize=function(n){return JSON.stringify(n)},t.deserialize=function(n){return s.isTypeOf(n,"string")?JSON.parse(n):n},new n}(),qPromiseProviderInstance:function(){var t=function(){e.PromiseProviderBase.call(this,"Q Promise Provider");f.tryFreeze(this)},n;return f.inherit(t,e.PromiseProviderBase),n=t.prototype,n.deferred=function(){return u.defer()},n.getPromise=function(n){return n.promise},n.resolve=function(n,t){n.resolve(t)},n.reject=function(n,t){n.reject(t)},new t}(),angularPromiseProviderInstance:function(){var r=function(){e.PromiseProviderBase.call(this,"Angular Promise Provider");f.tryFreeze(this)},n,t,u;return f.inherit(r,e.PromiseProviderBase),n=r.prototype,i&&(t=i.injector(["ng"]),u=t.get("$q")),n.deferred=function(){return u.defer()},n.getPromise=function(n){return n.promise},n.resolve=function(n,i){n.resolve(i);t.get("$rootScope").$apply()},n.reject=function(n,i){n.reject(i);t.get("$rootScope").$apply()},new r}(),jQueryPromiseProviderInstance:function(){var i=function(){e.PromiseProviderBase.call(this,"jQuery Promise Provider");f.tryFreeze(this)},n;return f.inherit(i,e.PromiseProviderBase),n=i.prototype,n.deferred=function(){return t.Deferred()},n.getPromise=function(n){return n.promise()},n.resolve=function(n,t){n.resolve(t)},n.reject=function(n,t){n.reject(t)},new i}(),es6PromiseProviderInstance:function(){var t=function(){e.PromiseProviderBase.call(this,"ES6 Promise Provider");f.tryFreeze(this)},n;return f.inherit(t,e.PromiseProviderBase),n=t.prototype,n.deferred=function(){var n={resolve:null,reject:null};return n.promise=new Promise(function(t,i){n.resolve=t;n.reject=i}),n},n.getPromise=function(n){return n.promise},n.resolve=function(n,t){n.resolve(t)},n.reject=function(n,t){n.reject(t)},new t}()}}(),w=function(){return{DataProperty:function(){var t=function(n,t,i,r,u,f,e,o,s){this.owner=n;this.name=t;this.displayName=i||t;this.dataType=r;this.isNullable=u;this.isKeyPart=f;this.generationPattern=e;this.defaultValue=o;this.useForConcurrency=s;this.relatedNavigationProperties=[];this.validators=[];this.isEnum=r instanceof c.dataTypes.enumeration;this.isComplex=r.isComplex},n=t.prototype;return n.toString=function(){return this.displayName},n.isValid=function(n){return n==null?!this.isNullable:this.dataType.isValid(n,this)},n.handle=function(n){if(this.dataType!=c.dataTypes.string&&n===""&&(n=null),n==null){if(!this.isNullable)throw f.createError(o.notNullable,[this.displayName],{property:this});return null}if(n=this.dataType.handle(n,this),this.dataType==c.dataTypes.number&&this.precision&&n.toString().replace(/\./g,"").length>this.precision)throw f.createError(o.maxPrecisionError,[n,this.precision],{dataType:dataType,value:n});return this.dataType==c.dataTypes.number&&this.scale!=null&&(n=Number(n.toFixed(this.scale))),n},n.getDefaultValue=function(){return this.defaultValue!=null?this.defaultValue:this.isNullable?null:this.generationPattern==h.generationPattern.Identity&&this.isKeyPart===!0?this.dataType.autoValue():this.dataType.defaultValue()},n.addValidation=function(n,t,i,r){f.assertPrm(n,"name").isNotEmptyString().check();f.assertPrm(t,"func").isFunction().check();this.validators.push(new c.Validator(n,t,i,r))},n.validate=function(n){var i=[],r,t;return this.validators.length>0&&(r=this,t=f.getValue(n,this.name),f.forEach(this.validators,function(u){var e=u.validate(t,n);e&&i.push(f.createValidationError(n,t,r,e,u))})),i},t}(),NavigationProperty:function(){var t=function(n,t,i,r,u,f,e,o){this.owner=n;this.name=t;this.displayName=i||t;this.entityTypeName=r;this.entityType=null;this.isScalar=u;this.isComplex=f===undefined;this.associationName=f;this.cascadeDelete=e===!0;this.foreignKeyNames=o||[];this.inverse=null;this.foreignKeys=[];this.validators=[];this.triggerOwnerModify=!1},n=t.prototype;return n.toString=function(){return this.displayName},n.checkAssign=function(n){if(n!=null){if(!n.$tracker)throw f.createError(o.assignErrorNotEntity,[this],{property:this,value:n});var t=n.$tracker.entityType;if(!this.entityType.isAssignableWith(t))throw f.createError(o.assignError,[this.name,t.shortName],{property:this,value:n});}},n.addValidation=function(n,t,i,r){f.assertPrm(n,"name").isNotEmptyString().check();f.assertPrm(t,"func").isFunction().check();this.validators.push(new c.Validator(n,t,i,r))},n.validate=function(n){var r=[],t,i;return this.validators.length>0&&(t=this,i=f.getValue(n,t.name),f.forEach(this.validators,function(u){var e=u.validate(i);e&&r.push(f.createValidationError(n,i,t,e,u))})),r},t}(),EntityType:function(){function i(n,t){n.baseType&&i(n.baseType,t);n.constructor&&n.constructor.call(t,t)}function e(n,t){for(var r,u,e,o=n.length,i=0;i<o;i++){if(r=n[i],i==o-1)return u=f.findInArray(t.dataProperties,r,"name"),u?u:f.findInArray(t.navigationProperties,r,"name");if(e=f.findInArray(t.navigationProperties,r,"name"),e)t=e.entityType;else return null}return null}function r(n,t){return n.name===t.name?!0:t.baseType!=null?r(n,t.baseType):!1}function u(n,t){var i=s.isTypeOf(t,"string")?t:t.name;return n.name===i?!0:n.baseType!=null?u(n.baseType,t):!1}var t=function(n,t,i,r,u,f,e,o,s){this.name=n;this.displayName=t||n;this.shortName=i;this.keyNames=r||[];this.baseTypeName=u;this.setName=f;this.setTypeName=e;this.metadataManager=s;this.hasMetadata=s!=null;this.properties=[];this.dataProperties=[];this.navigationProperties=[];this.keys=[];this.floorType=this;this.baseType=null;this.validators=[];this.isComplexType=o==!0;this.constructor=null;this.initializer=null},n=t.prototype;return n.toString=function(){return this.name},n.getProperty=function(n){return e(n.split("."),this)},n.createQuery=function(n,t){if(n)return new l.EntityQuery(n,this,t);var i=new l.EntityQuery(this.setName,this,t);return this.shortName==this.setTypeName?i:i.ofType(this.shortName)},n.registerCtor=function(n,t){n!=null&&f.assertPrm(n,"constructor").isFunction().check();t!=null&&f.assertPrm(t,"initializer").isFunction().check();this.constructor=n;this.initializer=t},n.createEntity=function(n){var t=this.createRawEntity(n);return c.EntityTracker.toEntity(t,this,a.getObservableProvider())},n.createRawEntity=function(n){var t=n||{};return f.forEach(this.dataProperties,function(n){t[n.name]===undefined&&(t[n.name]=n.getDefaultValue())}),f.forEach(this.navigationProperties,function(n){t[n.name]=n.isComplex?n.entityType.createRawEntity():n.isScalar?null:[]}),i(this,t),t.$type=this.name,t},n.isAssignableWith=function(n){return r(this,n)},n.isAssignableTo=function(n){return u(this,n)},n.hasSameBaseType=function(n){return this.floorType.name===n.floorType.name},n.addDataProperty=function(n,t,i,r,u){var e,h;if(f.assertPrm(n,"name").isNotEmptyString().check(),e=f.findInArray(this.dataProperties,n,"name"),e)throw f.createError(o.dataPropertyAlreadyExists,[n],{entityType:this,existing:e});if(s.isNotEmptyString(i)&&(i=c.dataTypes.byName(i)),f.assertPrm(i,"dataType").isInstanceOf(c.dataTypes.baseType).check(),u!=null&&!i.isValid(u))throw f.createError(o.invalidDefaultValue,[u,i.name],{entityType:this,dataType:i,defaultValue:u});h=new w.DataProperty(this,n,t,i,r===!0,!1,null,u);this.dataProperties.push(h)},n.addValidation=function(n,t,i,r){f.assertPrm(n,"name").isNotEmptyString().check();f.assertPrm(t,"func").isFunction().check();this.validators.push(new c.Validator(n,t,i,r))},n.validate=function(n){var t=[];return this.validators.length>0&&f.forEach(this.validators,function(i){var r=i.validate(n);r&&t.push(f.createValidationError(n,null,null,r,i))}),f.forEach(this.dataProperties,function(i){var r=i.validate(n);r&&(t=t.concat(r))}),f.forEach(this.navigationProperties,function(i){var r=i.validate(n);r&&(t=t.concat(r))}),t},t}(),MetadataManager:function(){var t=function(n){this.types=[];this.typesDict={};this.enums={};this.name=null;this.displayName=null;n&&this.parseBeetleMetadata(n)},n=t.prototype;return n.toString=function(){return this.types.join(", ")},n.getEntityTypeByFullName=function(n,t){var i=f.findInArray(this.types,n,"name");if(!i&&t===!0)throw f.createError(o.notFoundInMetadata,[n],{metadataManager:this,typeName:n});return i},n.getEntityType=function(n,t){s.isFunction(n)&&(n=f.getFuncName(n));var i=this.typesDict[n];if(!i&&t===!0)throw f.createError(o.notFoundInMetadata,[n],{metadataManager:this,typeShortName:n});return i},n.createQuery=function(n,t,i){if(s.isFunction(t)&&(t=f.getFuncName(t)),t)return this.getEntityType(t,!0).createQuery(n,i);var r=f.filterArray(this.types,function(t){return t.setName==n});return r.length==1?r[0].createQuery(n,i):new l.EntityQuery(n,null,i)},n.registerCtor=function(n,t,i){s.isFunction(n)&&(n=f.getFuncName(n));var r=this.getEntityType(n,!0);r.registerCtor(t,i)},n.createEntity=function(n,t){s.isFunction(n)&&(n=f.getFuncName(n));var i=this.getEntityType(n,!0);return i.createEntity(t)},n.createRawEntity=function(n,t){s.isFunction(n)&&(n=f.getFuncName(n));var i=this.getEntityType(n,!0);return i.createRawEntity(t)},n.parseBeetleMetadata=function(n){var u,l,e,r,a,y,p,b,o,t,i,k,d;if(s.isTypeOf(n,"string")&&(n=JSON.parse(n)),this.types=[],this.typesDict={},this.enums={},this.name=n.n,this.displayName=f.getResourceValue(n.r,n.l||n.n),u=n.e,l={},u)for(e=0;e<u.length;e++)r=u[e],a={},f.forEach(r.m,function(n){a[n.n]={name:n.n,value:n.v,displayName:f.getResourceValue(n.r,n.l||n.n)}}),y=new v.Enum(a),this.enums[r.n]=y,l[r.n]=new c.dataTypes.enumeration(y,r.n,f.getResourceValue(r.r,r.l||r.n));for(p=this,b=n.m,o=0;o<b.length;o++)t=b[o],i=new w.EntityType(t.n,f.getResourceValue(t.rn,t.s),t.s,t.k,t.b,t.q,t.t,t.c,this),f.forEach(t.d,function(n){var u,e,r;u=n.e?l[n.t]:c.dataTypes.byName(n.t);e=f.getResourceValue(n.r,n.l||n.n);r=new w.DataProperty(i,n.n,e,u,n.i===!0,t.k&&f.findInArray(t.k,n.n)!=null,n.g?n.g=="I"?h.generationPattern.Identity:h.generationPattern.Computed:null,n.d?u.handle(n.d):null,n.c);n.v&&f.forEach(n.v,function(t){r.validators.push(c.Validator.byCode(t.t,t.a,t.m,t.r,r.displayName,n.r))});n.p&&(r.precision=Number(n.p));n.s&&(r.scale=Number(n.s));i.dataProperties.push(r)}),k=t.r,k&&f.forEach(k,function(n){var t=new w.NavigationProperty(i,n.n,f.getResourceValue(n.r,n.l||n.n),n.t,n.s===!0,n.a,n.c);n.f&&f.forEach(n.f,function(n){t.foreignKeyNames.push(n)});n.v&&f.forEach(n.v,function(i){t.validators.push(c.Validator.byCode(i.t,i.a,i.m,i.r,t.displayName,n.r))});i.navigationProperties.push(t)}),d=t.x,d&&f.forEach(d,function(n){var t=new w.NavigationProperty(i,n.n,f.getResourceValue(n.r,n.l||n.n),n.t,!0);i.navigationProperties.push(t)}),this.types.push(i),this.typesDict[i.shortName]=i;f.forEach(this.types,function(n){n.baseTypeName&&(n.baseType=p.getEntityType(n.baseTypeName,!0));delete n.baseTypeName});f.forEach(this.types,function(n){for(var t=n.baseType;t;)n.floorType=t,f.forEach(t.dataProperties,function(t){f.findInArray(n.dataProperties,t.name,"name")||n.dataProperties.push(t)}),f.forEach(t.navigationProperties,function(t){f.findInArray(n.navigationProperties,t.name,"name")||n.navigationProperties.push(t)}),t=t.baseType;f.forEach(n.navigationProperties,function(t){var i,r;if(!t.entityType)for(t.entityType=p.getEntityType(t.entityTypeName,!0),i=0;i<t.entityType.navigationProperties.length;i++)if(r=t.entityType.navigationProperties[i],r.associationName===t.associationName&&t!==r){t.inverse=r;break}f.forEach(t.foreignKeyNames,function(i){if(!f.findInArray(t.foreignKeys,i,"name")){var r=f.findInArray(n.dataProperties,i,"name");r&&(r.relatedNavigationProperties.push(t),t.foreignKeys.push(r))}})});f.forEach(n.keyNames,function(t){n.keys.push(f.findInArray(n.dataProperties,t,"name"))})})},t}()}}(),l=function(){return function(){String.prototype.hasOwnProperty("substringOf")||(String.prototype.substringOf=function(n){return s.isNotEmptyString(n)&&n.indexOf(this)>=0});String.prototype.hasOwnProperty("startsWith")||(String.prototype.startsWith=function(n){return this.indexOf(n)==0});String.prototype.hasOwnProperty("endsWith")||(String.prototype.endsWith=function(n){return this.indexOf(n)==this.length-n.length});Number.prototype.hasOwnProperty("round")||(Number.prototype.round=function(){return Math.round(this)});Number.prototype.hasOwnProperty("ceiling")||(Number.prototype.ceiling=function(){return Math.ceil(this)});Number.prototype.hasOwnProperty("floor")||(Number.prototype.floor=function(){return Math.floor(this)})}(),{expressions:function(){return{OfTypeExp:function(){var n=function(n){s.isFunction(n)&&(n=f.getFuncName(n));e.ExpressionBase.call(this,"oftype",-1,!0,!0);this.typeName=n},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.toBeetleQuery=function(){return this.typeName},t.clone=function(){return new n(this.typeName)},t.execute=function(n){var t=this;return f.filterArray(n,function(n){return n&&(n.$tracker&&n.$tracker.entityType.isAssignableTo(t.typeName)||typeof n===t.typeName)})},n}(),WhereExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"filter",2,!1,!1);this.exp=n;this.varContext=t},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);return f.filterArray(n,i)},n}(),OrderByExp:function(){function i(n){return n+=",",n=n.replace(/\,/," ,").replace(/ desc.*?\,/g," x,").replace(/ \,/g," desc,").replace(/ x\,/g,","),n.substr(0,n.length-1)}var r="x => x",t=function(n,t){e.ExpressionBase.call(this,"orderby",1,!1,!1);this.exp=n||r;this.isDesc=t||!1},n;return f.inherit(t,e.ExpressionBase),n=t.prototype,n.clone=function(){return new t(this.exp,this.isDesc)},n.toODataQuery=function(n){var t=s.isFunction(this.exp)?f.funcToLambda(this.exp):this.exp;return this.isDesc&&(t=i(t)),f.jsepToODataQuery(v.jsep(t),n)},n.toBeetleQuery=function(n){if(!this.exp)return"";var t=s.isFunction(this.exp)?f.funcToLambda(this.exp):this.exp;return this.isDesc&&(t=i(t)),f.jsepToBeetleQuery(v.jsep(t),n)},n.execute=function(n,t){var e,i,a,y,u;if(s.isFunction(this.exp))return e=this,n.sort(function(n,t){var i=e.exp(n,t);return e.isDesc?-1*i:i});var o=[],h=v.jsep(this.exp),c=h.type=="Compound"?h.body:[h];for(i=0;i<c.length;i++){var r=!1,p=c[i],l=c[i+1];l&&l.type=="Identifier"&&(a=l.name.toLowerCase(),a=="desc"?(r=!0,i++):a=="asc"&&i++);r=r!=this.isDesc;y=function(n,i){return function(r,u){var e=f.jsepToFunction(n,t),o=e(r),s=e(u);return o==s?0:o>s?i?-1:1:i?1:-1}}(p,r);o.push(y)}return u=[],u.push.apply(u,n),u.sort(function(n,t){for(var r,i=0;i<o.length;i++)if(r=o[i](n,t),r!=0)return r;return 0})},t}(),ExpandExp:function(){var n=function(n){e.ExpressionBase.call(this,"expand",1,!1,!1);this.exp=n},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n){return n},n}(),SelectExp:function(){var n=function(n){e.ExpressionBase.call(this,"select",2,!1,!0);this.exp=n},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){return s.isFunction(this.exp)?f.mapArray(n,this.exp):f.runSelectExp(n,this.exp,t)},n}(),SkipExp:function(){var t=function(n){e.ExpressionBase.call(this,"skip",2,!1,!1);this.count=n},n;return f.inherit(t,e.ExpressionBase),n=t.prototype,n.toODataQuery=function(){return this.count},n.toBeetleQuery=function(){return this.count},n.clone=function(){return new t(this.count)},n.execute=function(n){return n.slice(this.count)},t}(),TopExp:function(){var t=function(n){e.ExpressionBase.call(this,"top",2,!1,!1);this.count=n},n;return f.inherit(t,e.ExpressionBase),n=t.prototype,n.toODataQuery=function(){return this.count},n.toBeetleQuery=function(){return this.count},n.clone=function(){return new t(this.count)},n.execute=function(n){return n.slice(0,this.count)},t}(),GroupByExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"groupby",3,!0,!0);this.keySelector=n;this.elementSelector=t},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.toBeetleQuery=function(n){var t="",i,r;return this.keySelector&&(i=s.isFunction(this.keySelector)?f.funcToLambda(this.keySelector):this.keySelector,t+=f.jsepToBeetleQuery(v.jsep(i),n)),this.elementSelector&&(r=s.isFunction(this.elementSelector)?f.funcToLambda(this.elementSelector):this.elementSelector,t+=";"+f.jsepToBeetleQuery(v.jsep(r),n)),t},t.clone=function(){return new n(this.keySelector,this.elementSelector)},t.execute=function(n,t){var i=[],h,u,r,c,e,l,a,o,y;if(this.keySelector)for(h=s.isFunction(this.keySelector)?f.mapArray(n,this.keySelector):f.runSelectExp(n,this.keySelector,t),u=0;u<h.length;u++){for(r=null,c=h[u],e=0;e<i.length;e++)if(l=i[e],f.objEquals(l.Key,c)){r=l;break}r||(r={Key:c,Items:[]},i.push(r));r.Items.push(n[u])}else i.push({Key:null,Items:n});return this.elementSelector&&(s.isFunction(this.elementSelector)?a=this.elementSelector:(o=v.jsep(this.elementSelector),y=o.type=="Compound"?o.body:[o],a=f.jsepToProjector(y,t)),f.forEach(i,function(n,t){var u=n.Items,r;u.Key=n.Key;r=a(n.Items);i[t]=r})),i},n}(),DistinctExp:function(){function i(n){var t=[];return f.forEach(n,function(n){for(var r=!1,i=0;i<t.length;i++)if(f.objEquals(t[i],n)){r=!0;break}r===!1&&t.push(n)}),t}var n=function(n){e.ExpressionBase.call(this,"distinct",3,!0,!0);this.exp=n},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){return this.exp?s.isFunction(this.exp)?i(f.mapArray(n,this.exp)):i(f.runSelectExp(n,this.exp,t)):i(n)},n}(),ReverseExp:function(){var n=function(){e.ExpressionBase.call(this,"reverse",3,!0,!1)},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.toBeetleQuery=function(){return""},t.clone=function(){return new n},t.execute=function(n){return n.reverse()},n}(),SelectManyExp:function(){function i(n,t){var i,r,u;if(n.length==0)return n;for(i=[],r=0;r<n.length;r++)u=t(n[r]),i=i.concat.apply(i,u);return i}var n=function(n){e.ExpressionBase.call(this,"selectMany",3,!0,!0);this.exp=n},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){return n.length==0?n:s.isFunction(this.exp)?i(n,this.exp):i(n,f.jsepToFunction(v.jsep(this.exp),t))},n}(),SkipWhileExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"skipWhile",3,!0,!1);this.exp=n;this.varContext=t},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){for(var r=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t),i=0;r(n[i])==!0;)i++;return n.slice(i+1)},n}(),TakeWhileExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"takeWhile",3,!0,!1);this.exp=n;this.varContext=t},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){for(var r=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t),i=0;r(n[i])==!0;)i++;return n.slice(0,i)},n}(),AllExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;all",3,!0,!0);this.exp=n;this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);return l.queryFuncs.all.impl(n,function(){return n},i)},n}(),AnyExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;any",3,!0,!0);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);return l.queryFuncs.any.impl(n,function(){return n},i)}return n.length>0},n}(),AvgExp:function(){var n=function(n){e.ExpressionBase.call(this,"exec;avg",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t):function(n){return n};return l.queryFuncs.avg.impl(n,function(){return n},i)},n}(),MaxExp:function(){var n=function(n){e.ExpressionBase.call(this,"exec;max",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t):function(n){return n};return l.queryFuncs.max.impl(n,function(){return n},i)},n}(),MinExp:function(){var n=function(n){e.ExpressionBase.call(this,"exec;min",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t):function(n){return n};return l.queryFuncs.min.impl(n,function(){return n},i)},n}(),SumExp:function(){var n=function(n){e.ExpressionBase.call(this,"exec;sum",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t):function(n){return n};return l.queryFuncs.sum.impl(n,function(){return n},i)},n}(),CountExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;count",3,!0,!0);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);return f.filterArray(n,i).length}return n.length},n}(),FirstExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;first",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);n=f.filterArray(n,i)}if(n.length==0)throw f.createError(o.arrayEmpty,{array:n,expression:this});return n[0]},n}(),FirstOrDefaultExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;firstOD",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);n=f.filterArray(n,i)}return n.length==0?null:n[0]},n}(),SingleExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;single",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);n=f.filterArray(n,i)}if(n.length!=1)throw f.createError(o.arrayNotSingle,{array:n,expression:this});return n[0]},n}(),SingleOrDefaultExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;singleOD",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);n=f.filterArray(n,i)}if(n.length>1)throw f.createError(o.arrayNotSingleOrEmpty,{array:n,expression:this});return n.length==0?null:n[0]},n}(),LastExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;last",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);n=f.filterArray(n,i)}if(n.length==0)throw f.createError(o.arrayEmpty,{array:n,expression:this});return n[n.length-1]},n}(),LastOrDefaultExp:function(){var n=function(n,t){e.ExpressionBase.call(this,"exec;lastOD",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return f.inherit(n,e.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=s.isFunction(this.exp)?this.exp:f.jsepToFunction(v.jsep(this.exp),t);n=f.filterArray(n,i)}return n.length==0?null:n[n.length-1]},n}()}}(),queryFuncs:function(){var n={};return n.toupper=function(){var n=function(){e.QueryFuncBase.call(this,"toupper","ToUpper",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t){return(t?t(n):n).toUpperCase()},new n}(),n.touppercase=n.toupper,n.tolower=function(){var n=function(){e.QueryFuncBase.call(this,"tolower","ToLower",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t){return(t?t(n):n).toLowerCase()},new n}(),n.tolowercase=n.tolower,n.substring=function(){var n=function(){e.QueryFuncBase.call(this,"substring","Substring",3)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i,r){arguments.length==3?(r=i,i=t,t=n):t=t(n);i=i(n);r=r(n);var u=Number(i)+Number(r);return t&&t.substring(i,u)},new n}(),n.substringof=function(){var n=function(){e.QueryFuncBase.call(this,"substringof","Contains",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n,t){return t=t?t+".":"",t+"Contains("+n+")"},t.impl=function(n,t,i){return i=i?i(n):n,i=f.handleStrOptions(i,this.varContext),t=f.handleStrOptions(t(n),this.varContext),i&&i.indexOf(t)>=0},new n}(),n.length=function(){var n=function(){e.QueryFuncBase.call(this,"length","Length",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Length"},t.impl=function(n,t){return(t?t(n):n).length},new n}(),n.trim=function(){var n=function(){e.QueryFuncBase.call(this,"trim","Trim",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t){return(t?t(n):n).trim()},new n}(),n.concat=function(){var n=function(){e.QueryFuncBase.call(this,"concat","Concat",null)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(){return"string.Concat("+Array.prototype.slice.call(arguments).join(", ")+")"},t.impl=function(n){for(var i=arguments[1](n).toString(),r=Array.prototype.slice.call(arguments,2),u=[],t=0;t<r.length;t++)u.push(r[t](n));return i.concat.apply(i,u)},new n}(),n.replace=function(){var n=function(){e.QueryFuncBase.call(this,"replace","Replace",3)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i,r){return arguments.length==3?(r=i,i=t,t=n):t=t(n),i=i(n),f.ignoreWhiteSpaces(this.varContext)&&(i=i.trim()),f.isCaseSensitive(this.varContext)||(i=new RegExp(i,"gi")),t.replace(i,r(n))},new n}(),n.startswith=function(){var n=function(){e.QueryFuncBase.call(this,"startswith","StartsWith",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i){return arguments.length==2?(i=t,t=n):t=t(n),t=f.handleStrOptions(t,this.varContext),i=f.handleStrOptions(i(n),this.varContext),t&&t.indexOf(i,0)===0},new n}(),n.endswith=function(){var n=function(){e.QueryFuncBase.call(this,"endswith","EndsWith",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i){arguments.length==2?(i=t,t=n):t=t(n);t=f.handleStrOptions(t,this.varContext);i=f.handleStrOptions(i(n),this.varContext);var r=t.length-i.length;return t&&t.indexOf(i,r)!==-1},new n}(),n.indexof=function(){var n=function(){e.QueryFuncBase.call(this,"indexof","IndexOf",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i){return arguments.length==2?(i=t,t=n):t=t(n),t=f.handleStrOptions(t,this.varContext),i=f.handleStrOptions(i(n),this.varContext),t&&t.indexOf(i)},new n}(),n.contains=function(){var i=function(){e.QueryFuncBase.call(this,"contains","Contains",2)},t;return f.inherit(i,e.QueryFuncBase),t=i.prototype,t.toODataFunction=function(t,i){if(s.isTypeOf(t,"string"))return n.substringof.toODataFunction(i,t);var r=[];return f.forEach(t,function(n){r.push(i+" eq "+c.dataTypes.toODataValue(n))}),"("+r.join(" or ")+")"},t.toBeetleFunction=function(t,i){if(s.isTypeOf(t,"string"))return n.substringof.toBeetleFunction(i,t);var r=[];return f.forEach(t,function(n){r.push(i+" == "+c.dataTypes.toBeetleValue(n))}),"("+r.join(" || ")+")"},t.impl=function(n,t,i){var r,u;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),i=i?i(n):n,s.isArray(t)){for(r=0;r<t.length;r++)if(u=t[r],u==i)return!0;return!1}return t=f.handleStrOptions(t,this.varContext),i=f.handleStrOptions(i,this.varContext),t&&t.indexOf(i)>=0},new i}(),n.round=function(){var n=function(){e.QueryFuncBase.call(this,"round","Math.Round",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return"Math.Round("+n+")"},t.impl=function(n,t){return Math.round(t?t(n):n)},new n}(),n.ceiling=function(){var n=function(){e.QueryFuncBase.call(this,"ceiling","Math.Ceiling(%1)",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return"Math.Ceiling("+n+")"},t.impl=function(n,t){return Math.ceil(t?t(n):n)},new n}(),n.floor=function(){var n=function(){e.QueryFuncBase.call(this,"floor","Math.Floor",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return"Math.Floor("+n+")"},t.impl=function(n,t){return Math.floor(t?t(n):n)},new n}(),n.second=function(){var n=function(){e.QueryFuncBase.call(this,"second","Second",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Second"},t.impl=function(n,t){return t=c.dataTypes.date.handle(t?t(n):n),t.getSeconds()},new n}(),n.getseconds=n.second,n.minute=function(){var n=function(){e.QueryFuncBase.call(this,"minute","Minute",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Minute"},t.impl=function(n,t){return t=c.dataTypes.date.handle(t?t(n):n),t.getMinutes()},new n}(),n.getminutes=n.minute,n.hour=function(){var n=function(){e.QueryFuncBase.call(this,"hour","Hour",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Hour"},t.impl=function(n,t){return t=c.dataTypes.date.handle(t?t(n):n),t.getHours()},new n}(),n.gethours=n.hour,n.day=function(){var n=function(){e.QueryFuncBase.call(this,"day","Day",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Day"},t.impl=function(n,t){return t=c.dataTypes.date.handle(t?t(n):n),t.getDate()},new n}(),n.getdate=n.day,n.month=function(){var n=function(){e.QueryFuncBase.call(this,"month","Month",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Month"},t.impl=function(n,t){return t=c.dataTypes.date.handle(t?t(n):n),t.getMonth()+1},new n}(),n.getmonth=n.month,n.year=function(){var n=function(){e.QueryFuncBase.call(this,"year","Year",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Year"},t.impl=function(n,t){return t=c.dataTypes.date.handle(t?t(n):n),t.getFullYear()},new n}(),n.getfullyear=n.year,n.max=function(){var n=function(){e.QueryFuncBase.call(this,"max","Max",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw f.createError(o.functionNotSupportedForOData,["Max"]);},t.impl=function(n,t,i){var u,r,f;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),t.length==0)return null;for(u=i?i(t[0]):t[0],r=1;r<t.length;r++)f=i?i(t[r]):t[r],f>u&&(u=f);return u},new n}(),n.min=function(){var n=function(){e.QueryFuncBase.call(this,"min","Min",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw f.createError(o.functionNotSupportedForOData,["Min"]);},t.impl=function(n,t,i){var u,r,f;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),t.length==0)return null;for(u=i?i(t[0]):t[0],r=1;r<t.length;r++)f=i?i(t[r]):t[r],f<u&&(u=f);return u},new n}(),n.sum=function(){var n=function(){e.QueryFuncBase.call(this,"sum","Sum",2)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw f.createError(o.functionNotSupportedForOData,["Sum"]);},t.impl=function(n,t,i){var u,r,f;for(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),u=0,r=0;r<t.length;r++)f=t[r],u+=i?i(f):f;return u},new n}(),n.count=function(){var n=function(){e.QueryFuncBase.call(this,"count","Count",1)},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw f.createError(o.functionNotSupportedForOData,["Count"]);},t.impl=function(n,t){return(t?t(n):n).length},new n}(),n.avg=function(){var t=function(){e.QueryFuncBase.call(this,"avg","Average",2)},i;return f.inherit(t,e.QueryFuncBase),i=t.prototype,i.toODataFunction=function(){throw f.createError(o.functionNotSupportedForOData,["Avg"]);},i.impl=function(t,i,r){return(arguments.length==1?i=t:arguments.length==2?(r=i,i=t):i=i(t),i.length==0)?null:n.sum.impl(t,function(){return i},r)/i.length},new t}(),n.any=function(){var n=function(){e.QueryFuncBase.call(this,"any","Any",2);this.needsAlias=!0},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toODataFunction=function(n,t,i){return t+"/any("+n+": "+i+")"},t.impl=function(n,t,i){var r,u;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),!i)return t.length>0;for(r=0;r<t.length;r++)if(u=t[r],i(u)===!0)return!0;return!1},new n}(),n.all=function(){var n=function(){e.QueryFuncBase.call(this,"all","All",2);this.needsAlias=!0},t;return f.inherit(n,e.QueryFuncBase),t=n.prototype,t.toODataFunction=function(n,t,i){return t+"/all("+n+": "+i+")"},t.impl=function(n,t,i){var r,u;for(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),r=0;r<t.length;r++)if(u=t[r],i(u)!==!0)return!1;return!0},new n}(),n.getFunc=function(t,i){var r=n[t.toLowerCase()];if(r==null&&i!==!1)throw f.createError(o.unknownFunction,[t]);return r},n}(),ArrayQuery:function(){var t,n;return Array.prototype.asQueryable=function(){return new l.ArrayQuery(this)},Array.hasOwnProperty("q")||(Array.prototype.q=function(){return this.asQueryable()}),t=function(n){this.array=n;e.QueryBase.call(this)},f.inherit(t,e.QueryBase),n=t.prototype,n.executeAfterExecuter=!0,n.execute=function(n){return this.options&&(n=f.combine(this.options.varContext,n)),this.toFunction()(this.array,n)},n.clone=function(){var n=new l.ArrayQuery(this.array);return this.copy(n),n},n.copy=function(n){e.QueryBase.prototype.copy.call(this,n)},t}(),EntityQuery:function(){function i(n,t){if(n==null)return null;if(s.isTypeOf(n,"string")){if(t==null)throw f.createError(o.onlyManagerCreatedCanAcceptEntityShortName);return t.getEntityType(n,!0)}return f.assertPrm(n,"type").isInstanceOf(w.EntityType).check(),n}var t=function(n,t,r){this.resource=n;this.entityType=i(t,r);this.manager=r;this.liveValidate=r&&r.liveValidate;this.parameters=[];e.QueryBase.call(this)},n;return f.inherit(t,e.QueryBase),n=t.prototype,n.toString=function(){var n=[];return n.push("resource: ("+this.resource+")"),this.entityType&&n.push("entityType: ("+this.entityType.shortName+")"),this.manager&&n.push("manager: ("+this.manager.toString()+")"),n.push(e.QueryBase.prototype.toString.call(this)),n.join(", ")},n.expand=function(n){var t=this.clone();return t.addExpression(new l.expressions.ExpandExp(n))},n.include=function(){return this.expand.apply(this,arguments)},n.setParameter=function(n,t){var i=this.clone(),r=f.findInArray(i.parameters,n,"name");return r?r.value=t:i.parameters.push({name:n,value:t}),i},n.setEntityType=function(n){n=i(n,this.manager);var t=this.clone();return t.entityType=n,t},n.execute=function(n,t,i){if(!this.manager)throw f.createError(o.onlyManagerCreatedCanBeExecuted,{query:this,options:n});return this.manager.executeQuery(this,n,t,i)},n.executeLocally=function(n){if(!this.manager)throw f.createError(o.onlyManagerCreatedCanBeExecuted,{query:this,options:options});return this.manager.executeQueryLocally(this,n)},n.clone=function(){var n=new l.EntityQuery(this.resource,this.entityType,this.manager);return this.copy(n),n},n.copy=function(n){e.QueryBase.prototype.copy.call(this,n);f.forEach(this.parameters,function(t){n.parameters.push(t)})},t}()}}(),c=function(){return{ValueNotifyWrapper:function(){return function(n,t){this.value=n;this.fromBeetle=t===!0;f.tryFreeze(this)}}(),Event:function(){var t=function(n,t){this.name=n;this.subscribers=[];this.publisher=t},n=t.prototype;return n.toString=function(){return this.name},n.subscribe=function(n){f.findInArray(this.subscribers,n)||this.subscribers.push(n)},n.unsubscribe=function(n){f.removeFromArray(this.subscribers,n)},n.notify=function(){var n=arguments;f.forEach(this.subscribers,function(t){t.apply(t,n)})},t}(),dataTypes:function(){function t(n,t){throw f.createError(o.assignError,[n.name,t],{dataType:n,value:t});}var i=function(){var i=function(n){e.DataTypeBase.call(this,"dateBase");this.name=n},n;return f.inherit(i,e.DataTypeBase),n=i.prototype,n.defaultValue=function(){return new Date(Date.UTC(1753,1,1))},n.isValid=function(n){return Object.prototype.toString.call(n)==="[object Date]"},n.handle=function(n){if(!this.isValid(n)){var i=n;n=this.tryParse(i);n||t(this,i)}return n},n.autoValue=function(){return new Date},n.getRawValue=function(n){return n==null?null:a.getDateConverter().toISOString(n)},n.tryParse=function(n){return a.getDateConverter().parse(n)},n.toODataValue=function(n){return n=this.handle(n),"datetime'"+a.getDateConverter().toISOString(n)+"'"},n.toBeetleValue=function(n){return n=this.handle(n),'"'+a.getDateConverter().toISOString(n)+'"'},i}(),n={};return n.object=function(){var n=function(){e.DataTypeBase.call(this,"object");f.tryFreeze(this)},t;return f.inherit(n,e.DataTypeBase),t=n.prototype,t.toODataValue=function(n){return n},t.toBeetleValue=function(n){return n},new n}(),n.array=function(){var t=function(){e.DataTypeBase.call(this,"array");f.tryFreeze(this)},n;return f.inherit(t,e.DataTypeBase),n=t.prototype,n.isValid=function(n){return n instanceof Array},n.defaultValue=function(){return[]},n.handle=function(n){return this.isValid(n)||(n=n.split(",")),n},n.autoValue=function(){throw f.createError(o.notImplemented,[this.name,"defaultValue"]);},n.toODataValue=function(n){return n},n.toBeetleValue=function(n){return n},new t}(),n.func=function(){var n=function(){e.DataTypeBase.call(this,"function");f.tryFreeze(this)};return f.inherit(n,e.DataTypeBase),new n}(),n.string=function(){var i=0,t=function(){e.DataTypeBase.call(this,"string");f.tryFreeze(this)},n;return f.inherit(t,e.DataTypeBase),n=t.prototype,n.defaultValue=function(){return""},n.handle=function(n){return this.isValid(n)||(n=n.toString()),n},n.autoValue=function(){return"key_"+--i},n.toODataValue=function(n){return"'"+n.replace(/'/g,"''")+"'"},n.toBeetleValue=function(n){return'"'+n.replace(/"/g,'""')+'"'},new t}(),n.guid=function(){var i=function(){e.DataTypeBase.call(this,"guid");f.tryFreeze(this)},n;return f.inherit(i,e.DataTypeBase),n=i.prototype,n.defaultValue=function(){return"00000000-0000-0000-0000-000000000000"},n.isValid=function(n){return typeof n=="string"&&n.match(/^\{?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\}?$/i)},n.handle=function(n){return this.isValid(n)||t(this,n),n},n.autoValue=function(){return f.createGuid()},n.toODataValue=function(n){return"guid'"+n+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new i}(),n.date=function(){var n=function(){i.call(this,"date");f.tryFreeze(this)};return f.inherit(n,i),new n}(),n.dateTimeOffset=function(){var n=function(){i.call(this,"dateTimeOffset");f.tryFreeze(this)},t;return f.inherit(n,i),t=n.prototype,t.toODataValue=function(n){return n=this.handle(n),"datetimeoffset'"+a.getDateConverter().toISOString(n)+"'"},new n}(),n.time=function(){var i=function(){e.DataTypeBase.call(this,"time");f.tryFreeze(this)},n;return f.inherit(i,e.DataTypeBase),n=i.prototype,n.defaultValue=function(){return"00:00:00"},n.isValid=function(n){return/^([01]?\d|2[0-3])(((:[0-5]?\d){2}(\.\d{1,3}){0,1})|(:[0-5]?\d){0,2})?$/.test(n)},n.handle=function(n){return this.isValid(n)||t(this,n),n},n.autoValue=function(){return"00:00:00"},n.toODataValue=function(n){return"time'"+n+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new i}(),n.boolean=function(){var i=function(){e.DataTypeBase.call(this,"boolean");f.tryFreeze(this)},r;return f.inherit(i,e.DataTypeBase),r=i.prototype,r.defaultValue=function(){return!1},r.handle=function(i){if(!this.isValid(i)){if(n.string.isValid(i)){var r=i.toLowerCase();if(r=="true"||r=="1")return!0;if(r=="false"||r=="0")return!1}throw t(this,i);}return i},new i}(),n.int=function(){var r=0,i=function(){e.DataTypeBase.call(this,"int");f.tryFreeze(this)},n;return f.inherit(i,e.DataTypeBase),n=i.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return typeof n=="number"&&n%1==0},n.handle=function(n){var i=n;return typeof n!="number"&&(n=Number(n)),this.isValid(n)||t(this,i),n},n.autoValue=function(){return--r},new i}(),n.number=function(){var r=0,i=function(){e.DataTypeBase.call(this,"number");f.tryFreeze(this)},n;return f.inherit(i,e.DataTypeBase),n=i.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return!isNaN(n)&&typeof n=="number"},n.handle=function(n){var i=n;return typeof n!="number"&&(n=Number(n)),this.isValid(n)||t(this,i),n},n.autoValue=function(){return--r},new i}(),n.byte=function(){var r=0,i=function(){e.DataTypeBase.call(this,"byte");f.tryFreeze(this)},n;return f.inherit(i,e.DataTypeBase),n=i.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return typeof n=="number"&&n%1==0&&n>=0&&n<256},n.handle=function(n){var i=n;return typeof n!="number"&&(n=Number(n)),this.isValid(n)||t(this,i),n},n.autoValue=function(){return--r},new i}(),n.binary=function(){var t=function(){e.DataTypeBase.call(this,"binary");f.tryFreeze(this)},n;return f.inherit(t,e.DataTypeBase),n=t.prototype,n.defaultValue=function(){return'"AAAAAAAAAAA="'},n.isValid=function(){return!0},n.handle=function(n){return n},n.toODataValue=function(n){return n=this.handle(n),"X'"+a.getDateConverter().toISOString(n)+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new t}(),n.enumeration=function(){function i(n,t){var r,u,e,i,o;if(s.isArray(n))return r=0,f.forEach(n,function(n){r|=n.value}),r;if(u=Number(n),isNaN(u)||(n=u),s.isTypeOf(n,"string")){for(e=n.split(","),n=0,i=0;i<e.length;i++)if(o=t[e[i]],o!=null)n|=o.value;else return null;return n}return s.isTypeOf(n,"number")?n:s.isEnum(n,t)?n.value:null}var t=function(n,t,i){e.DataTypeBase.call(this,"enum");this.enumType=n;this.enumTypeName=t;this.displayName=i||t;f.tryFreeze(this)},n;return f.inherit(t,e.DataTypeBase),n=t.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return i(n,this.enumType)!=null},n.handle=function(n){var t=i(n,this.enumType);if(t==null)throw f.createError(o.invalidEnumValue,[n,this.enumTypeName],{enumType:this.enumType,value:n});return t},n.getRawValue=function(n){return s.isEnum(n,this.enumType)?n.value:n},n.toODataValue=function(n){return this.getRawValue(n)},n.toBeetleValue=function(n){return this.getRawValue(n)},t}(),n.geometry=function(){var t=function(){e.DataTypeBase.call(this,"geometry");this.isComplex=!0;f.tryFreeze(this)},n;return f.inherit(t,e.DataTypeBase),n=t.prototype,n.defaultValue=function(){return{$type:"System.Data.Spatial.DbGeometry",CoordinateSystemId:null,WellKnownText:"",WellKnownBinary:null}},n.isValid=function(n){return n.$tracker&&n.$tracker.getValue("WellKnownText")},n.handle=function(n){return n.$tracker&&(n.$tracker.entityType.isComplexType=!0),n},new t}(),n.geography=function(){var t=function(){e.DataTypeBase.call(this,"geography");this.isComplex=!0;f.tryFreeze(this)},n;return f.inherit(t,e.DataTypeBase),n=t.prototype,n.defaultValue=function(){return{$type:"System.Data.Spatial.DbGeography",CoordinateSystemId:null,WellKnownText:"",WellKnownBinary:null}},n.isValid=function(n){return n.$tracker&&n.$tracker.getValue("WellKnownText")},n.handle=function(n){return n.$tracker&&(n.$tracker.entityType.isComplexType=!0),n},new t}(),n.byName=function(t){var i=n[t];if(!i)throw f.createError(o.unknownDataType,[t]);return i},n.byValue=function(t){return n.string.isValid(t)?n.guid.isValid(t)?n.guid:n.date.tryParse(t)?n.date:n.string:n.date.isValid(t)?n.date:n.boolean.isValid(t)?n.boolean:n.int.isValid(t)?n.int:n.number.isValid(t)?n.number:n.array.isValid(t)?n.array:s.isObject(t)?n.object:n.binary},n.handle=function(t){var i=n.date.tryParse(t);return i!=null?i:t},n.toODataValue=function(t){return t==null?"null":n.byValue(t).toODataValue(t)},n.toBeetleValue=function(t){return t==null?"null":n.byValue(t).toBeetleValue(t)},n}(),Validator:function(){function t(t,i,r,u){var e=function(n){return n==null?!1:i.test(n)};return r=f.formatString(r||o.invalidValue,u),new n(t,e,r,{pattern:i})}var n=function(n,t,i,r){this.name=n;this.func=t;this.message=i;this.args=r;f.tryFreeze(this)},i=n.prototype;return i.toString=function(){var n=[],t;if(this.args)for(t in this.args)n.push(t+": "+this.args[t]);return n.length>0?this.name+" ("+n.join(", ")+")":this.name},i.validate=function(n,t){return this.func(n,t)==!0?null:this.message},n.byCode=function(t,i,r,u,e,s){var h=a.getLocalizeFunction();h&&(r=u&&h(u)||r,e=s&&h(s)||e);i=i||[];i.push(r);i.push(e);switch(t){case"re":return n.required.apply(null,i);case"sl":return n.stringLength.apply(null,i);case"ma":return n.maxLength.apply(null,i);case"mi":return n.minLength.apply(null,i);case"ra":return n.range.apply(null,i);case"rx":return n.regularExpression.apply(null,i);case"ea":return n.emailAddress.apply(null,i);case"cc":return n.creditCard.apply(null,i);case"ur":return n.url.apply(null,i);case"ph":return n.phone.apply(null,i);case"po":return n.postalCode.apply(null,i);case"ti":return n.time.apply(null,i);case"co":return n.compare.apply(null,i);default:throw f.createError(o.unknownValidator,[t]);}},n.required=function(t,i,r){var u=function(n){return n==null?!1:s.isTypeOf(n,"string")&&!t&&n==""?!1:!0};return i=f.formatString(i||o.requiredError,r),new n("Required",u,i,{allowEmptyStrings:t})},n.stringLength=function(t,i,r,u){var e=function(n){return!t&&!i?!0:s.isNotEmptyString(n)?t&&n.length<t?!1:i&&n.length>i?!1:!0:!1};return r=f.formatString(r||o.stringLengthError,u,t,i),new n("StringLength",e,r,{min:t,max:i})},n.maxLength=function(t,i,r){var u=function(n){return n==null?!0:t&&n.length>t?!1:!0};return i=f.formatString(i||o.maxLenError,r,t),new n("MaxLength",u,i,{length:t})},n.minLength=function(t,i,r){var u=function(n){return n==null?!1:t&&n.length<t?!1:!0};return i=f.formatString(i||o.minLenError,r,t),new n("MinLength",u,i,{length:t})},n.range=function(t,i,r,u){var e=function(n){return!t&&!i?!0:t&&n<t?!1:i&&n>i?!1:!0};return r=f.formatString(r||o.rangeError,u,t,i),new n("Range",e,r,{min:t,max:i})},n.regularExpression=function(n,i,r){return s.isTypeOf(n,"string")&&(n=new RegExp(n)),t("RegularExpression",n,i,r)},n.emailAddress=function(n,i){return t("EmailAddress",/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,n,i)},n.creditCard=function(n,i){return t("CreditCard",/^((4\d{3})|(5[1-5]\d{2})|(6011)|(3[68]\d{2})|(30[012345]\d))[ -]?(\d{4})[ -]?(\d{4})[ -]?(\d{4}|3[4,7]\d{13})$/,n,i)},n.url=function(n,i){return t("Url",/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/,n,i)},n.phone=function(n,i){return t("Phone",/^(?!.*-.*-.*-)(?=(?:\d{8,10}$)|(?:(?=.{9,11}$)[^-]*-[^-]*$)|(?:(?=.{10,12}$)[^-]*-[^-]*-[^-]*$)  )[\d-]+$/,n,i)},n.postalCode=function(n,i){return t("PostalCode",/^\d{5}([\-]?\d{4})?$/,n,i)},n.time=function(n,i){return t("Time",/^([01]?\d|2[0-3])(((:[0-5]?\d){2}(\.\d{1,3}){0,1})|(:[0-5]?\d){0,2})?$/,n,i)},n.compare=function(t,i,r){var e=function(n,i){var r=f.getValue(i,t);return n==r},u=a.getLocalizeFunction(),s=u&&u(t)||t;return i=f.formatString(i||o.compareError,r,s),new n("Compare",e,i,{property:t})},n}(),EntityContainer:function(){function i(n,t){var i=new r(n);return t.push(i),i}var r=function(){function r(n,t){var r=i(n,t);return r>-1?t[r]:null}function i(n,t){var f=t.length,r,u,i;if(f>0)for(r=0,u=f-1;r<=u;){if(i=Math.floor((r+u)/2),t[i].key<n){r=i+1;continue}if(t[i].key>n){u=i-1;continue}return i}return-1}function u(n,t){for(var i=0;i<t.length&&n>t[i].key;)i++;return i}var t=function(n){this.typeName=n.name;this.keyIndex=[];f.tryFreeze(this)},n=t.prototype;return n.toString=function(){return this.typeName+": "+this.keyIndex.length},n.push=function(n,t){var i=u(n,this.keyIndex);this.keyIndex.splice(i,0,{key:n,entity:t})},n.remove=function(n){var t=i(n,this.keyIndex);this.keyIndex.splice(t,1)},n.getEntity=function(n){var t=r(n,this.keyIndex);return t?t.entity:null},n.getRelations=function(n,t){for(var r,u=[],i=0;i<this.keyIndex.length;i++)r=this.keyIndex[i],r.entity.$tracker.foreignKey(t)===n&&u.push(r.entity);return u},n.relocateKey=function(n,t,i){this.remove(t);i&&this.push(i,n)},n.getEntities=function(){var n=[];return f.forEach(this.keyIndex,function(t){n.push(t.entity)}),n},t}(),t=function(){this.entitySets=[];this.allEntities=[];f.tryFreeze(this)},n=t.prototype;return n.toString=function(){return this.allEntities.length},n.push=function(n){var u;this.allEntities.push(n);var i=n.$tracker,t=i.entityType,r=i.key;if(r)while(t)u=this.getEntitySet(t),u.push(r,n),t=t.baseType},n.remove=function(n){var i;f.removeFromArray(this.allEntities,n);var r=n.$tracker,t=r.entityType,u=r.key;if(u)while(t)i=this.findEntitySet(t),i&&(i.remove(u),t=t.baseType)},n.getEntities=function(){return this.allEntities},n.getEntityByKey=function(n,t){if(!n)return null;var i=this.findEntitySet(t);return i?i.getEntity(n):null},n.getRelations=function(n,t){var u=t.entityType,r=n.$tracker.key,i;return r?(i=this.findEntitySet(u),i)?i.getRelations(r,t):null:null},n.relocateKey=function(n,t,r){for(var u=n.$tracker.entityType,f;u;)f=this.findEntitySet(u),f?f.relocateKey(n,t,r):(f=i(u,this.entitySets),f.push(r,n)),u=u.baseType},n.getChanges=function(){return f.filterArray(this.allEntities,function(n){return!(n.$tracker.entityType.isComplexType&&n.$tracker.owners.length>0)&&n.$tracker.isChanged()})},n.count=function(){return this.allEntities.length},n.findEntitySet=function(n){return f.findInArray(this.entitySets,n.name,"typeName")},n.getEntitySet=function(n){var t=this.findEntitySet(n);return t||(t=i(n,this.entitySets)),t},t}(),EntitySet:function(){function i(n,t){var r,i,u;if(n==null)throw f.createError(o.cannotCheckInstanceOnNull);if(r=t.entityType,!r.isAssignableWith(n)&&(i=n.$tracker&&n.$tracker.entityType,u=i&&i.shortName||"Object",!i||!r.isAssignableWith(i)))throw f.createError(o.typeError,[u,r.shortName]);}var t=function(n,t){this.local=t.entities.getEntitySet(n);l.EntityQuery.call(this,n.setName,n,t)},n;return f.inherit(t,l.EntityQuery),n=t.prototype,n.toString=function(){return"EntitySet: "+this.entityType.shortName},n.create=function(n){var t=this.entityType.createEntity(n);return this.manager.addEntity(t),t},n.createDetached=function(n){return this.entityType.createEntity(n)},n.createRaw=function(n){return this.entityType.createRawEntity(n)},n.add=function(n){i(n,this);this.manager.addEntity(n)},n.attach=function(n){i(n,this);this.manager.attachEntity(n)},n.remove=function(n){i(n,this);this.manager.deleteEntity(n)},t}(),EntityTracker:function(){function w(n,t,i,r){r.entity=n;n.$tracker=r;r.entityType=t;r.entityState=h.entityStates.Detached;r.observableProvider=i;r.forceUpdate=!1;r.originalValues=[];r.changedValues=[];r.manager=null;r.owners=[];r.validationErrors=[];r.validationErrorsChanged=new c.Event("validationErrorsChanged",r);r.entityStateChanged=new c.Event("entityStateChanged",r);r.propertyChanged=new c.Event("propertyChanged",r);r.arrayChanged=new c.Event("arrayChanged",r);t.hasMetadata&&(r.key=l(r))}function b(n,t,i){var r={propertyChange:k,arrayChange:d,dataPropertyChange:g,scalarNavigationPropertyChange:nt,pluralNavigationPropertyChange:tt,arraySet:it};return i.observableProvider.toObservable(n,t,r)}function e(n,t){n.baseType&&e(n.baseType,t);n.initializer&&n.initializer.call(t,t)}function l(n,t,i){var e=n.entityType,o,r,u,f;if(e.keys.length==0)return null;for(o=[],r=0;r<e.keys.length;r++)u=e.keys[r],f=u===t?i:n.getValue(u.name),u.dataType.name=="guid"&&(f=f.toLowerCase()),o.push(f);return o.join(",")}function v(n,t,i,r){if(!n)throw f.createError(o.propertyNotFound,[t],{propertyName:t,entity:r.entity,manager:r.manager});var u=n.entityType.createQuery(i,r.manager);return n.isScalar?f.forEach(n.foreignKeys,function(t,i){var f=n.entityType.keys[i],e=r.getValue(t.name);u=u.where(f.name+" == @0",[e])}):f.forEach(n.foreignKeyNames,function(n,t){var i=r.getValue(r.entityType.keys[t]);u=u.where(n+" == @0",[i])}),u}function k(n,i,r,u){var h=!1,e,f,o;(s.isInstanceOf(u,c.ValueNotifyWrapper)&&(h=!u.fromBeetle,u=u.value),e=r(),e!==u)&&(f=n.$tracker,f.manager&&(o=f.manager.handleUnmappedProperties),o==null&&(o=a.handleUnmappedProperties),o!==!0||(u=c.dataTypes.handle(u),e!==u))&&(r(u),f.manager&&t(n,i,e,f),h||f.propertyChanged.notify({entity:n,property:i,oldValue:e,newValue:u}))}function d(n,i,r,u,f){var e=n.$tracker;e.manager&&t(n,null,null,e);e.arrayChanged.notify({entity:n,property:i,items:r,removedItems:u,addedItems:f})}function g(n,r,u,e){var it=!1,nt=!1,v,k,y,w,b,g,d;if((s.isInstanceOf(e,c.ValueNotifyWrapper)&&(it=e.fromBeetle,nt=!e.fromBeetle,e=e.value),v=u(),v!==e)&&(e=r.handle(e),v!==e)&&(r.dataType!==c.dataTypes.date&&r.dataType!==c.dataTypes.dateTimeOffset||v==null||e==null||v.valueOf()!==e.valueOf())){var h=n.$tracker,tt=null,p=null;if(r.isKeyPart){if(tt=h.key,p=l(h,r,e),h.manager&&(k=h.manager.getEntityByKey(p,h.entityType.floorType),k&&k!==n))throw f.createError(o.sameKeyExists,{key:p,entity:k});h.key=p}if(y=h.liveValidate,h.manager?(t(n,r.name,r.dataType.getRawValue(v),h),y==null&&(y=h.manager.liveValidate)):h.entityType.isComplexType&&f.forEach(h.owners,function(n){t(n.entity,n.property.name+"."+r.name,e,n.entity.$tracker)}),u(e),y==null&&(y=a.liveValidate),y===!0&&i(r.validate(n),h,r),nt||h.propertyChanged.notify({entity:n,property:r,oldValue:v,newValue:e}),r.isKeyPart&&(h.manager&&h.manager.entities.relocateKey(n,tt,p),rt(n)),r.isComplex){for(w=v.$tracker.owners,b=w.length-1;b>=0;b--)g=w[b],g.entity==n&&g.property==r&&w.splice(b,1);w.length==0&&v.$tracker.manager&&v.$tracker.manager.detachEntity(v);e.$tracker.owners.push({entity:n,property:r})}h.manager&&(d=h.manager.autoFixScalar,d==null&&(d=a.autoFixScalar),f.forEach(r.relatedNavigationProperties,function(n){var t,i,r;if(n.isScalar===!0)if(t=h.foreignKey(n),t){if(i=h.getValue(n.name),i&&i.$tracker.key===t)return;r=null;d&&(r=h.manager.getEntityByKey(t,n.entityType));r?h.setValue(n.name,r):i&&h.setValue(n.name,new c.ValueNotifyWrapper(null,!0))}else h.setValue(n.name,null)}))}}function nt(n,r,e,h){var g=!1,nt=!1,l,v,p,b,w,k,y,d;if(s.isInstanceOf(h,c.ValueNotifyWrapper)&&(g=h.fromBeetle,nt=!h.fromBeetle,h=h.value),l=e(),l!==h)if(r.checkAssign(h),e(h),v=n.$tracker,p=v.liveValidate,p==null&&v.manager&&(p=v.manager.liveValidate),p==null&&(p=a.liveValidate),p===!0&&i(r.validate(n),v,r),nt||v.propertyChanged.notify({entity:n,property:r,oldValue:l,newValue:h}),u(h,v.manager),r.isComplex){if(h==null)throw f.createError(o.complexCannotBeNull,[r.displayName],{entity:n,property:r});for(b=l.$tracker.owners,w=b.length-1;w>=0;w--)k=b[w],k.entity==n&&k.property==r&&b.splice(w,1);l.$tracker.owners.length==0&&l.$tracker.manager&&l.$tracker.manager.detachEntity(l);h.$tracker.owners.push({entity:n,property:r});t(n,r.name,h.$tracker.toRaw(),v)}else g||(r.triggerOwnerModify&&r.foreignKeys.length==0&&t(n,null,null,v),f.setForeignKeys(n,r,h)),y=r.inverse,y&&(y.isScalar?(l&&l.$tracker.setValue(y.name,null),h&&h.$tracker.setValue(y.name,n)):(l&&l.$tracker.getValue(y.name).remove(n),h&&(d=h.$tracker.getValue(y.name),f.findInArray(d,n)||d.push(n))))}function tt(n,r,e,o,s){var h=n.$tracker,c=h.liveValidate,l;c==null&&h.manager&&(c=h.manager.liveValidate);c==null&&(c=a.liveValidate);c===!0&&i(r.validate(n),h,r);r.triggerOwnerModify&&t(n,null,null,h);h.arrayChanged.notify({entity:n,property:r,items:e,removedItems:o,addedItems:s});l=r.inverse;l?(o&&f.forEach(o,function(t){t.$tracker.getValue(l.name)==n&&t.$tracker.setValue(l.name,null)}),s&&f.forEach(s,function(t){u(t,h.manager);t.$tracker.setValue(l.name,n)})):(o&&f.forEach(o,function(n){f.setForeignKeys(n,r,null)}),s&&f.forEach(s,function(t){u(t,h.manager);f.setForeignKeys(t,r,n)}))}function it(n,t,i,r){var s,e,u,c;if(i!==r){if(s=a.getArraySetBehaviour(),s==h.arraySetBehaviour.NotAllowed)throw f.createError(o.settingArrayNotAllowed,{entity:n,property:t});if(e=[],u=f.filterArray(r,function(){return!0}),s==h.arraySetBehaviour.Replace?f.forEach(i,function(n){f.findInArray(u,n)?f.removeFromArray(u,n):e.push(n)}):s==h.arraySetBehaviour.Append&&f.forEach(r,function(n){f.findInArray(i,n)&&f.removeFromArray(u,n)}),e.length>0)for(c=e.length-1;c>=0;c--)i.splice(f.indexOf(i,e[c]),1);u.length>0&&i.push.apply(i,u)}}function rt(n){var t=n.$tracker;f.forEach(t.entityType.navigationProperties,function(i){var r,e,u;i.isScalar?(r=i.inverse,r&&r.isScalar&&(e=t.getValue(i.name),e&&f.setForeignKeys(e,r,n))):(u=t.getValue(i.name),u&&u.length>0&&f.forEach(u,function(t){f.setForeignKeys(t,i,n)}))})}function u(n,t){if(n&&t&&!n.$tracker.entityType.isComplexType&&!t.isInManager(n)&&n.$tracker.manager!=t){if(n.$tracker.manager)throw f.createError(o.entityAlreadyBeingTracked,null,{entity:n,manager:t});t.addEntity(n)}}function t(n,i,r,u){var e=u.entityState;e==h.entityStates.Unchanged&&(f.forEach(u.entityType.navigationProperties,function(n){var r=n.inverse,i;r&&r.triggerOwnerModify&&(i=u.getValue(n.name),i&&(n.isScalar?t(i,null,null,i.$tracker):f.forEach(i,function(n){t(n,null,null,n.$tracker)})))}),u.toModified());ut(i,r,u.originalValues,u.changedValues)}function ut(n,t,i,r){var u,e;n!=null&&(t==null||t.$tracker==null||t.$tracker.entityType.isComplexType)&&(u=f.findInArray(i,n,"p"),u||i.push({p:n,v:t}),e=f.findInArray(r,n,"p"),e||r.push({p:n,v:t}))}function i(n,t,i){var r=[],u=i?f.filterArray(t.validationErrors,function(n){return n.property===i}):f.filterArray(t.validationErrors,function(){return!0});f.forEach(u,function(i){f.findInArray(n,i.validator,"validator")?f.removeFromArray(n,i.validator,"validator"):(f.removeFromArray(t.validationErrors,i),r.push(i))});t.validationErrors=t.validationErrors.concat(n);(r.length>0||n.length>0)&&t.validationErrorsChanged.notify({errors:t.validationErrors,added:n,removed:r})}function y(n){if(n.manager==null)throw f.createError(o.entityNotBeingTracked,{entity:entity,manager:n});}var r=function(n,t,i){delete n.$type;delete n.$id;w(n,t,i||a.getObservableProvider(),this);b(n,t,this);e(t,n)},n=r.prototype;return n.toString=function(){return"EntityTracker: "+this.entityType.shortName+", key: "+this.key},n.setManagerInfo=function(n){if(this.manager)throw f.createError(o.entityAlreadyBeingTracked,{otherManager:this.manager});f.assertPrm(n,"manager").isInstanceOf(c.EntityManager).check();this.manager=n},n.isChanged=function(){return this.entityState===h.entityStates.Added||this.entityState===h.entityStates.Deleted||this.entityState===h.entityStates.Modified},n.delete=function(){y(this);this.manager.deleteEntity(this.entity)},n.detach=function(){y(this);this.manager.detachEntity(this.entity)},n.toAdded=function(){if(this.entityState!=h.entityStates.Added){var n={entity:this.entity,oldState:this.entityState,newState:h.entityStates.Added,newChanged:!this.isChanged()};this.entityState=h.entityStates.Added;this.entityStateChanged.notify(n)}},n.toModified=function(){if(this.entityState!=h.entityStates.Modified){var n={entity:this.entity,oldState:this.entityState,newState:h.entityStates.Modified,newChanged:!this.isChanged()};this.entityState=h.entityStates.Modified;this.entityStateChanged.notify(n)}},n.toDeleted=function(){if(this.entityState!=h.entityStates.Deleted){var n={entity:this.entity,oldState:this.entityState,newState:h.entityStates.Deleted,newChanged:!this.isChanged()};this.entityState=h.entityStates.Deleted;this.entityStateChanged.notify(n)}},n.toUnchanged=function(){if(this.entityState!=h.entityStates.Unchanged){var n={entity:this.entity,oldState:this.entityState,newState:h.entityStates.Unchanged,newUnchanged:this.isChanged()};this.originalValues.length=0;this.changedValues.length=0;this.entityState=h.entityStates.Unchanged;this.entityStateChanged.notify(n)}},n.toDetached=function(){if(this.entityState!=h.entityStates.Detached){var n={entity:this.entity,oldState:this.entityState,newState:h.entityStates.Detached,newUnchanged:this.isChanged()};this.entityState=h.entityStates.Detached;this.entityStateChanged.notify(n)}},n.rejectChanges=function(){var n=this;f.forEach(this.originalValues,function(t){n.setValue(t.p,t.v)});this.originalValues.length=0},n.undoChanges=function(){var n=this;f.forEach(this.changedValues,function(t){n.setValue(t.p,t.v)});this.changedValues.length=0},n.acceptChanges=function(){this.changedValues.length=0},n.getValue=function(n){return this.observableProvider.getValue(this.entity,n)},n.setValue=function(n,t){this.observableProvider.setValue(this.entity,n,t)},n.getOriginalValue=function(n){var t=f.findInArray(this.originalValues,n,"p");return t?t.v:this.getValue(n)},n.foreignKey=function(n){var r=n.entityType,u,t;if(r.keys.length==0)return null;for(u=[],t=0;t<r.keys.length;t++){var f=r.keys[t],e=n.foreignKeyNames[t],i=this.getValue(e);if(i==null)return null;f.dataType.name=="guid"&&(i=i.toLowerCase());u.push(i)}return u.join(",")},n.createLoadQuery=function(n,t){var i=f.findInArray(this.entityType.navigationProperties,n,"name");return v(i,n,t,this)},n.loadNavigationProperty=function(n,t,i,r,u,e){var c,s,l;if(this.manager==null)throw f.createError(o.entityNotBeingTracked,{entity:this.entity});return c=f.findInArray(this.entityType.navigationProperties,n,"name"),s=v(c,n,i,this),t&&f.forEach(t,function(n){s=s.expand(n)}),l=this,r=r||{},r.merge==null&&(r.merge=h.mergeStrategy.Preserve),r.autoFixScalar==null&&(r.autoFixScalar=!0),r.autoFixPlural==null&&(r.autoFixPlural=!0),this.manager.executeQuery(s,r,function(){c.inverse||l.manager.fixNavigations(entity);u&&u.apply(null,arguments)},e)},n.validate=function(){return this.entityState==h.entityStates.Deleted?this.validationErrors=[]:i(this.entityType.validate(this.entity),this),this.validationErrors},n.toRaw=function(n){var i=this.entityType,t={},r=this;return i.hasMetadata&&(f.forEach(i.dataProperties,function(i){var u=r.getValue(i.name);u!=null&&u.$tracker?(n==!0||u.$tracker.entityType.isComplexType)&&(t[i.name]=u.$tracker.toRaw(n)):t[i.name]=i.dataType.getRawValue(u)}),n==!0&&f.forEach(i.navigationProperties,function(n){var i=r.getValue(n.name);i==null?t[n.name]=null:s.isArray(i)?f.forEach(i,function(n){n!=null&&n.$tracker?t[p].push(n.$tracker.toRaw(!0)):t[p].push(n)}):t[n.name]=i.$tracker.toRaw(!0)})),f.forEach(i.properties,function(i){var u=r.getValue(i);s.isArray(u)?(t[i]=[],f.forEach(u,function(r){r!=null&&r.$tracker?n==!0&&t[i].push(r.$tracker.toRaw(!0)):t[i].push(r)})):u!=null&&u.$tracker?(n==!0||u.$tracker.entityType.isComplexType)&&(t[i]=u.$tracker.toRaw(n)):t[i]=u}),t},r.toEntity=function(n,t,i){return new c.EntityTracker(n,t,i).entity},r}(),EntityManager:function(){function v(n,t,f,e,o,c){var v,l,y,p,b,w;return(f=f||{},v=f.async,v==null&&(v=c.workAsync),v==null&&(v=a.workAsync),f.async=v,l=v?c.promiseProvider:null,y=null,l&&(y=l.deferred()),p=f.makeObservable,p==null&&(p=!0),b=f.state==h.entityStates.Detached,w=null,c.dataService.createEntityAsync(n,t,f,function(n,t,a,v){var g,k,d;try{g=!1;s.isArray(n)||(n=[n],g=!0);p&&!b&&r(n,t,h.mergeStrategy.ThrowError,h.entityStates.Added,c);g&&(n=n[0]);k={};k.userData=a("X-UserData");d=k.userData!=null;f.includeHeaderGetter===!0&&(k.headerGetter=a,d=!0);f.includeXhr===!0&&(k.xhr=v,d=!0);d&&(n.$extra=k);u(e,l,y,n);l||(w=n)}catch(nt){i(o,l,y,n,c)}},function(t){t.typeName=n;i(o,l,y,t,c)}),l)?l.getPromise(y):w}function p(n,t,i,u){var f=h.mergeStrategy.ThrowError,e=i;t?(t.merge!=null&&(f=t.merge),t.state!=null&&(e=t.state)):t={};s.isArray(n)||(n=[n]);r(n,null,f,e,u,t.autoFixScalar,t.autoFixPlural)}function ht(t,i){function b(n,t){return function(i){f.extend(this,i);t.createEntity(n,this)}}function g(n){return function(t,i){f.extend(this,t);i==!0?n.createRawEntity(this):n.createEntity(this)}}var y,p,v;if(i._readyCallbacks=[],i._readyPromises=[],t.length<1||t.length>3)throw f.createError(o.managerInvalidArgs,{entityManager:i});var l=t[0],u=t[1],r=t[2];if(s.isInstanceOf(l,e.DataServiceBase))i.dataService=l,r=t[1];else if(s.isTypeOf(l,"string"))t.length===2&&s.isObject(u)&&!s.isInstanceOf(u,w.MetadataManager)&&(r=u,u=undefined),y=a.getDefaultServiceType(),p=y===h.serviceTypes.WebApi?k.WebApiService:k.MvcService,i.dataService=new p(l,u,r);else throw f.createError(o.managerInvalidArgs,{entityManager:this,arguments:t});r=r||{};i.promiseProvider=r.promiseProvider||a.getPromiseProvider();i.autoFixScalar=r.autoFixScalar;i.autoFixPlural=r.autoFixPlural;i.validateOnMerge=r.validateOnMerge;i.validateOnSave=r.validateOnSave;i.liveValidate=r.liveValidate;i.handleUnmappedProperties=r.handleUnmappedProperties;i.forceUpdate=r.forceUpdate;i.workAsync=r.workAsync;i.minimizePackage=r.minimizePackage;i.pendingChangeCount=0;i.entities=new c.EntityContainer;i.validationErrors=[];i.entityStateChanged=new c.Event("entityStateChanged",i);i.validationErrorsChanged=new c.Event("validationErrorsChanged",i);i.hasChangesChanged=new c.Event("hasChangesChanged",i);i.queryExecuting=new c.Event("queryExecuting",i);i.queryExecuted=new c.Event("queryExecuted",i);i.saving=new c.Event("saving",i);i.saved=new c.Event("saved",i);v=r.registerMetadataTypes;v==null&&(v=a.registerMetadataTypes);i.dataService.ready(function(){var h=i.dataService.metadataManager,u,f,r,t,e,c,o,s;if(v&&h){if(u=h.types,u)for(i.entitySets={},f=0;f<u.length;f++)r=u[f],t=r.shortName,i.hasOwnProperty(t)||(i[t]=b(t,i)),e=r.setName,e&&!i.hasOwnProperty(e)&&(c=i.createSet(r),i[e]=c,i.entitySets[t]=c),n.hasOwnProperty(t)||(n[t]=g(r));if(o=h.enums,o)for(s in o)n.hasOwnProperty(s)||(n[s]=o[s])}d(i)})}function d(n){var i,e,t,r,u,f;if(n.isReady())for(i=n._readyCallbacks.slice(0),e=n._readyPromises.slice(0),n._readyCallbacks=[],n._readyPromises=[],t=0;t<i.length;t++)r=i[t],r&&r.call(n),u=e[t],u&&(f=n.promiseProvider,f&&f.resolve(u))}function r(n,t,i,r,u,e,c){var v;if(r){if(r===h.entityStates.Detached)return}else r=h.entityStates.Added;i||(i=h.mergeStrategy.Preserve);e==null&&(e=u.autoFixScalar);e==null&&(e=a.autoFixScalar);c==null&&(c=u.autoFixPlural);c==null&&(c=a.autoFixPlural);v=u.validateOnMerge;v==null&&(v=a.validateOnMerge);t=t||u.flatEntities(s.isArray(n)?n:[n]);var p=[],w=[],y=[],b=u.entities.count(),l=u;f.forEach(t,function(n){var r;if(n!=null){if(r=n.$tracker,!r&&n.$type)r=l.toEntity(n,n.$type).$tracker;else if(r.entityType.isComplexType||u.isInManager(n))return;var e=r.entityType,s=r.key,t=null;if(b>0&&s&&(t=l.entities.getEntityByKey(s,e.floorType)),t){if(e.name!==t.$tracker.entityType.name)throw f.createError(o.sameKeyOnDifferentTypesError,[t.$tracker.entityType.shortName,e.shortName],{existingEntity:t,entity:n,manager:l});if(i===h.mergeStrategy.ThrowError)throw f.createError(o.sameKeyExists,{existingEntity:t,entity:n,manager:l});else i===h.mergeStrategy.Preserve?y.push({o:n,n:t}):(y.push({o:n,n:t}),w.push({o:t,n:n}))}else l.entities.push(n),n.$tracker.setManagerInfo(l),p.push(n)}});f.forEach(p,function(n){tt(n,e,c,l);yt(n,l);nt(n,r);v===!0&&n.$tracker.validate()});f.forEach(w,function(n){ct(n.o,n.n);nt(n.o,r)});f.forEach(y,function(t){var i=f.indexOf(n,t.o);i>=0&&(n[i]=t.n);lt(t.o,t.n,e,c,l)})}function g(n,t){if(!t.isInManager(n))throw f.createError(o.entityNotBeingTracked,{entity:n,manager:t});}function nt(n,t){if(t===h.entityStates.Unchanged)n.$tracker.toUnchanged();else if(t===h.entityStates.Modified)n.$tracker.toModified();else if(t===h.entityStates.Added)n.$tracker.toAdded();else if(t===h.entityStates.Deleted)n.$tracker.toDeleted();else throw f.createError(o.mergeStateError,[t],{entity:n,state:t});}function ct(n,t){var i=t.$tracker;f.forEach(i.entityType.dataProperties,function(t){n.$tracker.setValue(t.name,i.getValue(t.name))})}function tt(n,t,i,r){if(t==!0||i==!0){var u=n.$tracker,e=u.entityType;f.forEach(e.navigationProperties,function(f){var e=u.getValue(f.name),o,h,s,c;if(f.isComplex){for(o=e.$tracker.owners,h=!1,s=0;s<o.length;s++)if(c=o[s],c.entity==n&&c.property==f){h=!0;break}h||o.push({entity:n,property:f})}else f.isScalar?it(u,e,f,f.name,t,r):(rt(e,r),i&&ft(n,f,e,r))});f.forEach(e.dataProperties,function(t){var f,i,e,r,o;if(t.isComplex){for(f=u.getValue(t.name),f.$tracker.entityType.isComplexType=!0,i=f.$tracker.owners,e=!1,r=0;r<i.length;r++)if(o=i[r],o.entity==n&&o.property==t){e=!0;break}e||i.push({entity:n,property:t})}});f.forEach(u.entityType.properties,function(n){var t=u.getValue(n);s.isArray(t)?rt(t,r):it(u,t,null,n,!1,r)})}}function it(n,t,i,r,u,e){t?(t.$tracker&&t.$tracker.manager!=e&&(t=e.getEntityByKey(t.$tracker.key,t.$tracker.entityType),n.setValue(r,t)),i&&f.setForeignKeys(n.entity,i,t)):i&&u&&ut(n,i,e)}function rt(n,t){for(var r,u,i=n.length-1;i>=0;i--)r=n[i],r&&r.$tracker&&r.$tracker.manager!=t&&(u=t.getEntityByKey(r.$tracker.key,r.$tracker.entityType),u?n.splice(i,1,u):n.splice(i,1))}function lt(n,t,i,r,u){var o=t.$tracker,c,e,s,l;o.entityState!=h.entityStates.Deleted&&(c=n.$tracker,l=c.entityType,f.forEach(l.navigationProperties,function(h){var y,p,l,a,v;h.isComplex||(e=c.getValue(h.name),s=o.getValue(h.name),h.isScalar?s||(i==!0?ut(o,h,u):i===!0&&h.inverse&&h.inverse.isScalar||r===!0&&h.inverse&&!h.inverse.isScalar||(y=c.foreignKey(h),p=o.foreignKey(h),y==p&&e!=null&&u.isInManager(e)&&(l=h.inverse,l?l.isScalar?e.$tracker.setValue(l.name,t):(a=e.$tracker.getValue(l.name),v=f.indexOf(a,n),v>=0&&a.splice(v,1,t)):o.setValue(h.name,e)))):r?ft(t,h,s,u):i===!0&&h.inverse||f.forEach(e,function(n){u.isInManager(n)&&!f.findInArray(s,n)&&s.push(n)}))}))}function ut(n,t,i){var u=n.foreignKey(t),r=i.entities.getEntityByKey(u,t.entityType);r&&r.$tracker.entityState==h.entityStates.Deleted&&(r=null);n.setValue(t.name,r)}function ft(n,t,i,r){var u=r.entities.getRelations(n,t);u&&f.forEach(u,function(n){n.$tracker.entityState==h.entityStates.Deleted||f.findInArray(i,n)||i.push(n)})}function et(n,t){var i=n.$tracker,r=i.entityType,u=t?new c.ValueNotifyWrapper(null,!0):null;r.hasMetadata&&f.forEach(r.navigationProperties,function(n){n.isScalar?i.setValue(n.name,u):i.getValue(n.name).splice(0)})}function at(n,t,i){f.forEach(n,function(n){n.$tracker.entityState==h.entityStates.Deleted?(n.$tracker.toDetached(),ot(n,i),t.remove(n)):n.$tracker.toUnchanged()})}function vt(n,t,i){if(t.removed.length>0)for(var r=t.removed.length-1;r>=0;r--)i.validationErrors.splice(f.indexOf(i.validationErrors,t.removed[r]),1);t.added.length>0&&i.validationErrors.push.apply(i.validationErrors,t.added);(t.removed.length>0||t.added.length>0)&&i.validationErrorsChanged.notify({errors:i.validationErrors,added:t.added,removed:t.removed})}function yt(n,t){n.$tracker.entityStateChanged.subscribe(function(n){var i=t.pendingChangeCount;n.newChanged===!0?t.pendingChangeCount++:n.newUnchanged===!0&&t.pendingChangeCount--;t.entityStateChanged.notify(n);i==0&&t.pendingChangeCount>0?t.hasChangesChanged.notify({hasChanges:!0}):i>0&&t.pendingChangeCount==0&&t.hasChangesChanged.notify({hasChanges:!1})});n.$tracker.validationErrorsChanged.subscribe(function(i){vt(n,i,t)})}function ot(n,t){n.$tracker.entityStateChanged.unsubscribe(t.entityStateChanged.notify);n.$tracker.validationErrorsChanged.unsubscribe(t.validationErrorsChanged.notify);var i=f.filterArray(t.validationErrors,function(t){return t.entity==n});f.removeFromArray(t.validationErrors,n,"entity");t.validationErrorsChanged.notify({errors:t.validationErrors,removed:i,added:[]})}function pt(n,t,i){var r={manager:n,query:t,options:i};return n.queryExecuting.notify(r),b.queryExecuting.notify(r),r}function st(n,t,i,r){var u={manager:n,query:t,options:i,result:r};return n.queryExecuted.notify(u),b.queryExecuted.notify(u),u.result}function wt(n,t,i,r){var u={manager:n,changes:t,savePackage:i,options:r};return n.saving.notify(u),b.saving.notify(u),u.options}function bt(n,t,i,r){var u={manager:n,changes:t,savePackage:i,options:r};n.saved.notify(u);b.saved.notify(u)}function u(n,t,i,r){n&&n(r);t&&t.resolve(i,r)}function i(n,t,i,r,u){if(r.manager=u,n&&n(r),t&&t.reject(i,r),!n&&!t)throw r;}var y=function(){ht(arguments,this)},t=y.prototype;return t.toString=function(){return this.dataService.toString()+", "+o.pendingChanges+": "+this.pendingChangeCount+", "+o.validationErrors+": "+this.validationErrors.length},t.isReady=function(){return this.dataService.isReady()},t.ready=function(n){var t,i,r,u;return this._readyCallbacks.push(n),t=this.promiseProvider,i=null,t&&(r=t.deferred(),this._readyPromises.push(r),i=t.getPromise(r)),u=this,setTimeout(function(){d(u)},10),i},t.getEntityType=function(n){return this.dataService.getEntityType(n)},t.createQuery=function(n,t){return this.dataService.createQuery(n,t,this)},t.createEntityQuery=function(n,t){return this.dataService.createEntityQuery(n,t,this)},t.registerCtor=function(n,t,i){this.dataService.registerCtor(n,t,i)},t.createEntity=function(n,t){var i=this.dataService.createEntity(n,t),u=[i];return r(u,null,h.mergeStrategy.ThrowError,h.entityStates.Added,this),i},t.createDetachedEntity=function(n,t){return this.dataService.createEntity(n,t)},t.createRawEntity=function(n,t){return this.dataService.createRawEntity(n,t)},t.createEntityAsync=function(n,t,i,r,u){return v(n,t,i,r,u,this)},t.createDetachedEntityAsync=function(n,t,i,r,u){return i?i.state=h.entityStates.Detached:i={state:h.entityStates.Detached},v(n,t,i,r,u,this)},t.createRawEntityAsync=function(n,t,i,r,u){return i?i.makeObservable=!1:i={makeObservable:!1},v(n,t,i,r,u,this)},t.executeQuery=function(n,t,e,c){var d,p,l,w,g,nt,k;n.options&&(t=f.combine(n.options,t));d=pt(this,n,t);n=d.query;t=d.options;t=t||{};p=t.async;p==null&&(p=this.workAsync);p==null&&(p=a.workAsync);l=p?this.promiseProvider:null;w=null;l&&(w=l.deferred());var y=h.mergeStrategy.Preserve,v=h.executionStrategy.Server,b=null;if(s.isEnum(t,h.mergeStrategy)?(y=t,t={makeObservable:y!=h.mergeStrategy.NoTrackingRaw}):s.isEnum(t,h.executionStrategy)?v=t:(t.merge&&(y=t.merge),t.execution&&(v=t.execution),t.async=p,t.makeObservable=y!=h.mergeStrategy.NoTrackingRaw,t.handleUnmappedProperties==null&&(t.handleUnmappedProperties=this.handleUnmappedProperties)),g=y==h.mergeStrategy.NoTracking||y==h.mergeStrategy.NoTrackingRaw,g&&v==h.executionStrategy.Both)throw f.createError(o.executionBothNotAllowedForNoTracking,{executionStrategy:v,mergeStrategy:y});return((v==h.executionStrategy.Local||v==h.executionStrategy.LocalIfEmptyServer)&&(b=this.executeQueryLocally(n,t.varContext)),nt=null,v==h.executionStrategy.Local||v==h.executionStrategy.LocalIfEmptyServer&&b&&(b.length==null||b.length>0)?(b=st(this,n,t,b),u(e,l,w,b)):(k=this,this.dataService.executeQuery(n,t,function(f,o,a,p){var it,b,d,tt;try{it=!1;b=a("X-InlineCount");b!=null&&(b=Number(b));f&&(g||(s.isArray(f)||(f=[f],it=!0),r(f,o,y,h.entityStates.Unchanged,k,t.autoFixScalar,t.autoFixPlural),it&&(f=f[0])));v==h.executionStrategy.Both&&(f=k.executeQueryLocally(n,t.varContext,!0),f.$inlineCountDiff!=null&&(b!=null&&(b+=f.$inlineCountDiff),delete f.$inlineCountDiff));f&&s.isObject(f)&&(n.inlineCountEnabled&&b!=null&&(f.$inlineCount=b),d={},d.userData=a("X-UserData"),tt=d.userData!=null,t.includeHeaderGetter===!0&&(d.headerGetter=a,tt=!0),t.includeXhr===!0&&(d.xhr=p,tt=!0),tt&&(f.$extra=d));f=st(k,n,t,f);u(e,l,w,f);l||(nt=f)}catch(rt){i(c,l,w,rt,k)}},function(t){t.query=n;i(c,l,w,t,k)})),l)?l.getPromise(w):nt},t.executeQueryLocally=function(n,t,i){var a=n.entityType,v,e,u,y,p;if(a)if(e=this.entities.findEntitySet(a),e)v=e.getEntities();else return[];else throw f.createError(o.typeRequiredForLocalQueries);i&&n.getExpression(l.expressions.GroupByExp,!1)&&(b.warning.notify({message:o.countDiffCantBeCalculatedForGrouped,query:n,options:t}),i=!1);var r=[],s=[],c=[];return f.forEach(v,function(n){n.$tracker.entityState==h.entityStates.Added?(i&&s.push(n),r.push(n)):n.$tracker.entityState==h.entityStates.Deleted?i&&c.push(n):r.push(n)}),u=n.toFunction(),r=u(r,t),i&&r.$inlineCount!=null&&(y=s.length>0?u(s,t).$inlineCount:0,p=c.length>0?u(c,t).$inlineCount:0,r.$inlineCountDiff=y-p),r},t.getEntityByKey=function(n,t){var i=s.isInstanceOf(t,w.EntityType)?t:this.getEntityType(t,!0);return this.entities.getEntityByKey(n,i)},t.deleteEntity=function(n){var t,i,r;for(g(n,this),t=this,i=[],f.forEach(n.$tracker.entityType.navigationProperties,function(r){var u,e;if(r.cascadeDelete){if(r.inverse&&r.inverse.cascadeDelete)throw f.createError(o.twoEndCascadeDeleteNotAllowed,{entity:n,property:r});u=n.$tracker.getValue(r.name);u&&(r.isScalar?r.foreignKeys!=null&&r.foreignKeys.length>0?i.push(u):t.deleteEntity(u):(e=f.filterArray(u,function(){return!0}),f.forEach(e,function(n){t.deleteEntity(n)})))}}),n.$tracker.entityState===h.entityStates.Added?this.detachEntity(n):(et(n,!0),n.$tracker.toDeleted()),r=0;r<i.length;r++)t.deleteEntity(i[r])},t.addEntity=function(n,t){p(n,t,h.entityStates.Added,this)},t.attachEntity=function(n,t){p(n,t,h.entityStates.Unchanged,this)},t.detachEntity=function(n,t){var i=this,r;s.isArray(n)||(n=[n]);r=t===!0?this.flatEntities(n):n;f.forEach(r,function(n){if(n.$tracker.entityType.isComplexType&&n.$tracker.owners.length>0)throw f.createError(o.cannotDetachComplexTypeWithOwners);g(n,i);et(n,!0);ot(n,i);n.$tracker.toDetached();n.$tracker.manager=null;i.entities.remove(n)})},t.rejectChanges=function(n,t){var r=this,i;s.isArray(n)||(n=[n]);i=t===!0?this.flatEntities(n):n;f.forEach(i,function(n){var t=n.$tracker;t.entityState==h.entityStates.Added?r.detachEntity(n):t.entityState!=h.entityStates.Detached&&(t.rejectChanges(),t.toUnchanged())})},t.undoChanges=function(n,t){s.isArray(n)||(n=[n]);var i=t===!0?this.flatEntities(n):n;f.forEach(i,function(n){n.$tracker.undoChanges()})},t.acceptChanges=function(n,t){s.isArray(n)||(n=[n]);var i=t===!0?this.flatEntities(n):n;f.forEach(i,function(n){n.$tracker.acceptChanges()})},t.createSavePackage=function(n,t){var u,i,s,r,e,c;if(n=n||this.getChanges(),t=t||{},u=[],i=t.validateOnSave,i==null&&(i=this.validateOnSave),i==null&&(i=a.validateOnSave),i===!0&&f.forEach(n,function(n){if(n.$tracker.entityState!=h.entityStates.Deleted){var t=n.$tracker.validate();t&&t.length>0&&u.push({entity:n,validationErrors:t})}}),u.length>0)throw f.createError(o.validationFailed,{entities:n,entitiesInError:u});return s=t.userData||null,r=t.forceUpdate,r==null&&(r=this.forceUpdate),r==null&&(r=a.forceUpdate),e={userData:s,forceUpdate:r},c=this.exportEntities(n,t),e.entities=c,e},t.exportEntities=function(n,t){var r,i;return t=t||{},r=[],n=n||this.entities.getEntities(),i=t.minimizePackage,i==null&&(i=this.minimizePackage),i==null&&(i=a.minimizePackage),f.forEach(n,function(n,t){var u=n.$tracker,a=u.entityType,o=u.entityState,s=u.forceUpdate,c={},e,l;if(i===!0)if(o==h.entityStates.Modified)if(u.originalValues.length>0)e={},f.forEach(u.originalValues,function(t){var o,r=t.p.split("."),s,f,i;if(r.length>1){for(s=0;s<r.length-1;s++)f=r[s],n=n.$tracker.getValue(f),e[f]==null&&(e[f]={}),e=e[f];o=r[r.length-1]}else o=t.p;i=u.getValue(o);i&&i.$tracker&&(i=i.$tracker.toRaw());e[o]=i}),f.forEach(u.entityType.dataProperties,function(n){(n.isKeyPart===!0||n.useForConcurrency===!0)&&(e[n.name]=u.getValue(n.name))});else if(s===!0)e=u.toRaw(n);else return;else if(o==h.entityStates.Deleted)e={},f.forEach(u.entityType.dataProperties,function(n){(n.isKeyPart===!0||n.useForConcurrency===!0)&&(e[n.name]=u.getValue(n.name))});else if(o==h.entityStates.Added)e=u.toRaw(n);else return;else e=u.toRaw(n);o==h.entityStates.Modified&&f.forEach(u.originalValues,function(n){var t=n.v;t&&t.$tracker&&(t=t.$tracker.toRaw());c[n.p]=t});l={t:a.name,s:o.toString(),o:c,i:t,f:s};e.$t=l;r.push(e)}),r},t.importEntities=function(n,t){var i=this;s.isArray(n)||(n=[n]);f.forEach(n,function(n){var u=n.$t,s,e,c,l;switch(u.s){case"Unchanged":s=h.entityStates.Unchanged;break;case"Added":s=h.entityStates.Added;break;case"Deleted":s=h.entityStates.Deleted;break;case"Modified":s=h.entityStates.Modified;break;default:throw f.createError(o.unsoppertedState,[u.s],{entity:n});}if(e=i.toEntity(n,u.t),r(e,[e],t||h.mergeStrategy.Preserve,s,i,!0,!0),u.o)for(c in u.o)l=u.o[c],e.$tracker.originalValues.push({p:c,v:l});e.$tracker.forceUpdate=u.forceUpdate;delete e.$t})},t.hasChanges=function(){return this.pendingChangeCount>0},t.getChanges=function(){return this.entities.getChanges()},t.saveChanges=function(n,t,i){return this.savePackage(null,n,t,i)},t.savePackage=function(n,t,e,o){var p,l,v,c,w,y;if(t=t||{},p=t.async,p==null&&(p=this.workAsync),p==null&&(p=a.workAsync),t.async=p,l=p?this.promiseProvider:null,v=null,l&&(v=l.deferred()),!n)if(t.entities?(c=t.entities,s.isArray(c)||(c=[c])):c=this.getChanges(),c.length)try{n=this.createSavePackage(c,t)}catch(b){i(o,l,v,b,this)}else u(e,l,v,{AffectedCount:0,GeneratedValues:[]});if(w=null,n){t=wt(this,c,n,t);try{y=this;this.dataService.saveChanges(n,t,function(s,a,p){try{s.GeneratedEntities!=null&&s.GeneratedEntities.length>0&&r(s.GeneratedEntities,null,h.mergeStrategy.Preserve,h.entityStates.Unchanged,y,t.autoFixScalar,t.autoFixPlural);s.GeneratedValues&&f.forEach(s.GeneratedValues,function(n){var u,e,i,f,s,o;if(!(n.Index<0)){if(u=c[n.Index],i=n.Property.split("."),i.length>1){for(f=0;f<i.length-1;f++)u=u.$tracker.getValue(i[f]);e=i[i.length-1]}else e=n.Property;s=u.$tracker;n.Value!=null&&n.Value.$type&&(o=[n.Value],r(o,null,h.mergeStrategy.Preserve,h.entityStates.Unchanged,y,t.autoFixScalar,t.autoFixPlural),n.Value=o[0]);s.setValue(e,n.Value)}});at(c,y.entities,y);s.userData=a("X-UserData");t.includeHeaderGetter===!0&&(s.headerGetter=a);t.includeXhr===!0&&(s.xhr=p);bt(y,c,n,t);u(e,l,v,s);l||(w=s)}catch(b){b.changes=c;b.savePackage=n;i(o,l,v,b,y)}},function(t){t.changes=c;t.savePackage=n;i(o,l,v,t,y)})}catch(b){i(o,l,v,b,this)}}return l?l.getPromise(v):w},t.toEntity=function(n,t){return n.$type&&!t&&(t=n.$type),this.dataService.toEntity(n,t)},t.fixNavigations=function(n){if(!this.isInManager(n))throw f.createError(o.entityNotBeingTracked,null,{entity:n});tt(n,!0,!0,this)},t.isInManager=function(n){return n.$tracker.manager==this},t.flatEntities=function(n){var i=this,t=arguments[1]||[];return s.isArray(n)||(n=[n]),f.forEach(n,function(n){var r,o,e,u;if(n!=null){if(s.isArray(n)){i.flatEntities(n,t);return}if(!f.findInArray(t,n))if(r=n.$tracker,o=n.$type,r)t.push(n),r.entityType.hasMetadata?(f.forEach(r.entityType.dataProperties,function(n){if(n.isComplex){var u=r.getValue(n.name);u&&(s.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t))}}),f.forEach(r.entityType.navigationProperties,function(n){var u=r.getValue(n.name);u&&(s.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t))})):f.forEach(r.entityType.properties,function(n){var u=r.getValue(n);u&&(s.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t))});else if(o){t.push(n);for(e in n)e!=="$type"&&(u=n[e],u&&(s.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t)))}}}),t},t.entry=function(n){return n.$tracker},t.createSet=function(n){return s.isInstanceOf(n,w.EntityType)||(s.isFunction(n)&&(n=f.getFuncName(n)),n=this.getEntityType(n,!0)),new c.EntitySet(n,this)},t.set=function(n){return s.isFunction(n)&&(n=f.getFuncName(n)),this.entitySets&&this.entitySets[n]},y}(),EntityBase:function(){return function(n,t,i){i&&f.extend(this,i);n.createEntity(this);t!=null&&t.addEntity(this)}}()}}(),k=function(){var n={};return n.MvcService=function(){function i(n){var t=0,i,r,u;if(n.length==0)return t;for(i=0,u=n.length;i<u;i++)r=n.charCodeAt(i),t=(t<<5)-t+r|0;return t}var t=function(n,t,i){e.DataServiceBase.call(this,n,t,i)},n;return f.inherit(t,e.DataServiceBase),n=t.prototype,n.fetchMetadata=function(n,t,i){var u=null,o=this,r,f,e;return n=n||{},r=n.async,r==null&&(r=!this.ajaxProvider.syncSupported),f=n.timeout||this.ajaxTimeout||a.ajaxTimeout,e=n.extra,this.ajaxProvider.doAjax(this.uri+"Metadata","GET",this.dataType,this.contentType,null,r,f,e,null,function(n,i,r){u=o.serializationService.deserialize(n);t(u,i,r)},i),u},n.createEntityAsync=function(n,t,i,r,u){var e,o,h;s.isFunction(n)&&(n=f.getFuncName(n));e=this;i=i||{};o=i.makeObservable;o==null&&(o=!0);h=i.async;h==null&&(h=a.workAsync);var l=i.timeout||this.ajaxTimeout||a.ajaxTimeout,v=i.extra,c=e.uri+"CreateType?typeName="+n+"&initialValues=";t!=null&&(c+=e.serializationService.serialize(t));this.ajaxProvider.doAjax(c,"GET",this.dataType,this.contentType,null,h,l,v,null,function(n,t,i){n=e.serializationService.deserialize(n);var u=e.fixResults(n,o);r(n,u,t,i)},function(n){u(n)})},n.executeQuery=function(n,t,i,r){var u=this.toBeetleQueryParams(n,t&&t.varContext);return this.executeQueryParams(n.resource,u,t,i,r)},n.executeQueryParams=function(n,t,r,u,e){var h,y,p,k,w,b;r=r||{};var d=r.makeObservable,g=r.handleUnmappedProperties,nt=r.usePost||!1,tt=r.dataType||this.dataType,it=r.contentType||this.contentType,c=r.async;c==null&&(c=a.workAsync);var rt=r.timeout||this.ajaxTimeout||a.ajaxTimeout,ut=r.extra,l,v=null,o=r.uri||this.uri||"";o&&o[o.length-1]!="/"&&(o+="/");o=o+n;nt===!0?(y={},f.forEach(t,function(n){y[n.name]=n.value}),v=this.serializationService.serialize(y),h=v,l="POST"):(p=[],f.forEach(t,function(n){p.push(n.name+"="+encodeURIComponent(n.value))}),h=p.join("&"),o+="?"+h,l="GET");k=i(h);w={"x-beetle-request":k,"x-beetle-request-len":h.length};f.extend(w,r.headers);b=this;this.ajaxProvider.doAjax(o,l,tt,it,v,c,rt,ut,w,function(n,t,i){var r,f;try{n=b.serializationService.deserialize(n)}catch(e){}n!=null&&n.$d!=null&&(n=n.$d);r=null;n&&(f=!1,s.isArray(n)||(n=[n],f=!0),r=b.fixResults(n,d,g),f&&(n=n[0]));u(n,r,t,i)},function(n){e(n)})},n.saveChanges=function(n,t,r,u){var h=this,o,c;t=t||{};o=t.async;o==null&&(o=a.workAsync);var v=t.timeout||this.ajaxTimeout||a.ajaxTimeout,y=t.extra,e=t.uri||this.uri||"";e&&e[e.length-1]!="/"&&(e+="/");c=t.saveAction||"SaveChanges";e=e+c;var s=this.serializationService.serialize(n),p=i(s),l={"x-beetle-request":p,"x-beetle-request-len":s.length};f.extend(l,t.headers);this.ajaxProvider.doAjax(e,"POST",this.dataType,this.contentType,s,o,v,y,l,function(n,t,i){try{n=h.serializationService.deserialize(n)}catch(u){}n&&(h.fixResults(n,!1,null),delete n.$id,delete n.$type);r(n,t,i)},function(n){u(n)})},n.fixResults=function(n,t,i){function e(n){var l=n.$id,o,f,h;delete n.$id;r[l-1]=n;for(o in n)o!=="$type"&&(f=n[o],f!=null&&(f.$ref?n[o]=r[f.$ref-1]:f.$id?e(f):s.isArray(f)?u.fixResults(f,t,i,r):i!==!1&&(n[o]=c.dataTypes.handle(f))));t!==!1&&(h=n.$type,u.toEntity(n,h))}var u=this,r=arguments[3]||[];return s.isArray(n)||(n=[n]),i==null&&(i=a.handleUnmappedProperties),f.forEach(n,function(f,o){f!=null&&(f.$ref?n[o]=r[f.$ref-1]:f.$id?e(f):s.isArray(f)?u.fixResults(f,t,i,r):i!==!1&&(n[o]=c.dataTypes.handle(f)))}),r},t}(),n.WebApiService=function(){var t=function(n,t,i){k.MvcService.call(this,n,t,i);this.useBeetleQueryStrings=!1},i;return f.inherit(t,n.MvcService),i=t.prototype,i.executeQuery=function(n,t,i,r){var u,f,e;return t=t||{},f=t.varContext,e=t.useBeetleQueryStrings!=null?t.useBeetleQueryStrings:this.useBeetleQueryStrings,e===!0?u=this.toBeetleQueryParams(n,f):n.isMultiTyped===!0?(u=this.toBeetleQueryParams(n,f),b.warning.notify({message:o.beetleQueryChosenMultiTyped,query:n,options:t})):t.usePost?(u=this.toBeetleQueryParams(n,f),b.warning.notify({message:o.beetleQueryChosenPost,query:n,options:t})):u=this.toODataQueryParams(n,f),this.executeQueryParams(n.resource,u,t,i,r)},t}(),n}(),h=function(){return{observableProviders:new v.Enum({Knockout:{code:"ko",instance:y.koObservableProviderInstance},Property:{code:"prop",instance:y.propertyObservableProviderInstance}}),promiseProviders:new v.Enum({Q:{code:"Q",instance:y.qPromiseProviderInstance},jQuery:{code:"jQuery",instance:y.jQueryPromiseProviderInstance},Angular:{code:"Angular",instance:y.angularPromiseProviderInstance}}),ajaxProviders:new v.Enum({jQuery:{code:"jQuery",instance:y.jQueryAjaxProviderInstance},Angular:{code:"Angular",instance:y.angularAjaxProviderInstance}}),serializationServices:new v.Enum({JSON:{code:"JSON",instance:y.jsonSerializationServiceInstance}}),entityStates:new v.Enum("Detached","Unchanged","Added","Deleted","Modified"),langOperators:function(){var n=function(n,t,i,r,u){this.name=n;this.code=t;this.asFunc=i;this.oData=r;this.js=u||t},t=[];return t.push(new n("Not","!",function(n){return!n()},"not ")),t.push(new n("Negative","-",function(n){return-1*n()})),t.push(new n("And","&&",function(n,t){return n()&&t()},"and")),t.push(new n("Or","||",function(n,t){return n()||t()},"or")),t.push(new n("Equals","==",function(n,t){return f.equals(n(),t(),!1,this)},"eq")),t.push(new n("StrictEquals","==",function(n,t){return f.equals(n(),t(),!0,this)},"eq","===")),t.push(new n("NotEqual","!=",function(n,t){return!f.equals(n(),t(),!1,this)},"ne")),t.push(new n("StrictNotEqual","!=",function(n,t){return!f.equals(n(),t(),!0,this)},"ne","!==")),t.push(new n("Greater",">",function(n,t){return n()>t()},"gt")),t.push(new n("Lesser","<",function(n,t){return n()<t()},"lt")),t.push(new n("GreaterEqual",">=",function(n,t){var i=n(),r=t();return i==r||i>r},"ge")),t.push(new n("LesserEqual","<=",function(n,t){var i=n(),r=t();return i==r||i<r},"le")),t.push(new n("Sum","+",function(n,t){return n()+t()},"add")),t.push(new n("Subtract","-",function(n,t){return n()-t()},"sub")),t.push(new n("Multiply","*",function(n,t){return n()*t()},"mul")),t.push(new n("Divide","/",function(n,t){return n()/t()},"div")),t.push(new n("Modulo","%",function(n,t){return n()%t()},"mod")),t.push(new n("BitAnd","&",function(n,t){return n()&t()})),t.push(new n("BitOr","|",function(n,t){return n()|t()})),t.push(new n("BitShiftLeft","<<",function(n,t){return n()<<t()})),t.push(new n("BitShiftRight",">>",function(n,t){return n()>>t()})),n.find=function(n){var i=f.filterArray(t,function(t){return t.code==n||t.oData==n||t.js==n});return i.length>0?i[0]:null},n}(),mergeStrategy:new v.Enum("Preserve","Overwrite","ThrowError","NoTracking","NoTrackingRaw"),executionStrategy:new v.Enum("Server","Local","Both","LocalIfEmptyServer"),generationPattern:new v.Enum("Identity","Computed"),arraySetBehaviour:new v.Enum("NotAllowed","Replace","Append"),serviceTypes:new v.Enum("WebApi","Mvc")}}(),b=function(){return{queryExecuting:new c.Event("beetleQueryExecuting",this),queryExecuted:new c.Event("beetleQueryExecuted",this),saving:new c.Event("beetleSaving",this),saved:new c.Event("beetleSaved",this),info:new c.Event("beetleInfo",this),warning:new c.Event("beetleWarning",this),error:new c.Event("beetleError",this)}}(),a=function(){function t(n,t,i){var u,r,e;if(t&&s.isInstanceOf(n,t))return n;if(i!=null){if(s.isNotEmptyString(n))for(u=i.symbols(),r=0;r<u.length;r++)if(e=u[r],f.equals(e.name,n,!1,{isCaseSensitive:!1,ignoreWhiteSpaces:!1})){n=e;break}if(s.isEnum(n,i))return n.instance}throw f.createError(o.invalidArguments,null,{args:arguments});}var l,c,a;l=r?y.koObservableProviderInstance:y.propertyObservableProviderInstance;u?c=y.qPromiseProviderInstance:i?c=y.angularPromiseProviderInstance:Promise?c=y.es6PromiseProviderInstance:jQuery&&(c=y.jQueryPromiseProviderInstance);a=i?y.angularAjaxProviderInstance:y.jQueryAjaxProviderInstance;var v=y.jsonSerializationServiceInstance,p=h.arraySetBehaviour.NotAllowed,w=h.serviceTypes.WebApi,b=y.defaultDateConverterInstance,k,n={};return n.autoFixScalar=!0,n.autoFixPlural=!1,n.validateOnMerge=!0,n.validateOnSave=!0,n.liveValidate=!0,n.handleUnmappedProperties=!0,n.isCaseSensitive=!1,n.ignoreWhiteSpaces=!1,n.forceUpdate=!1,n.cacheMetadata=!0,n.registerMetadataTypes=!1,n.workAsync=!0,n.ajaxTimeout=null,n.minimizePackage=!1,n.getObservableProvider=function(){return l},n.setObservableProvider=function(n){l=t(n,e.ObservableProviderBase,h.observableProviders)},n.getPromiseProvider=function(){return c},n.setPromiseProvider=function(n){c=t(n,e.PromiseProviderBase,h.promiseProviders)},n.getAjaxProvider=function(){return a},n.setAjaxProvider=function(n){a=t(n,e.AjaxProviderBase,h.ajaxProviders)},n.getSerializationService=function(){return v},n.setSerializationService=function(n){v=t(n,e.SerializationServiceBase,h.serializationServices)},n.getArraySetBehaviour=function(){return p},n.setArraySetBehaviour=function(n){p=t(n,null,h.arraySetBehaviour)},n.getDefaultServiceType=function(){return w},n.setDefaultServiceType=function(n){w=t(n,null,h.serviceTypes)},n.getDateConverter=function(){return b},n.setDateConverter=function(n){b=t(n,e.DateConverterBase)},n.getLocalizeFunction=function(){return k},n.setLocalizeFunction=function(n){f.assertPrm(n,"func").isFunction().check();k=n},n}(),o={argCountMismatch:'Argument count mismatch for "%0".',arrayEmpty:"The array does not contain any element.",arrayNotSingle:"The array does not contain exactly one element.",arrayNotSingleOrEmpty:"The array does not contain zero or one element.",assignError:"Cannot set %0 property with %1.",assignErrorNotEntity:"Cannot set %0 property, value is not an entity.",autoGeneratedCannotBeModified:"Auto generated properties cannot be modified.",beetleQueryChosenMultiTyped:"Beetle query string is used because query is multi-typed.",beetleQueryChosenPost:"Beetle query string is used because query method is POST.",beetleQueryNotSupported:"Beetle queries are not supported, you may use only OData query parameters (where, orderBy, select, expand, top, skip).",cannotBeEmptyString:"%0 value can not be empty string.",cannotCheckInstanceOnNull:"Cannot check instance on null value.",cannotDetachComplexTypeWithOwners:"Complex types with owners cannot be detached.",compareError:"%0 property value must be equal with %1.",complexCannotBeNull:"%0 complex property can not be null.",couldNotLoadMetadata:"Could not load metadata.",couldNotLocateNavFixer:"Could not locate any observable provider.",couldNotLocatePromiseProvider:"Could not locate any promise provider.",couldNotParseToken:"Could not parse %0.",countDiffCantBeCalculatedForGrouped:'In-line count difference can not be calculated when query contains a "groupBy" expression',dataPropertyAlreadyExists:"Data property already exists: %0.",entityAlreadyBeingTracked:"Entity is already being tracked by another manager.",entityNotBeingTracked:"Entity is not being tracked by a manager.",executionBothNotAllowedForNoTracking:"Execution strategy cannot be Both when merge strategy is NoTracking or NoTrackingRaw.",expressionCouldNotBeFound:"Expression could not be found.",functionNeedsAlias:"%0 function needs alias to work properly. You can set alias like Linq, p => p.Name.",functionNotSupportedForOData:"OData does not support %0 function.",instanceError:"%0 is not an instance of %1.",invalidArguments:"Invalid arguments.",invalidDefaultValue:"%0 is not a valid default value for %0.",invalidEnumValue:"Invalid enum value, %0 cannot be found in %1.",invalidExpression:"%0 can only have %1 type expressions.",invalidPropertyAlias:"Invalid property alias.",invalidStatement:"Invalid statement.",invalidValue:"Invalid value for %0 property.",managerInvalidArgs:"Invalid arguments. Valid args are: {DataService, [Injections]} or {Uri, [Metadata], [Injections]}.",maxLenError:"%0 property length cannot exceed %1.",maxPrecisionError:"Value %0 exceeded maximum precision of %1.",mergeStateError:"Cannot merge entities with %0 state.",minLenError:"%0 property length must be greater than %1.",noMetadataEntityQuery:"Cannot create entity query when no metadata is available.",noMetadataRegisterCtor:"Cannot register constructor when no metadata is available.",noOpenGroup:"Could not find any open group.",notFoundInMetadata:"Could not find %0 in metadata.",notImplemented:"%0 %1 is not implemented.",notNullable:"Cannot set %0 with null, property is not nullable.",oDataNotSupportMultiTyped:"Multi-Typed queries cannot be used for OData services.",odataDoesNotSupportAlias:"OData services does not support query alias and primitive typed resources.",onlyManagerCreatedCanBeExecuted:"Only queries which are created from a manager can be directly executed.",onlyManagerCreatedCanAcceptEntityShortName:"Only queries which are created from a manager can accept entity type short name parameter.",pendingChanges:"Pending changes",pluralNeedsInverse:"To load plural relations, navigation property must have inverse.",projectionsMustHaveAlias:"All projected values must have a property name or alias.",propertyNotFound:"Could not find property: %0.",queryClosed:"Query is closed, expression cannot be added. Queries must be executed after some expressions like first, single, any, all etc..",rangeError:"%0 property value must be between %1 and %2.",requiredError:"%0 property is required.",sameKeyExists:"There is already an entity with same key in the manager.",sameKeyOnDifferentTypesError:"Two different types of entities cannot have same keys when they are from same inheritance root (%0, %1).",settingArrayNotAllowed:"Setting array property is not allowed, you may change this via beetle.settings.setArraySetBehaviour(behavior).",stringLengthError:"%0 property length must be between %1 and %2.",syncNotSupported:"%0 does not support sync ajax calls.",twoEndCascadeDeleteNotAllowed:"Two-end cascade deletes are not supported.",typeError:"%0 type is not %1.",typeMismatch:"%0 value type mismatch. expected type: %1, given type: %2, value: %3",typeRequiredForLocalQueries:'To execute queries locally, entity type must be provided (createQuery("Entities", "Entity") or createEntityQuery("Entity")).',unclosedQuote:'Unclosed quote in "%0".',unclosedToken:'Unclosed "%0".',unexpectedProperty:'Unexpected property "%0".',unexpectedToken:"Unexpected %0.",unknownDataType:"Unknown data type: %0.",unknownExpression:"Unknown expression.",unknownFunction:"Unknown function: %0.",unknownParameter:"Unknown parameter: %0.",unknownValidator:"Unknown validator type: %0.",unsoppertedState:"Unsupported entity state: %0.",validationErrors:"Validation errors",validationFailed:"Validation failed.",valueCannotBeNull:"Value cannot be null: %0.",operatorNotSupportedForOData:"Operator is not supported for OData: %0."},d={en:o};return function(){return{version:"2.1.0",registerI18N:function(n,t,i){d[n]=t;i&&(o=t)},setI18N:function(n){var t=d[n];if(!t)throw new Error("Beetle could not find translation for "+n);o=t},helper:f,Assert:s,libs:v,baseTypes:e,impls:y,metadata:w,querying:l,core:c,services:k,enums:h,events:b,settings:a,MetadataManager:w.MetadataManager,EntityManager:c.EntityManager,EntityBase:c.EntityBase,EntitySet:c.EntitySet,WebApiService:k.WebApiService,MvcService:k.MvcService,Event:c.Event,Validator:c.Validator,ValueNotifyWrapper:c.ValueNotifyWrapper,TrackableArray:c.TrackableArray,entityStates:h.entityStates,mergeStrategy:h.mergeStrategy,executionStrategy:h.executionStrategy,arraySetBehaviour:h.arraySetBehaviour,serviceTypes:h.serviceTypes}}()});