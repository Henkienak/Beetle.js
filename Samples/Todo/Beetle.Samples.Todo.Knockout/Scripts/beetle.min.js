(function(n){"use strict";var t=function(){return{assertPrm:function(n,t){return new f(n,t)},combine:function(n,i){var r,e,u;if(n==i)return n;if(r={},n!=null)for(e in n)r[e]=n[e];if(i!=null)for(u in i){var s=r[u],o=i[u],h=f.isTypeOf(s,"object")&&f.isTypeOf(o,"object")?t.combine(s,o):o;r[u]=h}return r},extend:function(n,t){if(n!=null&&t!=null)for(var i in t)n.hasOwnProperty(i)||(n[i]=t[i])},objEquals:function(n,i){var u,e,r,o;if(n==i)return!0;if(n==null||i==null)return!1;if(f.isObject(n)&&f.isObject(i)){u=0;e=0;for(r in n){if(!i.hasOwnProperty(r)||!t.objEquals(t.getValue(n,r),t.getValue(i,r)))return!1;u++}for(o in i)e++;return u==e}return!1},isCaseSensitive:function(n){var t=n&&n.isCaseSensitive;return t==null?s.isCaseSensitive:t},ignoreWhiteSpaces:function(n){var t=n&&n.ignoreWhiteSpaces;return t==null?s.ignoreWhiteSpaces:t},handleStrOptions:function(n,i){return n==null?n:(t.isCaseSensitive(i)||(n=n.toLowerCase()),t.ignoreWhiteSpaces(i)&&(n=n.trim()),n)},equals:function(n,i,r,u){return typeof n=="string"&&typeof i=="string"&&(n=t.handleStrOptions(n,u),i=t.handleStrOptions(i,u)),n!=null&&i!=null&&e.dataTypes.date.isValid(n)&&e.dataTypes.date.isValid(i)&&(n=n.valueOf(),i=i.valueOf()),r?n===i:n==i},formatString:function(n){var t=arguments,i=RegExp("%([0-"+(arguments.length-1)+"])","g"),r=RegExp("{([0-"+(arguments.length-2)+"])}","g");return n.replace(i,function(n,i){return t[Number(i)+1]||""}).replace(r,function(n,i){return t[Number(i)+1]||""})},tryFreeze:function(n,t){var r,i;if(!n||!Object.freeze)return n;if(Object.freeze(n),t===!0)for(r in n)i=n[r],f.isArray(i)?this.tryFreezeArray(i,t):f.isObject(i)&&this.tryFreeze(i,t);return n},tryFreezeArray:function(n,t){if(n&&Object.freeze)for(var i=0;i<n.length;i++)this.tryFreeze(n[i],t)},indexOf:function(n,t,i){for(var r=i||0;r<n.length;r++)if(n[r]===t)return r;return-1},forEach:function(n,t){for(var r,i=0;i<n.length;i++)r=n[i],t.call(r,r,i)},forEachProperty:function(n,t){var i,r;for(i in n)i[0]!="$"&&((r=n[i],f.isFunction(r))||t(i,r))},findInArray:function(n,t,i){for(var r=0;r<n.length;r++)if(i){if(n[r][i]===t)return n[r]}else if(n[r]===t)return t;return null},filterArray:function(n,t){for(var r,u=[],i=0;i<n.length;i++)r=n[i],t(r)===!0&&u.push(r);return u},removeFromArray:function(n,t,i){var r=[],u;for(this.forEach(n,function(n,u){i?n[i]===t&&r.push(u):n===t&&r.push(u)}),u=r.length-1;u>=0;u--)n.splice(r[u],1);return r.length},mapArray:function(n,t){for(var r,u=[],i=0;i<n.length;i++)r=n[i],u.push(t.call(r,r,i));return u},createGuid:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},inherit:function(n,t){var i=new Function;i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n;n.baseClass=t.prototype},getValue:function(n,t){function e(n,t){var i=n.$tracker;return i?i.getValue(t):u.isObservable(n,t)?u.getValue(n,t):n[t]}var r;if(n==null)return undefined;var u=s.getObservableProvider(),f=t.trim().split("."),i=n;for(r=0;r<f.length;r++)if(i=e(i,f[r]),i==null)break;return i},getResourceValue:function(n,t){var i=s.getLocalizeFunction();return i&&n&&i(n)||t},createValidationError:function(n,i,r,u,f){var e={entity:n,message:u,validator:f};return i&&(e.value=i),r&&(e.property=r),t.tryFreeze(e),e},createError:function(n,i,r){var u=null,e=null,o,s;if(f.isArray(i)?(u=i,e=r):f.isObject(i)&&(e=i),u&&u.length>0&&(u.splice(0,0,n),n=t.formatString.apply(null,u)),o=new Error(n),e)for(s in e)o[s]=e[s];return a.error.notify(o),o},setForeignKeys:function(n,t,i){for(var u,f,e,o,r=0;r<t.foreignKeys.length;r++)u=t.foreignKeys[r],f=n.$tracker,i?(e=t.entityType.keys[r],o=i.$tracker.getValue(e.name),f.setValue(u.name,o)):f.setValue(u.name,u.getDefaultValue())},jsepToODataQuery:function(n,i){var k,l,a,v,d,g,ut,f,c,p,rt,w,b,ft;if(i?i.aliases||(i.aliases=[]):i={aliases:[]},n.type=="LogicalExpression"||n.type=="BinaryExpression"){if(n.operator=="=>")throw t.createError(r.odataDoesNotSupportAlias);if(k=u.langOperators.find(n.operator).oData,!k)throw t.createError(r.operatorNotSupportedForOData,[n.operator],{expression:n});return"("+t.jsepToODataQuery(n.left,i)+" "+k+" "+t.jsepToODataQuery(n.right,i)+")"}if(n.type=="UnaryExpression")return n.operator+t.jsepToODataQuery(n.argument,i);if(n.type=="Identifier"){if(l=n.name,l[0]=="@"){if(a=undefined,v=l.slice(1),i.expVarContext&&i.expVarContext[v]!==undefined?a=i.expVarContext[v]:i.varContext&&(a=i.varContext[v]),a===undefined)throw t.createError(r.unknownParameter,[l],{expression:n,queryContext:i});return e.dataTypes.toODataValue(a)}return(d=t.findInArray(i.aliases,l,"alias"),d)?d.value:l}if(n.type=="Literal")return e.dataTypes.toODataValue(n.value);if(n.type=="MemberExpression")return i.currentAlias&&n.object.name==i.currentAlias.alias?n.property.name:(g=t.findInArray(i.aliases,n.object.name,"alias"),ut=g?g.value:t.jsepToODataQuery(n.object,i),ut+"/"+n.property.name);if(n.type=="Compound"){for(f=[],c=0;c<n.body.length;c++){var nt=n.body[c],tt=t.jsepToODataQuery(nt,i),it=tt.toLowerCase();if(it=="desc"||it=="asc"){if(f.length==0)throw t.createError(r.invalidStatement,{expression:n,statement:nt});f[f.length-1]+=" "+tt}else if(it=="as"){if(f.length==0||n.body.length<c+1)throw t.createError(r.invalidStatement,{expression:n,statement:nt});f[f.length-1]+=" as "+n.body[c+1].name;c++}else f.push(tt)}return f.join(", ")}if(n.type=="CallExpression"){var s=n.arguments,y=[],h=null;for(s.length==1&&s[0]&&s[0].type=="BinaryExpression"&&s[0].operator=="=>"&&(h={alias:s[0].left.name},h.value=h.alias,s=[s[0].right]),h&&(i.currentAlias=h,i.aliases.push(h)),p=0;p<s.length;p++)rt=s[p],rt!=null&&y.push(t.jsepToODataQuery(rt,i));if(n.callee.type=="MemberExpression"?(y.splice(0,0,t.jsepToODataQuery(n.callee.object,i)),w=n.callee.property.name):w=n.callee.name,b=o.queryFuncs.getFunc(w),b.needsAlias==!0)if(h)y.splice(0,0,h);else throw t.createError(r.functionNeedsAlias,[w],{expression:n});return ft=b.toODataFunction.apply(b,y),h&&(i.currentAlias=null,i.aliases.pop()),ft}throw t.createError(r.unknownExpression,{expression:n});},jsepToBeetleQuery:function(n,i){var rt,ut,l,a,v,p,w,ft,f,h,y,nt,tt,it,et;if(i?i.aliases||(i.aliases=[]):i={aliases:[]},n.type=="LogicalExpression"||n.type=="BinaryExpression")return n.operator=="=>"?(i.aliases.push({alias:n.left.name,value:"it"}),rt=t.jsepToBeetleQuery(n.right,i),i.aliases.pop(),rt):(ut=u.langOperators.find(n.operator).code,"("+t.jsepToBeetleQuery(n.left,i)+" "+ut+" "+t.jsepToBeetleQuery(n.right,i)+")");if(n.type=="UnaryExpression")return n.operator+t.jsepToBeetleQuery(n.argument,i);if(n.type=="Identifier"){if(l=n.name,l[0]=="@"){if(a=undefined,v=l.slice(1),i.expVarContext&&i.expVarContext[v]!==undefined?a=i.expVarContext[v]:i.varContext&&(a=i.varContext[v]),a===undefined)throw t.createError(r.unknownParameter,[l],{expression:n,queryContext:i});return e.dataTypes.toBeetleValue(a)}return(p=t.findInArray(i.aliases,l,"alias"),p)?p.value:l}if(n.type=="Literal")return e.dataTypes.toBeetleValue(n.value);if(n.type=="MemberExpression")return i.currentAlias&&n.object.name==i.currentAlias.alias?n.property.name:(w=t.findInArray(i.aliases,n.object.name,"alias"),ft=w?w.value:t.jsepToBeetleQuery(n.object,i),ft+"."+n.property.name);if(n.type=="Compound"){for(f=[],h=0;h<n.body.length;h++){var b=n.body[h],k=t.jsepToBeetleQuery(b,i),d=k.toLowerCase();if(d=="desc"||d=="asc"){if(f.length==0)throw t.createError(r.invalidStatement,{expression:n,statement:b});f[f.length-1]+=" "+k}else if(d=="as"){if(f.length==0||n.body.length<h+1)throw t.createError(r.invalidStatement,{expression:n,statement:b});f[f.length-1]+=" as "+n.body[h+1].name;h++}else f.push(k)}return f.join(", ")}if(n.type=="CallExpression"){var s=n.arguments,g=[],c=null;for(s.length==1&&s[0]&&s[0].type=="BinaryExpression"&&s[0].operator=="=>"&&(c={alias:s[0].left.name},c.value=c.alias,s=[s[0].right]),c&&(i.currentAlias=c,i.aliases.push(c)),y=0;y<s.length;y++)nt=s[y],nt!=null&&g.push(t.jsepToBeetleQuery(nt,i));return n.callee.type=="MemberExpression"?(g.splice(0,0,t.jsepToBeetleQuery(n.callee.object,i)),tt=n.callee.property.name):tt=n.callee.name,it=o.queryFuncs.getFunc(tt),et=it.toBeetleFunction.apply(it,g),c&&(i.currentAlias=null,i.aliases.pop()),et}throw t.createError(r.unknownExpression,{expression:n});},jsepToFunction:function(n,i){return function(f){var nt,it,rt,e,v,y,b,k,d,l,g,c,a,w;if(i?i.aliases||(i.aliases=[]):i={aliases:[]},i.currentAlias&&(i.currentAlias.value=f),n.type===undefined)return f;if(n.type=="LogicalExpression"||n.type=="BinaryExpression"){if(n.operator=="=>")return i.currentAlias&&i.aliases.push(i.currentAlias),i.currentAlias={alias:n.left.name},nt=t.jsepToFunction(n.right,i)(f),i.currentAlias=i.aliases.pop(),nt;var ut=u.langOperators.find(n.operator),tt=i.varContext,ft=function(){return t.jsepToFunction(n.left,i)(f)},et=function(){return t.jsepToFunction(n.right,i)(f)};return ut.asFunc.call(tt,ft,et)}if(n.type=="UnaryExpression")return it=function(){return t.jsepToFunction(n.argument,i)(f)},rt=u.langOperators.find(n.operator),rt.asFunc.call(tt,it);if(n.type=="Identifier"){if(e=n.name,e=="null")return null;if(e=="true")return!0;if(e=="false")return!1;if(e[0]=="@"){if(v=undefined,y=e.slice(1),i.expVarContext&&i.expVarContext[y]!==undefined?v=i.expVarContext[y]:i.varContext&&(v=i.varContext[y]),v===undefined)throw t.createError(r.unknownParameter,[e],{expression:n,queryContext:i});return v}return i.currentAlias&&i.currentAlias.alias==e?f:(b=t.findInArray(i.aliases,e,"alias"),b)?b.value:(k=t.getValue(f,e),k===undefined)?window[e]:k}if(n.type=="Literal")return n.value;if(n.type=="MemberExpression"){if(n.object.name){if(i.currentAlias&&n.object.name==i.currentAlias.alias)return t.getValue(f,n.property.name);if(d=t.findInArray(i.aliases,n.object.name,"alias"),d)return t.getValue(d.value,n.property.name)}return t.getValue(t.jsepToFunction(n.object,i)(f),n.property.name)}if(n.type=="CallExpression"){var s=n.arguments,h=[],p=null;if(s.length==1&&s[0]&&s[0].type=="BinaryExpression"&&s[0].operator=="=>"&&(p=s[0].left.name,s=[s[0].right]),p&&(i.currentAlias&&i.aliases.push(i.currentAlias),i.currentAlias={alias:p}),t.forEach(s,function(n){n!=null&&h.push(t.jsepToFunction(n,i))}),l=n.callee.type=="MemberExpression"?n.callee.property.name:n.callee.name,c=o.queryFuncs.getFunc(l,!1),c)n.callee.type=="MemberExpression"&&h.splice(0,0,t.jsepToFunction(n.callee.object,i)),h.splice(0,0,f),g=c.impl.apply(i,h);else{if(l[0]=="@")if(a=l.slice(1),i.expVarContext&&i.expVarContext[a])c=i.expVarContext[a];else if(i.varContext&&i.varContext[a])c=i.varContext[a];else throw t.createError(r.unknownParameter,[a],{expression:n,queryContext:i});else if(w=n.callee.type=="MemberExpression"?t.jsepToFunction(n.callee.object,i)(f):window,w==null||(c=w[l])==null)throw t.createError(r.unknownFunction,[l]);h=t.mapArray(h,function(){return this(f)});g=c.apply(w,h)}return p&&(i.currentAlias=i.aliases.pop()),g}throw t.createError(r.unknownExpression,{expression:n});}},jsepToProjector:function(n,i){var h=[],u,e,o,s;for(f.isArray(n)||(n=[n]),u=0;u<n.length;u++){e=null;o=n[u];switch(o.type){case"Identifier":e=o.name;break;case"MemberExpression":e=o.property.name}if(n.length>u+2&&n[u+1].name&&n[u+1].name.toLowerCase()=="as"){if(u=u+2,s=n[u],s.type!="Identifier")throw t.createError(r.invalidPropertyAlias,{expressions:n,aliasExpression:s});e=s.name}if(n.length>1&&!e)throw t.createError(r.projectionsMustHaveAlias,{expressions:n,expression:o});h.push({p:e,func:t.jsepToFunction(o,i)})}return function(t){for(var r,u,f={},i=0;i<h.length;i++){if(r=h[i],u=r.func(t),n.length==1)return u;f[r.p]=u}return f}}}}(),f=function(){var n=function(n,i){this.value=n;this.name=i;this.errors=[];t.tryFreeze(this)},i=n.prototype;return i.hasValue=function(){return n.hasValue(this.value,this.errors,this.name),this},i.isObject=function(){return n.isObject(this.value,this.errors,this.name),this},i.isFunction=function(){return n.isFunction(this.value,this.errors,this.name),this},i.isNotEmptyString=function(){return n.isNotEmptyString(this.value,this.errors,this.name),this},i.isTypeOf=function(t){return n.isTypeOf(this.value,t,this.errors,this.name),this},i.isArray=function(){return n.isArray(this.value,this.errors,this.name),this},i.isEnum=function(t){return n.isEnum(this.value,t,this.errors,this.name),this},i.isInstanceOf=function(t){return n.isInstanceOf(this.value,t,this.errors,this.name),this},i.check=function(){if(this.errors.length>0)throw t.createError(this.errors.join("\n"),{name:this.name,value:this.value});},n.hasValue=function(n,i,u){return n==null?(i&&i.push(t.formatString(r.valueCannotBeNull,u)),!1):!0},n.isObject=function(n,i,u){return n==null||!e.dataTypes.object.isValid(n)?(i&&i.push(t.formatString(r.typeError,u,"object")),!1):!0},n.isFunction=function(n,i,u){return n==null||!e.dataTypes.function.isValid(n)?(i&&i.push(t.formatString(r.typeError,u,"function")),!1):!0},n.isNotEmptyString=function(i,u,f){return i==null||i===""||!n.isTypeOf(i,"string",u)?(u&&u.push(t.formatString(r.cannotBeEmptyString,f)),!1):!0},n.isTypeOf=function(i,u,f,o){if(!n.hasValue(i))return!1;var s=e.dataTypes.byName(u);return s.isValid(i)?!0:(f&&f.push(t.formatString(r.typeMismatch,o,u,s,i)),!1)},n.isArray=function(n,i,u){return n==null||!e.dataTypes.array.isValid(n)?(i&&i.push(t.formatString(r.typeError,u,"array")),!1):!0},n.isEnum=function(n,i,u){return i.contains(n)?!0:(u&&u.push(t.formatString(r.invalidEnumValue,i,n)),!1)},n.isInstanceOf=function(n,i,u,f){return n==null?(u&&u.push(r.cannotCheckInstanceOnNull),!1):(n instanceof i)?!0:(u&&u.push(t.formatString(r.instanceError,f,i)),!1)},n}(),h=function(){var i={};return i.Enum=function(){function r(n,t){for(var i in t)n[i]=t[i];return n}function n(n,i){this.name=n;i&&r(this,i);t.tryFreeze(this)}n.prototype={};n.prototype.constructor=n;n.prototype.toString=function(){return this.name};t.tryFreeze(n.prototype);var i=function(i){var u=this,r;if(arguments.length===1&&i!==null&&typeof i=="object")for(r in i)u[r]=new n(r,i[r]);else t.forEach(arguments,function(t){u[t]=new n(t)});t.tryFreeze(this)};return i.prototype.symbols=function(){var t=[],i,n;for(i in this)(n=this[i],f.isFunction(n))||t.push(n);return t},i.prototype.contains=function(t){return(t instanceof n)?this[t.name]===t:!1},i}(),i.jsep=function(t){var a="Compound",k="Identifier",v="MemberExpression",h="Literal",d="ThisExpression",g="CallExpression",nt="UnaryExpression",tt="BinaryExpression",it="LogicalExpression",u=!0,f={"-":u,"!":u,"~":u,"+":u},r={"=>":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},s=function(n){var t=0,i;for(var r in n)(i=r.length)>t&&n.hasOwnProperty(r)&&(t=i);return t},c=s(f),e=s(r),y={"true":!0,"false":!1,"null":null},rt="this",p=function(n){return r[n]||0},w=function(n,t,i){var r=n==="||"||n==="&&"?it:tt;return{type:r,operator:n,left:t,right:i}},o=function(n){return n>=48&&n<=57},l=function(n){return n===36||n===95||n===64||n>=65&&n<=90||n>=97&&n<=122},ut=function(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57},i=function(n){for(var t=0,ct=n.charAt,lt=n.charCodeAt,i=function(t){return ct.call(n,t)},u=function(t){return lt.call(n,t)},b=n.length,s=function(){for(var n=u(t);n===32||n===9;)n=u(++t)},ot=function(){s();for(var i=n.substr(t,e),u=i.length;u>0;){if(r.hasOwnProperty(i))return t+=u,i;i=i.substr(0,--u)}return!1},tt=function(){var r,i,o,n,s,f,e,u;if(f=it(),i=ot(),!i)return f;if(s={value:i,prec:p(i)},e=it(),!e)throw new Error("Expected expression after "+i+" at character "+t);for(n=[f,s,e];i=ot();){if(o=p(i),o===0)break;for(s={value:i,prec:o};n.length>2&&o<=n[n.length-2].prec;)e=n.pop(),i=n.pop().value,f=n.pop(),r=w(i,f,e),n.push(r);if(r=it(),!r)throw new Error("Expected expression after "+i+" at character "+t);n.push(s);n.push(r)}for(u=n.length-1,r=n[u];u>1;)r=w(n[u-1].value,n[u-2],r),u-=2;return r},it=function(){var i,r,e;if(s(),i=u(t),o(i)||i===46)return at();if(i===39||i===34)return vt();if(l(i))return pt();if(i===40)return wt();for(r=n.substr(t,c),e=r.length;e>0;){if(f.hasOwnProperty(r))return t+=e,{type:nt,operator:r,argument:it(),prefix:!0};r=r.substr(0,--e)}return!1},at=function(){for(var n="";o(u(t));)n+=i(t++);if(i(t)===".")for(n+=i(t++);o(u(t));)n+=i(t++);if(i(t)==="e"||i(t)==="E"){for(n+=i(t++),(i(t)==="+"||i(t)==="-")&&(n+=i(t++));o(u(t));)n+=i(t++);if(!o(u(t-1)))throw new Error("Expected exponent ("+n+i(t)+") at character "+t);}if(l(u(t)))throw new Error("Variable names cannot start with a number ("+n+i(t)+") at character "+t);return{type:h,value:parseFloat(n),raw:n}},vt=function(){for(var n="",u=i(t++),f=!1,r;t<b;)if(r=i(t++),r===u){f=!0;break}else if(r==="\\"){r=i(t++);switch(r){case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\x0b"}}else n+=r;if(!f)throw new Error('Unclosed quote after "'+n+'"');return{type:h,value:n,raw:u+n+u}},st=function(){var f=u(t),e=t,r;if(l(f))t++;else throw new Error("Unexpected "+i(t)+"at character "+t);while(t<b)if(f=u(t),ut(f))t++;else break;return r=n.slice(e,t),y.hasOwnProperty(r)?{type:h,value:y[r],raw:r}:r===rt?{type:d}:{type:k,name:r}},yt=function(){for(var r,u=[],n;t<b;)if(s(),r=i(t),r===")"){t++;break}else if(r===",")t++;else{if(n=tt(),!n||n.type===a)throw new Error("Expected comma at character "+t);u.push(n)}return u},pt=function(){var n,r,u;for(r=st(),s(),n=i(t);n==="."||n==="["||n==="(";){if(n===".")t++,s(),r={type:v,computed:!1,object:r,property:st()};else if(n==="["){if(u=t,t++,r={type:v,computed:!0,object:r,property:tt()},s(),n=i(t),n!=="]")throw new Error("Unclosed [ at character "+t);t++;s()}else n==="("&&(t++,r={type:g,arguments:yt(),callee:r});s();n=i(t)}return r},wt=function(){t++;var n=tt();if(s(),i(t)===")")return t++,n;throw new Error("Unclosed ( at character "+t);},ft=[],et,ht;t<b;)if(et=i(t),et===";"||et===",")t++;else if(ht=tt())ft.push(ht);else if(t<b)throw new Error("Unexpected '"+i(t)+"' at character "+t);return ft.length===1?ft[0]:{type:a,body:ft}},b;return i.version="0.2.8",i.toString=function(){return"JavaScript Expression Parser (JSEP) v"+i.version},i.addUnaryOp=function(n){return f[n]=u,this},i.addBinaryOp=function(n,t){return e=Math.max(n.length,e),r[n]=t,this},i.removeUnaryOp=function(n){return delete f[n],n.length===c&&(c=s(f)),this},i.removeBinaryOp=function(n){return delete r[n],n.length===e&&(e=s(r)),this},typeof n=="undefined"?(b=t.jsep,t.jsep=i,i.noConflict=function(){return t.jsep===i&&(t.jsep=b),i}):typeof module!="undefined"&&module.exports?n=module.exports=i:n.parse=i,i}(n),i}(),i=function(){return{DateConverterBase:function(){var n=function(n){this.name=n},i=n.prototype;return i.parse=function(){throw t.createError(r.notImplemented,["DateConverterBase","parse"]);},i.toISOString=function(){throw t.createError(r.notImplemented,["DateConverterBase","toISOString"]);},n}(),DataTypeBase:function(){var i=function(n){this.name=n||"DataTypeBase";this.isComplex=!1},n=i.prototype;return n.toString=function(){return this.name},n.getRawValue=function(n){return n},n.isValid=function(n){return typeof n===this.name},n.toODataValue=function(n){return n.toString()},n.toBeetleValue=function(n){return n.toString()},n.defaultValue=function(){throw t.createError(r.notImplemented,[this.name,"defaultValue"]);},n.autoValue=function(){throw t.createError(r.notImplemented,[this.name,"autoValue"]);},n.handle=function(){throw t.createError(r.notImplemented,[this.name,"handle"]);},i}(),ExpressionBase:function(){var i=function(n,t,i,r){this.name=n||"ExpressionBase";this.order=t;this.onlyBeetle=i;this.isProjection=r},n=i.prototype;return n.toString=function(){return this.toBeetleQuery({})},n.combine=function(){throw t.createError(r.notImplemented,[this.name,"combine"]);},n.toODataQuery=function(n){if(this.onlyBeetle===!0)return this.toBeetleQuery(n);throw t.createError(r.notImplemented,[this.name,"toODataQuery"]);},n.toBeetleQuery=function(){throw t.createError(r.notImplemented,[this.name,"toBeetleQuery"]);},n.clone=function(){throw t.createError(r.notImplemented,[this.name,"clone"]);},n.execute=function(){throw t.createError(r.notImplemented,[this.name,"execute"]);},i}(),QueryFuncBase:function(){var i=function(n,t,i){this.name=n;this.beetleName=t;this.argCount=i},n=i.prototype;return n.toODataFunction=function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);return this.name+"("+t.join(", ")+")"},n.toBeetleFunction=function(){var i="",n=0,t;for(arguments.length==this.argCount&&(i=arguments[0]+".",++n),t=[],n;n<arguments.length;n++)t.push(arguments[n]);return i+this.beetleName+"("+t.join(", ")+")"},n.impl=function(){throw t.createError(r.notImplemented,[this.name,"impl"]);},i}(),QueryBase:function(){var u=function(){this.expressions=[];this.inlineCountEnabled=!1;this.lastExpOrder=0;this.isMultiTyped=!1;this.lastProjection=0;this.isClosed=!1;this.hasBeetlePrm=!1;this.options=null},n=u.prototype;return n.executeAfterExecuter=!1,n.toString=function(){var n=[],i;return t.forEach(this.parameters,function(t){n.push(t.name+": "+(t.value==null?"":t.value))}),this.inlineCountEnabled===!0&&n.push("inlinecount: allpages"),i={},t.forEach(this.expressions,function(t){n.push(t.name+": "+t.toBeetleQuery(i))}),n.join(", ")},n.addExpression=function(n){if(this.isClosed)throw t.createError(r.queryClosed,null,{query:this});if(t.assertPrm(n,"expression").isInstanceOf(i.ExpressionBase).check(),this.expressions.push(n),n.isExecuter===!0){var u=this.options&&this.options.executeAfterExecuter;if(u==null&&(u=this.executeAfterExecuter),u)return this.execute();this.isClosed=!0}return(n.order<this.lastExpOrder||this.hasBeetlePrm&&!n.onlyBeetle)&&(this.isMultiTyped=!0),n.isProjection===!0&&(this.lastProjection=this.expressions.length-1),n.onlyBeetle&&(this.hasBeetlePrm=!0),this},n.inlineCount=function(n){var t=this.clone();return t.inlineCountEnabled=n!==!1,t},n.ofType=function(n){var t=this.clone(),i=t.getExpression(o.expressions.OfTypeExp);return i?(i.combine(n),t):t.addExpression(new o.expressions.OfTypeExp(n))},n.clearWhere=function(){var n=this.clone();return n.removeExpression(o.expressions.WhereExp)},n.where=function(){var n=this.clone(),t=n.getExpression(o.expressions.WhereExp);return t==null?n.addExpression(new o.expressions.WhereExp(arguments)):t.and(arguments),n},n.and=function(){var n=this.clone();return n.getExpression(o.expressions.WhereExp,!0).and(arguments),n},n.or=function(){var n=this.clone();return n.getExpression(o.expressions.WhereExp,!0).or(arguments),n},n.andGroup=function(){var n=this.clone(),t=n.getExpression(o.expressions.WhereExp);return t?t.andGroup.apply(t,arguments):n=n.where.apply(n,arguments),n},n.orGroup=function(){var n=this.clone(),t=n.getExpression(o.expressions.WhereExp);return t?t.orGroup.apply(t,arguments):n=n.where.apply(n,arguments),n},n.closeGroup=function(){var n=this.clone();return n.getExpression(o.expressions.WhereExp,!0).closeGroup(),n},n.clearOrderBy=function(){var n=this.clone();return n.removeExpression(o.expressions.OrderByExp)},n.orderBy=function(n,t){var i=this.clone(),r=i.getExpression(o.expressions.OrderByExp);return r?(r.combine(n,t),i):i.addExpression(new o.expressions.OrderByExp(n,t))},n.orderByDesc=function(n){return this.orderBy(n,!0)},n.select=function(n){var i=this.clone(),t;return arguments.length==1?(t=arguments[0],f.isArray(t)&&(n=t.join(", "))):n=Array.prototype.slice.call(arguments).join(", "),i.addExpression(new o.expressions.SelectExp(n))},n.skip=function(n){var t=this.clone(),i=t.getExpression(o.expressions.SkipExp);return i?(i.combine(n),t):t.addExpression(new o.expressions.SkipExp(n))},n.take=function(n){return this.top(n)},n.top=function(n){var t=this.clone(),i=t.getExpression(o.expressions.TopExp);return i?(i.combine(n),t):t.addExpression(new o.expressions.TopExp(n))},n.groupBy=function(n,t){var i=this.clone();return f.isArray(n)&&(n=n.join(", ")),f.isArray(t)&&(t=t.join(", ")),i.addExpression(new o.expressions.GroupByExp(n,t))},n.distinct=function(n){var t=this.clone();return f.isArray(n)&&(n=n.join(", ")),t.addExpression(new o.expressions.DistinctExp(n))},n.reverse=function(){var n=this.clone();return n.addExpression(new o.expressions.ReverseExp)},n.selectMany=function(n){var t=this.clone();return t.addExpression(new o.expressions.SelectManyExp(n))},n.skipWhile=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.SkipWhileExp(n,t))},n.takeWhile=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.TakeWhileExp(n,t))},n.all=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.AllExp(n,t))},n.any=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.AnyExp(n,t))},n.avg=function(n){var t=this.clone();return t.addExpression(new o.expressions.AvgExp(n))},n.max=function(n){var t=this.clone();return t.addExpression(new o.expressions.MaxExp(n))},n.min=function(n){var t=this.clone();return t.addExpression(new o.expressions.MinExp(n))},n.sum=function(n){var t=this.clone();return t.addExpression(new o.expressions.SumExp(n))},n.count=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.CountExp(n,t))},n.first=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.FirstExp(n,t))},n.firstOrDefault=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.FirstOrDefaultExp(n,t))},n.single=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.SingleExp(n,t))},n.singleOrDefault=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.SingleOrDefaultExp(n,t))},n.last=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.LastExp(n,t))},n.lastOrDefault=function(n,t){var i=this.clone();return i.addExpression(new o.expressions.LastOrDefaultExp(n,t))},n.withOptions=function(n){var i=this.clone();return i.options=t.combine(this.options,n),i},n.execute=function(){throw t.createError(r.notImplemented,["Query","execute"]);},n.x=function(){return this.execute.apply(this,arguments)},n.toFunction=function(){var n=this;return function(i,r){var u={varContext:r};return u.aliases=[],n.inlineCountEnabled&&(u.inlineCount=i.length),t.forEach(n.expressions,function(t){u.expVarContext=t.varContext;i=t.execute(i,u);!n.inlineCountEnabled||f.isInstanceOf(t,o.expressions.TopExp)||f.isInstanceOf(t,o.expressions.SkipExp)||(u.inlineCount=i.length);u.expVarContext=undefined}),n.inlineCountEnabled&&(i.$inlineCount=u.inlineCount),i}},n.clone=function(){throw t.createError(r.notImplemented,["Query","clone"]);},n.copy=function(n){t.forEach(this.expressions,function(t){n.expressions.push(t.clone())});n.inlineCountEnabled=this.inlineCountEnabled;n.lastExpOrder=this.lastExpOrder;n.isMultiTyped=this.isMultiTyped;n.lastProjection=this.lastProjection;n.isClosed=this.isClosed;n.hasBeetlePrm=this.hasBeetlePrm;this.options&&(n.options=t.combine(null,this.options))},n.getExpression=function(n,i){for(var e,u=this.lastProjection;u<this.expressions.length;u++)if(e=this.expressions[u],f.isInstanceOf(e,n))return e;if(i===!0)throw t.createError(r.expressionCouldNotBeFound,{type:n,query:this});return null},n.removeExpression=function(n){for(var i,t=this.expressions.length-1;t>=0;t--)i=this.expressions[t],f.isInstanceOf(i,n)&&this.expressions.splice(t,1);return this},u}(),ObservableProviderBase:function(){var i=function(n){this.name=n||"ObservableProviderBase"},n=i.prototype;return n.toString=function(){return this.name},n.isObservable=function(){throw t.createError(r.notImplemented,[this.name,"isObservable"]);},n.toObservable=function(){throw t.createError(r.notImplemented,[this.name,"toObservable"]);},n.getValue=function(){throw t.createError(r.notImplemented,[this.name,"getValue"]);},n.setValue=function(){throw t.createError(r.notImplemented,[this.name,"setValue"]);},i}(),AjaxProviderBase:function(){var n=function(n){this.name=n||"AjaxProviderBase";this.syncSupported=!0},i=n.prototype;return i.toString=function(){return this.name},i.doAjax=function(){throw t.createError(r.notImplemented,[this.name,"doAjax"]);},n}(),SerializationServiceBase:function(){var i=function(n){this.name=n||"SerializationServiceBase"},n=i.prototype;return n.toString=function(){return this.name},n.serialize=function(){throw t.createError(r.notImplemented,[this.name,"serialize"]);},n.deserialize=function(){throw t.createError(r.notImplemented,[this.name,"deserialize"]);},i}(),PromiseProviderBase:function(){var i=function(n){this.name=n||"PromiseProviderBase"},n=i.prototype;return n.toString=function(){return this.name},n.deferred=function(){throw t.createError(r.notImplemented,[this.name,"deferred"]);},n.getPromise=function(){throw t.createError(r.notImplemented,[this.name,"getPromise"]);},n.resolve=function(){throw t.createError(r.notImplemented,[this.name,"resolve"]);},n.reject=function(){throw t.createError(r.notImplemented,[this.name,"reject"]);},i}(),DataServiceBase:function(){function v(n,i,e,o){if(o._awaitingMetadata=!1,o._readyCallbacks=[],n==null?n="":n[n.length-1]!=="/"&&(n+="/"),o.uri=n,e=e||{},o.ajaxProvider=e.ajaxProvider||s.getAjaxProvider(),o.serializationService=e.serializationService||s.getSerializationService(),o.ajaxTimeout=e.ajaxTimeout,o.dataType=e.dataType||"json",o.contentType=e.contentType||"application/json; charset=utf-8",u=e.registerMetadataTypes,u==null&&(u=s.registerMetadataTypes),i!==!1||i===undefined)if(i==null){var a=null;s.cacheMetadata===!0&&(a=t.findInArray(c,n,"uri"));a?o.metadataManager=a.data:(o._awaitingMetadata=!0,o.fetchMetadata(null,function(t){o._awaitingMetadata=!1;o.metadataManager=new l.MetadataManager(t);s.cacheMetadata===!0&&c.push({uri:n,data:o.metadataManager});h(o)},function(n){o._awaitingMetadata=!1;throw t.createError(r.couldNotLoadMetadata,{exception:n,args:arguments,dataService:this});}))}else if(f.isInstanceOf(i,l.MetadataManager))o.metadataManager=i;else if(f.isObject(i))try{o.metadataManager=new l.MetadataManager(i)}catch(v){throw t.createError(r.invalidArguments,{exception:v,args:arguments,dataService:this});}o._awaitingMetadata||h(o)}function h(t){var r,f,o,i,s;if(t.isReady())for(r=t.metadataManager,u&&r&&(f=r.name,n.hasOwnProperty(f)||(n[f]=e.EntityManager)),o=t._readyCallbacks.slice(0),t._readyCallbacks=[],i=0;i<o.length;i++)s=o[i],s&&s.call(t)}var c=[],a=function(n,t,i){v(n,t,i,this)},i=a.prototype,u;return i.toString=function(){return this.uri},i.isReady=function(){return!this._awaitingMetadata},i.ready=function(n){this._readyCallbacks.push(n);h(this)},i.getEntityType=function(n){return this.metadataManager?this.metadataManager.getEntityTypeByShortName(n):null},i.createQuery=function(n,i,r){return(t.assertPrm(n,"resourceName").isNotEmptyString().check(),i)?this.createEntityQuery(i,n,r):this.metadataManager?this.metadataManager.createQuery(n,null,r):new o.EntityQuery(n,null,r)},i.createEntityQuery=function(n,i,u){if(t.assertPrm(n,"shortName").isNotEmptyString().check(),!this.metadataManager)throw t.createError(r.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createQuery(i,n,u)},i.registerCtor=function(n,i,u){if(this.metadataManager==null)throw t.createError(r.noMetadataEntityQuery);this.metadataManager.registerCtor(n,i,u)},i.createEntity=function(n,i){if(!this.metadataManager)throw t.createError(r.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createEntity(n,i)},i.createRawEntity=function(n,i){if(!this.metadataManager)throw t.createError(r.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createRawEntity(n,i)},i.toEntity=function(n,t){var i=null;return this.metadataManager&&(i=this.metadataManager.getEntityType(t)),i||(i=new l.EntityType(t)),e.EntityTracker.toEntity(n,i,s.getObservableProvider())},i.toODataQueryParams=function(n,i){if(n.isMultiTyped===!0)throw t.createError(r.oDataNotSupportMultiTyped,{query:n});var u={varContext:i},f=[];return t.forEach(n.parameters,function(n){f.push({name:n.name,value:n.value==null?"":n.value})}),n.inlineCountEnabled===!0&&f.push({name:"$inlinecount",value:"allpages"}),t.forEach(n.expressions,function(n,t){u.expVarContext=n.varContext;var r,i;n.onlyBeetle===!0?(r="!e"+t,i=n.toBeetleQuery(u),i=n.name+":"+i):(r="$"+n.name,i=n.toODataQuery(u));f.push({name:r,value:i});u.expVarContext=undefined}),f},i.toBeetleQueryParams=function(n,i){var u={varContext:i},r=[];return t.forEach(n.parameters,function(n){r.push({name:n.name,value:n.value==null?"":n.value})}),n.inlineCountEnabled===!0&&r.push({name:"!e0",value:"inlinecount:allpages"}),t.forEach(n.expressions,function(n,t){u.expVarContext=n.varContext;r.push({name:"!e"+(t+1),value:n.name+":"+n.toBeetleQuery(u)});u.expVarContext=undefined}),r},i.fetchMetadata=function(){throw t.createError(r.notImplemented,["DataServiceBase","fetchMetadata"]);},i.createEntityAsync=function(){throw t.createError(r.notImplemented,["DataServiceBase","createEntityAsync"]);},i.executeQuery=function(){throw t.createError(r.notImplemented,["DataServiceBase","executeQuery"]);},i.executeQueryParams=function(){throw t.createError(r.notImplemented,["DataServiceBase","executeQueryParams"]);},i.saveChanges=function(){throw t.createError(r.notImplemented,["DataServiceBase","saveChanges"]);},a}()}}(),c=function(){return{defaultDateConverterInstance:function(){var n=function(){i.DateConverterBase.call(this,"Default Date Converter")},r;return t.inherit(n,i.DateConverterBase),r=n.prototype,r.parse=function(n){if(typeof n!="string"||n.length<10||!/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(n.substr(0,10)))return null;/.\d{3}$/.test(n)&&(n+="Z");try{var t=Date.parse(n);return isNaN(t)?null:new Date(t)}catch(i){return null}},r.toISOString=function(n){return n.toISOString()},new n}(),koObservableProviderInstance:function(n){var u,r;return n&&(n.extenders.intercept=function(t,i){return n.computed({read:t,write:function(n){var r=i&&i.callback;r&&r(i.object,i.property,t,n)}})}),u=function(){i.ObservableProviderBase.call(this,"Knockout Observable Provider");t.tryFreeze(this)},t.inherit(u,i.ObservableProviderBase),r=u.prototype,r.isObservable=function(t,i){return n.isObservable(t[i])},r.toObservable=function(i,r,u){function s(t,r,u){var f=n.observable(r);return u?n.observable(r).extend({intercept:{object:i,property:t,callback:u}}):f}function c(t,r,u,f,o){var s;return u=u||[],f&&(u=new e.TrackableArray(u,i,t,function(n,t,u,e,o){s.$fromKo!==!0&&i[r].valueHasMutated();s.$fromKo=!1;f(n,t,u,e,o)})),s=n.observableArray(u),s.subscribe(function(){s.$fromKo=!0},null,"beforeChange"),o&&(s.equalityComparer=function(n,r){o(i,t,n,r)}),s}var l=u&&u.propertyChange,a=u&&u.arrayChange,v=u&&u.dataPropertyChange,y=u&&u.scalarNavigationPropertyChange,p=u&&u.pluralNavigationPropertyChange,h=u&&u.arraySet,o=[];t.forEachProperty(i,function(n,t){o.push({p:n,v:t})});r&&r.hasMetadata&&(t.forEach(r.dataProperties,function(n){var r=i[n.name];r=r===undefined?null:n.handle(r);i[n.name]=s(n,r,v);t.removeFromArray(o,n.name,"p")}),t.forEach(r.navigationProperties,function(n){var r=i[n.name];r===undefined&&(r=null);i[n.name]=n.isScalar?s(n,r,y):c(n,n.name,r,p,h);t.removeFromArray(o,n.name,"p")}));t.forEach(o,function(n){var u=n.p,e=n.v;i[u]=f.isArray(e)?c(u,u,e,a,h):s(u,e,l);t.findInArray(r.properties,u)||r.properties.push(u)})},r.getValue=function(t,i){return n.utils.unwrapObservable(t[i])},r.setValue=function(n,t,i){n[t](i)},new u}(n.ko),propertyObservableProviderInstance:function(){var r=function(){i.ObservableProviderBase.call(this,"Property Observable Provider");t.tryFreeze(this)},n;return t.inherit(r,i.ObservableProviderBase),n=r.prototype,n.isObservable=function(n,t){return n.$fields!==undefined&&n.$fields[t]!==undefined},n.toObservable=function(n,i,r){function s(t,i,r){return Object.defineProperty(n,i,{get:function(){return n.$fields[i]},set:function(u){if(r){var f=w(n,i);r(n,t,f,u)}else n.$fields[i]=u},enumerable:!0,configurable:!0})}function c(t,i,r,f,o){return r=r||[],f&&(r=new e.TrackableArray(r,n,t,f)),u[i]=r,Object.defineProperty(n,i,{get:function(){return n.$fields[i]},set:function(r){o?o(n,t,items,r):n.$fields[i]=r}})}function w(n,t){return function(){return arguments.length==0?n.$fields[t]:n.$fields[t]=arguments[0]}}var l=r&&r.propertyChange,a=r&&r.arrayChange,v=r&&r.dataPropertyChange,y=r&&r.scalarNavigationPropertyChange,p=r&&r.pluralNavigationPropertyChange,h=r&&r.arraySet,u={},o=[];return t.forEachProperty(n,function(n,t){o.push({p:n,v:t})}),i&&i.hasMetadata&&(t.forEach(i.dataProperties,function(i){var r=n[i.name];r=r===undefined?null:i.handle(r);delete n[i.name];s(i,i.name,v);t.removeFromArray(o,i.name,"p");u[i.name]=r}),t.forEach(i.navigationProperties,function(i){var r=n[i.name];r===undefined&&(r=null);delete n[i.name];i.isScalar?(s(i,i.name,y),u[i.name]=r):c(i,i.name,r,p,h);t.removeFromArray(o,i.name,"p")})),t.forEach(o,function(r){var e=r.p,o=r.v;delete n[e];f.isArray(o)?c(e,e,o,a,h):(s(e,e,l),u[e]=o);t.findInArray(i.properties,e)||i.properties.push(e)}),n.$fields=u,n},n.getValue=function(n,t){return n[t]},n.setValue=function(n,t,i){n[t]=i},new r}(),jQueryAjaxProviderInstance:function(n){function f(n){var i={status:n.status,xhr:n};if(n.responseText)try{i.detail=JSON.parse(n.responseText)}catch(r){}return t.createError(n.statusText,i)}function e(n){return function(t){return n.getResponseHeader(t)}}var r=function(){i.AjaxProviderBase.call(this,"jQuery Ajax Provider");t.tryFreeze(this)},u;return t.inherit(r,i.AjaxProviderBase),u=r.prototype,u.doAjax=function(t,i,r,u,o,s,h,c,l,a,v){var y={url:t,accepts:{json:"application/json; odata=verbose",xml:"text/xml; application/xhtml+xml;application/xml",text:"text/xml"},type:i,dataType:r,contentType:u,traditional:!1,data:o,async:s,timeout:h,headers:l,success:function(n,t,i){if(i.onreadystatechange=null,i.abort=null,n&&n.Error){var r=f(i);r.message=n.Error;v(r)}else a(n,e(i),i)},error:function(n){n.onreadystatechange=null;n.abort=null;v(f(n))}};return c!=null&&n.extend(y,c),y.cache==null&&(y.cache=!1),n.ajax(y)},new r}(n.$),angularAjaxProviderInstance:function(n){function o(n,i,r){var u={status:i};if(n)try{u.detail=JSON.parse(n)}catch(f){u.detail=n}return t.createError(r,u)}function s(n){return function(t){return n[t]}}var u=function(){i.AjaxProviderBase.call(this,"Angular Ajax Provider");this.syncSupported=!1;t.tryFreeze(this)},f,e;return t.inherit(u,i.AjaxProviderBase),f=u.prototype,n&&(e=n.injector(["ng"]).get("$http")),f.doAjax=function(n,i,u,f,h,c,l,a,v,y,p){if(c===!1)throw t.createError(r.syncNotSupported,[this.name]);var w={method:i,url:n,contentType:f,data:h,timeout:l,headers:v,responseType:u};return a!=null&&t.extend(w,a),w.cache==null&&(w.cache=!1),e(w).success(function(n,t,i){y(n,s(i))}).error(function(n,t,i,r,u){p(o(n,t,u))})},new u}(n.angular),jsonSerializationServiceInstance:function(){var n=function(){i.SerializationServiceBase.call(this,"Json Serializer");t.tryFreeze(this)},r;return t.inherit(n,i.SerializationServiceBase),r=n.prototype,r.serialize=function(n){return JSON.stringify(n)},r.deserialize=function(n){return f.isTypeOf(n,"string")?JSON.parse(n):n},new n}(),qPromiseProviderInstance:function(n){var u=function(){i.PromiseProviderBase.call(this,"Q Promise Provider");t.tryFreeze(this)},r;return t.inherit(u,i.PromiseProviderBase),r=u.prototype,r.toString=function(){return this.name},r.deferred=function(){return n.defer()},r.getPromise=function(n){return n.promise},r.resolve=function(n,t){n.resolve(t)},r.reject=function(n,t){n.reject(t)},new u}(n.Q),angularPromiseProviderInstance:function(n){var f=function(){i.PromiseProviderBase.call(this,"Angular Promise Provider");t.tryFreeze(this)},r,u,e;return t.inherit(f,i.PromiseProviderBase),r=f.prototype,r.toString=function(){return this.name},n&&(u=n.injector(["ng"]),e=u.get("$q")),r.deferred=function(){return e.defer()},r.getPromise=function(n){return n.promise},r.resolve=function(n,t){n.resolve(t);u.get("$rootScope").$apply()},r.reject=function(n,t){n.reject(t);u.get("$rootScope").$apply()},new f}(n.angular),jQueryPromiseProviderInstance:function(n){var u=function(){i.PromiseProviderBase.call(this,"jQuery Promise Provider");t.tryFreeze(this)},r;return t.inherit(u,i.PromiseProviderBase),r=u.prototype,r.toString=function(){return this.name},r.deferred=function(){return n.Deferred()},r.getPromise=function(n){return n.promise()},r.resolve=function(n,t){n.resolve(t)},r.reject=function(n,t){n.reject(t)},new u}(n.$)}}(),l=function(){return{DataProperty:function(){var i=function(n,t,i,r,u,f,o,s,h){this.owner=n;this.name=t;this.displayName=i||t;this.dataType=r;this.isNullable=u;this.isKeyPart=f;this.generationPattern=o;this.defaultValue=s;this.useForConcurrency=h;this.relatedNavigationProperties=[];this.validators=[];this.isEnum=r instanceof e.dataTypes.enum;this.isComplex=r.isComplex},n=i.prototype;return n.toString=function(){return this.displayName},n.isValid=function(n){return n==null?!this.isNullable:this.dataType.isValid(n,this)},n.handle=function(n){if(this.dataType!=e.dataTypes.string&&n===""&&(n=null),n==null){if(!this.isNullable)throw t.createError(r.notNullable,[this.displayName],{property:this});return null}if(n=this.dataType.handle(n,this),this.dataType==e.dataTypes.number&&this.precision&&n.toString().replace(/\./g,"").length>this.precision)throw t.createError(r.maxPrecisionError,[n,this.precision],{dataType:dataType,value:n});return this.dataType==e.dataTypes.number&&this.scale!=null&&(n=Number(n.toFixed(this.scale))),n},n.getDefaultValue=function(){return this.defaultValue?this.defaultValue:this.isNullable?null:this.generationPattern==u.generationPattern.Identity&&this.isKeyPart===!0?this.dataType.autoValue():this.dataType.defaultValue()},n.addValidation=function(n,i,r,u){t.assertPrm(n,"name").isNotEmptyString().check();t.assertPrm(i,"func").isFunction().check();this.validators.push(new e.Validator(n,i,r,u))},n.validate=function(n){var u=[],i,r;return this.validators.length>0&&(i=this,r=t.getValue(n,i.name),t.forEach(this.validators,function(f){var e=f.validate(r,n);e&&u.push(t.createValidationError(n,r,i,e,f))})),u},i}(),NavigationProperty:function(){var i=function(n,t,i,r,u,f,e,o){this.owner=n;this.name=t;this.displayName=i||t;this.entityTypeName=r;this.entityType=null;this.isScalar=u;this.isComplex=f===undefined;this.associationName=f;this.cascadeDelete=e===!0;this.foreignKeyNames=o||[];this.inverse=null;this.foreignKeys=[];this.validators=[];this.triggerOwnerModify=!1},n=i.prototype;return n.toString=function(){return this.displayName},n.checkAssign=function(n){if(n!=null){if(!n.$tracker)throw t.createError(r.assignErrorNotEntity,[this],{property:this,value:n});var i=n.$tracker.entityType;if(!this.entityType.isAssignableWith(i))throw t.createError(r.assignError,[this.name,i.shortName],{property:this,value:n});}},n.addValidation=function(n,i,r,u){t.assertPrm(n,"name").isNotEmptyString().check();t.assertPrm(i,"func").isFunction().check();this.validators.push(new e.Validator(n,i,r,u))},n.validate=function(n){var u=[],i,r;return this.validators.length>0&&(i=this,r=t.getValue(n,i.name),t.forEach(this.validators,function(f){var e=f.validate(r);e&&u.push(t.createValidationError(n,r,i,e,f))})),u},i}(),EntityType:function(){function u(n,t){n.baseType&&u(n.baseType,t);n.constructor&&n.constructor.call(t,t)}function a(n,i){for(var u,f,e,o=n.length,r=0;r<o;r++){if(u=n[r],r==o-1)return f=t.findInArray(i.dataProperties,u,"name"),f?f:t.findInArray(i.navigationProperties,u,"name");if(e=t.findInArray(i.navigationProperties,u,"name"),e)i=e.entityType;else return null}return null}function h(n,t){return n.name===t.name?!0:t.baseType!=null?h(n,t.baseType):!1}function c(n,t){var i=f.isTypeOf(t,"string")?t:t.name;return n.name===i?!0:n.baseType!=null?c(n.baseType,t):!1}var i=function(n,t,i,r,u,f,e,o,s){this.name=n;this.displayName=t||n;this.shortName=i;this.keyNames=r||[];this.baseTypeName=u;this.setName=f;this.setTypeName=e;this.metadataManager=s;this.hasMetadata=s!=null;this.properties=[];this.dataProperties=[];this.navigationProperties=[];this.keys=[];this.floorType=this;this.baseType=null;this.validators=[];this.isComplexType=o==!0;this.constructor=null;this.initializer=null},n=i.prototype;return n.toString=function(){return this.name},n.getProperty=function(n){return a(n.split("."),this)},n.createQuery=function(n,t){if(n)return new o.EntityQuery(n,this,t);var i=new o.EntityQuery(this.setName,this,t);return this.shortName==this.setTypeName?i:i.ofType(this.shortName)},n.registerCtor=function(n,i){n!=null&&t.assertPrm(n,"constructor").isFunction().check();i!=null&&t.assertPrm(i,"initializer").isFunction().check();this.constructor=n;this.initializer=i},n.createEntity=function(n){var t=this.createRawEntity(n);return e.EntityTracker.toEntity(t,this,s.getObservableProvider())},n.createRawEntity=function(n){var i=n||{};return t.forEach(this.dataProperties,function(n){i[n.name]||(i[n.name]=n.getDefaultValue())}),t.forEach(this.navigationProperties,function(n){i[n.name]=n.isComplex?n.entityType.createRawEntity():n.isScalar?null:[]}),u(this,i),i.$type=this.name,i},n.isAssignableWith=function(n){return h(this,n)},n.isAssignableTo=function(n){return c(this,n)},n.hasSameBaseType=function(n){return this.floorType.name===n.floorType.name},n.addDataProperty=function(n,i,u,o,s){var h,c;if(t.assertPrm(n,"name").isNotEmptyString().check(),h=t.findInArray(this.dataProperties,n,"name"),h)throw t.createError(r.dataPropertyAlreadyExists,[n],{entityType:this,existing:h});if(f.isNotEmptyString(u)&&(u=e.dataTypes.byName(u)),t.assertPrm(u,"dataType").isInstanceOf(e.dataTypes.baseType).check(),s!=null&&!u.isValid(s))throw t.createError(r.invalidDefaultValue,[s,u.name],{entityType:this,dataType:u,defaultValue:s});c=new l.DataProperty(this,n,i,u,o===!0,!1,null,s);this.dataProperties.push(c)},n.addValidation=function(n,i,r,u){t.assertPrm(n,"name").isNotEmptyString().check();t.assertPrm(i,"func").isFunction().check();this.validators.push(new e.Validator(n,i,r,u))},n.validate=function(n){var i=[];return this.validators.length>0&&t.forEach(this.validators,function(r){var u=r.validate(n);u&&i.push(t.createValidationError(n,null,null,u,r))}),t.forEach(this.dataProperties,function(t){var r=t.validate(n);r&&(i=i.concat(r))}),t.forEach(this.navigationProperties,function(t){var r=t.validate(n);r&&(i=i.concat(r))}),i},i}(),MetadataManager:function(){var i=function(n){this.types=[];this.enums={};this.name=null;this.displayName=null;n&&this.parseBeetleMetadata(n)},n=i.prototype;return n.toString=function(){return this.types.join(", ")},n.getEntityType=function(n,i){var u=t.findInArray(this.types,n,"name");if(!u&&i===!0)throw t.createError(r.notFoundInMetadata,[n],{metadataManager:this,typeName:n});return u},n.getEntityTypeByShortName=function(n,i){var u=t.findInArray(this.types,n,"shortName");if(!u&&i===!0)throw t.createError(r.notFoundInMetadata,[n],{metadataManager:this,typeShortName:n});return u},n.createQuery=function(n,i,r){if(i)return this.getEntityTypeByShortName(i,!0).createQuery(n,r);var u=t.filterArray(this.types,function(t){return t.setName==n});return u.length==1?u[0].createQuery(n,r):new o.EntityQuery(n,null,r)},n.registerCtor=function(n,t,i){var r=this.getEntityTypeByShortName(n,!0);r.registerCtor(t,i)},n.createEntity=function(n,t){var i=this.getEntityTypeByShortName(n,!0);return i.createEntity(t)},n.createRawEntity=function(n,t){var i=this.getEntityTypeByShortName(n,!0);return i.createRawEntity(t)},n.parseBeetleMetadata=function(n){var o,a,s,r,v,y,p,w,c,i,f,b,k;if(this.types=[],this.enums={},this.name=n.n,this.displayName=t.getResourceValue(n.r,n.l||n.n),o=n.e,a={},o)for(s=0;s<o.length;s++)r=o[s],v={},t.forEach(r.m,function(n){v[n.n]={name:n.n,value:n.v,displayName:t.getResourceValue(n.r,n.l||n.n)}}),y=new h.Enum(v),this.enums[r.n]=y,a[r.n]=new e.dataTypes.enum(y,r.n,t.getResourceValue(r.r,r.l||r.n));for(p=this,w=n.m,c=0;c<w.length;c++)i=w[c],f=new l.EntityType(i.n,t.getResourceValue(i.rn,i.s),i.s,i.k,i.b,i.q,i.t,i.c,this),t.forEach(i.d,function(n){var o,s,r;o=n.e?a[n.t]:e.dataTypes.byName(n.t);s=t.getResourceValue(n.r,n.l||n.n);r=new l.DataProperty(f,n.n,s,o,n.i===!0,i.k&&t.findInArray(i.k,n.n)!=null,n.g?n.g=="I"?u.generationPattern.Identity:u.generationPattern.Computed:null,n.d?o.handle(n.d):null,n.c);n.v&&t.forEach(n.v,function(t){r.validators.push(e.Validator.byCode(t.t,t.a,t.m,t.r,r.displayName,n.r))});n.p&&(r.precision=Number(n.p));n.s&&(r.scale=Number(n.s));f.dataProperties.push(r)}),b=i.r,b&&t.forEach(b,function(n){var i=new l.NavigationProperty(f,n.n,t.getResourceValue(n.r,n.l||n.n),n.t,n.s===!0,n.a,n.c);n.f&&t.forEach(n.f,function(n){i.foreignKeyNames.push(n)});n.v&&t.forEach(n.v,function(t){i.validators.push(e.Validator.byCode(t.t,t.a,t.m,t.r,i.displayName,n.r))});f.navigationProperties.push(i)}),k=i.x,k&&t.forEach(k,function(n){var i=new l.NavigationProperty(f,n.n,t.getResourceValue(n.r,n.l||n.n),n.t,!0);f.navigationProperties.push(i)}),this.types.push(f);t.forEach(this.types,function(n){n.baseTypeName&&(n.baseType=p.getEntityTypeByShortName(n.baseTypeName,!0));delete n.baseTypeName});t.forEach(this.types,function(n){for(var i=n.baseType;i;)n.floorType=i,t.forEach(i.dataProperties,function(i){t.findInArray(n.dataProperties,i)||n.dataProperties.push(i)}),t.forEach(i.navigationProperties,function(i){t.findInArray(n.navigationProperties,i)||n.navigationProperties.push(i)}),i=i.baseType;t.forEach(n.navigationProperties,function(i){var r,u;if(!i.entityType)for(i.entityType=p.getEntityTypeByShortName(i.entityTypeName,!0),r=0;r<i.entityType.navigationProperties.length;r++)if(u=i.entityType.navigationProperties[r],u.associationName===i.associationName&&i!==u){i.inverse=u;break}t.forEach(i.foreignKeyNames,function(r){if(!t.findInArray(i.foreignKeys,r,"name")){var u=t.findInArray(n.dataProperties,r,"name");u.relatedNavigationProperties.push(i);i.foreignKeys.push(u)}})});t.forEach(n.keyNames,function(i){n.keys.push(t.findInArray(n.dataProperties,i,"name"))})})},i}()}}(),o=function(){return{expressions:function(){return{OfTypeExp:function(){var r=function(n){i.ExpressionBase.call(this,"oftype",-1,!0,!0);this.typeName=n},n;return t.inherit(r,i.ExpressionBase),n=r.prototype,n.combine=function(n){this.typeName=n},n.toBeetleQuery=function(){return this.typeName},n.clone=function(){return new r(this.typeName)},n.execute=function(n){var i=this;return t.filterArray(n,function(n){return n&&(n.$tracker&&n.$tracker.entityType.isAssignableTo(i.typeName)||typeof n===i.typeName)})},r}(),WhereExp:function(){function c(n,t,i){var r=new v(t);n.length>0&&a(n,t,r);i.currentGroup?i.currentGroup.filterItems.push(r):i.groups.push(r);i.currentGroup=r;i.openGroups.push(r)}function a(n,i,o){var h,p,v,a,y,c,w;if(n.length==3||n.length==4){if(h=n[1],f.isTypeOf(h,"string"))for(h=h.toLowerCase(),p=u.filterOps.symbols(),v=0;v<p.length;v++)if(a=p[v],a.oData==h||a.code==h||a.name==h){h=a;break}t.assertPrm(h,"filterOperation").isEnum(u.filterOps).check();y=n[0];c=n[2];e.dataTypes.date.isValid(c)?c='"'+s.getDateConverter().toISOString(c)+'"':!f.isTypeOf(c,"string")||n.length==4&&c[0]=="@"||(c='"'+c+'"');w=h.isFunc?h===u.filterOps.Contains?"substringof("+c+", "+y+")":h.code+"("+y+", "+c+")":y+h.code+c;o.filterItems.push(new l(w,i,n[3]));return}if(n.length==1||n.length==2)o.filterItems.push(new l(n[0],i,n[1]));else throw t.createError(r.argCountMismatch,["where"],{args:n});}var l=function(){var i=function(n,t,i){this.expStr=n;this.exp=h.jsep(n);this.isOr=t===!0;this.varContext=i},n=i.prototype;return n.toString=function(){return this.exp.toString()},n.toODataQuery=function(n){n=n||{};n.expVarContext=this.varContext;var i=t.jsepToODataQuery(this.exp,n);return n.expVarContext=undefined,i},n.toBeetleQuery=function(n){n=n||{};n.expVarContext=this.varContext;var i=t.jsepToBeetleQuery(this.exp,n);return n.expVarContext=undefined,i},n.clone=function(){return new l(this.expStr,this.isOr,this.varContext)},n.toFunction=function(n){var i=this;return function(r){n=n||{};n.expVarContext=i.varContext;var u=t.jsepToFunction(i.exp,n)(r);return n.expVarContext=undefined,u}},i}(),v=function(){var i=function(n){this.isOr=n===!0;this.filterItems=[]},n=i.prototype;return n.toString=function(){var n=[],i=null;return t.forEach(this.filterItems,function(t){i!=null&&n.push(i.isOr?" or ":" and ");n.push(t.toString());i=t}),n.join("")},n.toODataQuery=function(n){var i="";return t.forEach(this.filterItems,function(t){var r=t.toODataQuery(n);i?i+=(t.isOr?" or ":" and ")+r:i=r}),"("+i+")"},n.toBeetleQuery=function(n){var i="";return t.forEach(this.filterItems,function(t){var r=t.toBeetleQuery(n);i?i+=(t.isOr?" or ":" and ")+r:i=r}),"("+i+")"},n.clone=function(n){var i=new v(this.isOr);return t.forEach(this.filterItems,function(t){i.filterItems.push(t.clone(n))}),n&&n.push({o:this,n:i}),i},n.toFunction=function(n){var t=this;return function(i){for(var u,r=null,f=0;f<t.filterItems.length;f++)u=t.filterItems[f],r=u.isOr?(r==null?!1:r)||u.toFunction(n)(i):(r==null?!0:r)&&u.toFunction(n)(i);return r}},i}(),o=function(n){i.ExpressionBase.call(this,"filter",2,!1,!1);this.currentGroup=null;this.groups=[];this.openGroups=[];n&&this.andGroup.apply(this,n)},n;return t.inherit(o,i.ExpressionBase),n=o.prototype,n.and=function(n){return this.currentGroup?a(n,!1,this.currentGroup):c(n,!1,this),this},n.or=function(n){return this.currentGroup?a(n,!0,this.currentGroup):c(n,!0,this),this},n.andGroup=function(){return c(arguments,!1,this),this},n.orGroup=function(){return c(arguments,!0,this),this},n.closeGroup=function(){var n=this.openGroups.pop();if(!n)throw t.createError(r.noOpenGroup,{expression:this});return this.currentGroup=this.openGroups[this.openGroups.length-1],this},n.combine=function(n){this.and(n)},n.toODataQuery=function(n){var i=null;return t.forEach(this.groups,function(t){var r=t.toODataQuery(n);i?i+=(t.isOr?" or ":" and ")+r:i=r}),i},n.toBeetleQuery=function(n){var i=null;return t.forEach(this.groups,function(t){var r=t.toBeetleQuery(n);i?i+=(t.isOr?" or ":" and ")+r:i=r}),i},n.clone=function(){var n=new o,i=[];return t.forEach(this.groups,function(t){n.groups.push(t.clone(i))}),t.forEach(this.openGroups,function(r){n.openGroups.push(t.findInArray(i,r,"o").n)}),this.currentGroup&&(n.currentGroup=t.findInArray(i,this.currentGroup,"o").n),n},n.execute=function(n,t){return o.execute(n,this.groups,t)},o.execute=function(n,i,r){var u=function(n){for(var u,t=null,f=0;f<i.length;f++)u=i[f],t=u.isOr?(t==null?!1:t)||u.toFunction(r)(n):(t==null?!0:t)&&u.toFunction(r)(n);return t};return t.filterArray(n,u)},o}(),OrderByExp:function(){var u="x => x",n=function(n,t){i.ExpressionBase.call(this,"orderby",1,!1,!1);n=n||u;t===!0&&(n+=" desc");this.expStr=n;this.exp=h.jsep(n)},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.combine=function(n,i){t.assertPrm(n,"expStr").isNotEmptyString().check();n=n||u;i===!0&&(n+=" desc");this.expStr+=", "+n;this.exp=h.jsep(this.expStr)},r.toODataQuery=function(n){return t.jsepToODataQuery(this.exp,n)},r.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){for(var h,l,f,e=[],o=i.type=="Compound"?i.body:[i],u=0;u<o.length;u++){var c=!1,a=o[u],s=o[u+1];s&&s.type=="Identifier"&&(h=s.name.toLowerCase(),h=="desc"?(c=!0,u++):h=="asc"&&u++);l=function(n,i){return function(u,f){var e=t.jsepToFunction(n,r),o=e(u),s=e(f);return o==s?0:o>s?i?-1:1:i?1:-1}}(a,c);e.push(l)}return f=[],f.push.apply(f,n),f.sort(function(n,t){for(var r,i=0;i<e.length;i++)if(r=e[i](n,t),r!=0)return r;return 0})},n}(),ExpandExp:function(){var r=function(n){i.ExpressionBase.call(this,"expand",1,!1,!1);this.expStr=n;this.exp=h.jsep(n)},n;return t.inherit(r,i.ExpressionBase),n=r.prototype,n.combine=function(n){this.expStr+=", "+n;this.exp=h.jsep(this.expStr)},n.toODataQuery=function(n){return t.jsepToODataQuery(this.exp,n)},n.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},n.clone=function(){return new r(this.expStr)},n.execute=function(n){return n},r}(),SelectExp:function(){var n=function(n){i.ExpressionBase.call(this,"select",2,!1,!0);this.expStr=n;this.exp=h.jsep(n)},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.combine=function(n){this.expStr+=", "+n;this.exp=h.jsep(this.expStr)},r.toODataQuery=function(n){return t.jsepToODataQuery(this.exp,n)},r.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var u;if(n.length==0)return n;var e=i.type=="Compound"?i.body:[i],o=t.jsepToProjector(e,r),f=[];for(u=0;u<n.length;u++)f.push(o(n[u]));return f},n}(),SkipExp:function(){var r=function(n){i.ExpressionBase.call(this,"skip",2,!1,!1);this.count=n},n;return t.inherit(r,i.ExpressionBase),n=r.prototype,n.combine=function(n){n<this.count&&(this.count=n)},n.toODataQuery=function(){return this.count},n.toBeetleQuery=function(){return this.count},n.clone=function(){return new r(this.count)},n.execute=function(n){return n.slice(this.count)},r}(),TopExp:function(){var r=function(n){i.ExpressionBase.call(this,"top",2,!1,!1);this.count=n},n;return t.inherit(r,i.ExpressionBase),n=r.prototype,n.combine=function(n){n<this.count&&(this.count=n)},n.toODataQuery=function(){return this.count},n.toBeetleQuery=function(){return this.count},n.clone=function(){return new r(this.count)},n.execute=function(n){return n.slice(0,this.count)},r}(),GroupByExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"groupby",3,!0,!0);this.keySelectorStr=n;this.elementSelectorStr=t;this.keySelectorExp=null;n&&(this.keySelectorExp=h.jsep(n));this.elementSelectorExp=null;t&&(this.elementSelectorExp=h.jsep(t))},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){var i="";return this.keySelectorExp&&(i+=t.jsepToBeetleQuery(this.keySelectorExp,n)),this.elementSelectorExp&&(i+=";"+t.jsepToBeetleQuery(this.elementSelectorExp,n)),i},r.clone=function(){return new n(this.keySelectorStr,this.elementSelectorStr)},r.execute=function(t,i){return n.execute(t,this.keySelectorExp,this.elementSelectorExp,i)},n.execute=function(n,i,r,u){var f=[],c,s,e,l,h,a,v,y;if(i)for(c=o.expressions.SelectExp.execute(n,i,u),s=0;s<c.length;s++){for(e=null,l=c[s],h=0;h<f.length;h++)if(a=f[h],t.objEquals(a.Key,l)){e=a;break}e||(e={Key:l,Items:[]},f.push(e));e.Items.push(n[s])}else f.push({Key:null,Items:n});return r&&(v=r.type=="Compound"?r.body:[r],y=t.jsepToProjector(v,u),t.forEach(f,function(n,t){var r=n.Items,i;r.Key=n.Key;i=y(n.Items);f[t]=i})),f},n}(),DistinctExp:function(){function u(n){var i=[];return t.forEach(n,function(n){for(var u=!1,r=0;r<i.length;r++)if(t.objEquals(i[r],n)){u=!0;break}u===!1&&i.push(n)}),i}var n=function(n){i.ExpressionBase.call(this,"distinct",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n))},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,t,i){return t&&(n=o.expressions.SelectExp.execute(n,t,i)),u(n)},n}(),ReverseExp:function(){var n=function(){i.ExpressionBase.call(this,"reverse",3,!0,!1)},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(){return""},r.clone=function(){return new n},r.execute=function(t){return n.execute(t)},n.execute=function(n){return n.reverse()},n}(),SelectManyExp:function(){var n=function(n){i.ExpressionBase.call(this,"selectMany",3,!0,!0);this.expStr=n;this.exp=h.jsep(n)},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var e,u,f,o;if(n.length==0)return n;for(e=t.jsepToFunction(i,r),u=[],f=0;f<n.length;f++)o=e(n[f]),u=u.concat.apply(u,o);return u},n}(),SkipWhileExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"skipWhile",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){for(var f=t.jsepToFunction(i,r),u=0;f(n[u])==!0;)u++;return n.slice(u+1)},n}(),TakeWhileExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"takeWhile",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){for(var f=t.jsepToFunction(i,r),u=0;f(n[u])==!0;)u++;return n.slice(0,u)},n}(),AllExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;all",3,!0,!0);this.expStr=n;this.exp=h.jsep(n);this.varContext=t;this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return t.jsepToBeetleQuery(this.exp,n)},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var u=t.jsepToFunction(i,r);return o.queryFuncs.all.impl(n,function(){return n},u)},n}(),AnyExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;any",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){if(i){var u=t.jsepToFunction(i,r);return o.queryFuncs.any.impl(n,function(){return n},u)}return n.length>0},n}(),AvgExp:function(){var n=function(n){i.ExpressionBase.call(this,"exec;avg",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n));this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var u=i?t.jsepToFunction(i,r):function(n){return n};return o.queryFuncs.avg.impl(n,function(){return n},u)},n}(),MaxExp:function(){var n=function(n){i.ExpressionBase.call(this,"exec;max",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n));this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var u=i?t.jsepToFunction(i,r):function(n){return n};return o.queryFuncs.max.impl(n,function(){return n},u)},n}(),MinExp:function(){var n=function(n){i.ExpressionBase.call(this,"exec;min",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n));this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var u=i?t.jsepToFunction(i,r):function(n){return n};return o.queryFuncs.min.impl(n,function(){return n},u)},n}(),SumExp:function(){var n=function(n){i.ExpressionBase.call(this,"exec;sum",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n));this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){var u=i?t.jsepToFunction(i,r):function(n){return n};return o.queryFuncs.sum.impl(n,function(){return n},u)},n}(),CountExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;count",3,!0,!0);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){return i&&(n=t.filterArray(n,t.jsepToFunction(i,r))),n.length},n}(),FirstExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;first",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},u;return t.inherit(n,i.ExpressionBase),u=n.prototype,u.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},u.clone=function(){return new n(this.expStr,this.varContext)},u.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,u){if(i&&(n=t.filterArray(n,t.jsepToFunction(i,u))),n.length==0)throw t.createError(r.arrayEmpty,{array:n,expression:this});return n[0]},n}(),FirstOrDefaultExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;firstOD",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){return i&&(n=t.filterArray(n,t.jsepToFunction(i,r))),n.length==0?null:n[0]},n}(),SingleExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;single",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},u;return t.inherit(n,i.ExpressionBase),u=n.prototype,u.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},u.clone=function(){return new n(this.expStr,this.varContext)},u.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,u){if(i&&(n=t.filterArray(n,t.jsepToFunction(i,u))),n.length!=1)throw t.createError(r.arrayNotSingle,{array:n,expression:this});return n[0]},n}(),SingleOrDefaultExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;singleOD",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},u;return t.inherit(n,i.ExpressionBase),u=n.prototype,u.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},u.clone=function(){return new n(this.expStr,this.varContext)},u.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,u){if(i&&(n=t.filterArray(n,t.jsepToFunction(i,u))),n.length>1)throw t.createError(r.arrayNotSingleOrEmpty,{array:n,expression:this});return n.length==0?null:n[0]},n}(),LastExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;last",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},u;return t.inherit(n,i.ExpressionBase),u=n.prototype,u.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},u.clone=function(){return new n(this.expStr,this.varContext)},u.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,u){if(i&&(n=t.filterArray(n,t.jsepToFunction(i,u))),n.length==0)throw t.createError(r.arrayEmpty,{array:n,expression:this});return n[n.length-1]},n}(),LastOrDefaultExp:function(){var n=function(n,t){i.ExpressionBase.call(this,"exec;lastOD",3,!0,!1);this.expStr=n;n&&(this.exp=h.jsep(n));this.varContext=t;this.isExecuter=!0},r;return t.inherit(n,i.ExpressionBase),r=n.prototype,r.toBeetleQuery=function(n){return this.exp?t.jsepToBeetleQuery(this.exp,n):""},r.clone=function(){return new n(this.expStr,this.varContext)},r.execute=function(t,i){return n.execute(t,this.exp,i)},n.execute=function(n,i,r){return i&&(n=t.filterArray(n,t.jsepToFunction(i,r))),n.length==0?null:n[n.length-1]},n}()}}(),queryFuncs:function(){var n={};return n.toupper=function(){var n=function(){i.QueryFuncBase.call(this,"toupper","ToUpper",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,t){return(t?t(n):n).toUpperCase()},new n}(),n.tolower=function(){var n=function(){i.QueryFuncBase.call(this,"tolower","ToLower",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,t){return(t?t(n):n).toLowerCase()},new n}(),n.substring=function(){var n=function(){i.QueryFuncBase.call(this,"substring","Substring",3)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,t,i,r){arguments.length==3?(r=i,i=t,t=n):t=t(n);i=i(n);r=r(n);var u=Number(i)+Number(r);return t&&t.substring(i,u)},new n}(),n.substringof=function(){var n=function(){i.QueryFuncBase.call(this,"substringof","Contains",2)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n,t){return t=t?t+".":"",t+"Contains("+n+")"},r.impl=function(n,i,r){return r=r?r(n):n,r=t.handleStrOptions(r,this.varContext),i=t.handleStrOptions(i(n),this.varContext),r&&r.indexOf(i)>=0},new n}(),n.length=function(){var n=function(){i.QueryFuncBase.call(this,"length","Length",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Length"},r.impl=function(n,t){return(t?t(n):n).length},new n}(),n.trim=function(){var n=function(){i.QueryFuncBase.call(this,"trim","Trim",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,t){return(t?t(n):n).trim()},new n}(),n.concat=function(){var n=function(){i.QueryFuncBase.call(this,"concat","Concat",null)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(){return"string.Concat("+Array.prototype.slice.call(arguments).join(", ")+")"},r.impl=function(n){for(var i=arguments[1](n).toString(),r=Array.prototype.slice.call(arguments,2),u=[],t=0;t<r.length;t++)u.push(r[t](n));return i.concat.apply(i,u)},new n}(),n.replace=function(){var n=function(){i.QueryFuncBase.call(this,"replace","Replace",3)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,i,r,u){return arguments.length==3?(u=r,r=i,i=n):i=i(n),r=r(n),t.ignoreWhiteSpaces(this.varContext)&&(r=r.trim()),t.isCaseSensitive(this.varContext)||(r=new RegExp(r,"gi")),i.replace(r,u(n))},new n}(),n.startswith=function(){var n=function(){i.QueryFuncBase.call(this,"startswith","StartsWith",2)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,i,r){return arguments.length==2?(r=i,i=n):i=i(n),i=t.handleStrOptions(i,this.varContext),r=t.handleStrOptions(r(n),this.varContext),i&&i.indexOf(r,0)===0},new n}(),n.endswith=function(){var n=function(){i.QueryFuncBase.call(this,"endswith","EndsWith",2)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,i,r){arguments.length==2?(r=i,i=n):i=i(n);i=t.handleStrOptions(i,this.varContext);r=t.handleStrOptions(r(n),this.varContext);var u=i.length-r.length;return i&&i.indexOf(r,u)!==-1},new n}(),n.indexof=function(){var n=function(){i.QueryFuncBase.call(this,"indexof","IndexOf",2)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.impl=function(n,i,r){return arguments.length==2?(r=i,i=n):i=i(n),i=t.handleStrOptions(i,this.varContext),r=t.handleStrOptions(r(n),this.varContext),i&&i.indexOf(r)},new n}(),n.contains=function(){var u=function(){i.QueryFuncBase.call(this,"contains","Contains",2)},r;return t.inherit(u,i.QueryFuncBase),r=u.prototype,r.toODataFunction=function(i,r){if(f.isTypeOf(i,"string"))return n.substringof.toODataFunction(r,i);var u=[];return t.forEach(i,function(n){u.push(r+" eq "+e.dataTypes.toODataValue(n))}),"("+u.join(" or ")+")"},r.toBeetleFunction=function(i,r){if(f.isTypeOf(i,"string"))return n.substringof.toBeetleFunction(r,i);var u=[];return t.forEach(i,function(n){u.push(r+" == "+e.dataTypes.toBeetleValue(n))}),"("+u.join(" || ")+")"},r.impl=function(n,i,r){var u,e;if(arguments.length==1?i=n:arguments.length==2?(r=i,i=n):i=i(n),r=r?r(n):n,f.isArray(i)){for(u=0;u<i.length;u++)if(e=i[u],e==r)return!0;return!1}return i=t.handleStrOptions(i,this.varContext),r=t.handleStrOptions(r,this.varContext),i&&i.indexOf(r)>=0},new u}(),n.round=function(){var n=function(){i.QueryFuncBase.call(this,"round","Math.Round",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return"Math.Round("+n+")"},r.impl=function(n,t){return Math.round(t?t(n):n)},new n}(),n.ceiling=function(){var n=function(){i.QueryFuncBase.call(this,"ceiling","Math.Ceiling(%1)",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return"Math.Ceiling("+n+")"},r.impl=function(n,t){return Math.ceil(t?t(n):n)},new n}(),n.floor=function(){var n=function(){i.QueryFuncBase.call(this,"floor","Math.Floor",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return"Math.Floor("+n+")"},r.impl=function(n,t){return Math.floor(t?t(n):n)},new n}(),n.second=function(){var n=function(){i.QueryFuncBase.call(this,"second","Second",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Second"},r.impl=function(n,t){return t=e.dataTypes.date.handle(t?t(n):n),t.getSeconds()},new n}(),n.minute=function(){var n=function(){i.QueryFuncBase.call(this,"minute","Minute",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Minute"},r.impl=function(n,t){return t=e.dataTypes.date.handle(t?t(n):n),t.getMinutes()},new n}(),n.hour=function(){var n=function(){i.QueryFuncBase.call(this,"hour","Hour",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Hour"},r.impl=function(n,t){return t=e.dataTypes.date.handle(t?t(n):n),t.getHours()},new n}(),n.day=function(){var n=function(){i.QueryFuncBase.call(this,"day","Day",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Day"},r.impl=function(n,t){return t=e.dataTypes.date.handle(t?t(n):n),t.getDate()},new n}(),n.month=function(){var n=function(){i.QueryFuncBase.call(this,"month","Month",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Month"},r.impl=function(n,t){return t=e.dataTypes.date.handle(t?t(n):n),t.getMonth()+1},new n}(),n.year=function(){var n=function(){i.QueryFuncBase.call(this,"year","Year",1)},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toBeetleFunction=function(n){return n=n?n+".":"",n+"Year"},r.impl=function(n,t){return t=e.dataTypes.date.handle(t?t(n):n),t.getFullYear()},new n}(),n.max=function(){var n=function(){i.QueryFuncBase.call(this,"max","Max",2)},u;return t.inherit(n,i.QueryFuncBase),u=n.prototype,u.toODataFunction=function(){throw t.createError(r.functionNotSupportedForOData,["Max"]);},u.impl=function(n,t,i){var u,r,f;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),t.length==0)return null;for(u=i?i(t[0]):t[0],r=1;r<t.length;r++)f=i?i(t[r]):t[r],f>u&&(u=f);return u},new n}(),n.min=function(){var n=function(){i.QueryFuncBase.call(this,"min","Min",2)},u;return t.inherit(n,i.QueryFuncBase),u=n.prototype,u.toODataFunction=function(){throw t.createError(r.functionNotSupportedForOData,["Min"]);},u.impl=function(n,t,i){var u,r,f;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),t.length==0)return null;for(u=i?i(t[0]):t[0],r=1;r<t.length;r++)f=i?i(t[r]):t[r],f<u&&(u=f);return u},new n}(),n.sum=function(){var n=function(){i.QueryFuncBase.call(this,"sum","Sum",2)},u;return t.inherit(n,i.QueryFuncBase),u=n.prototype,u.toODataFunction=function(){throw t.createError(r.functionNotSupportedForOData,["Sum"]);},u.impl=function(n,t,i){var u,r,f;for(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),u=0,r=0;r<t.length;r++)f=t[r],u+=i?i(f):f;return u},new n}(),n.count=function(){var n=function(){i.QueryFuncBase.call(this,"count","Count",1)},u;return t.inherit(n,i.QueryFuncBase),u=n.prototype,u.toODataFunction=function(){throw t.createError(r.functionNotSupportedForOData,["Count"]);},u.impl=function(n,t){return(t?t(n):n).length},new n}(),n.avg=function(){var u=function(){i.QueryFuncBase.call(this,"avg","Average",2)},f;return t.inherit(u,i.QueryFuncBase),f=u.prototype,f.toODataFunction=function(){throw t.createError(r.functionNotSupportedForOData,["Avg"]);},f.impl=function(t,i,r){return(arguments.length==1?i=t:arguments.length==2?(r=i,i=t):i=i(t),i.length==0)?null:n.sum.impl(t,function(){return i},r)/i.length},new u}(),n.any=function(){var n=function(){i.QueryFuncBase.call(this,"any","Any",2);this.needsAlias=!0},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toODataFunction=function(n,t,i){return t+"/any("+n+": "+i+")"},r.impl=function(n,t,i){var r,u;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),!i)return t.length>0;for(r=0;r<t.length;r++)if(u=t[r],i(u)===!0)return!0;return!1},new n}(),n.all=function(){var n=function(){i.QueryFuncBase.call(this,"all","All",2);this.needsAlias=!0},r;return t.inherit(n,i.QueryFuncBase),r=n.prototype,r.toODataFunction=function(n,t,i){return t+"/all("+n+": "+i+")"},r.impl=function(n,t,i){var r,u;for(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),r=0;r<t.length;r++)if(u=t[r],i(u)!==!0)return!1;return!0},new n}(),n.getFunc=function(i,u){var f=n[i.toLowerCase()];if(f==null&&u!==!1)throw t.createError(r.unknownFunction,[i]);return f},n}(),ArrayQuery:function(){var r,n;return Array.prototype.asQueryable=function(){return new o.ArrayQuery(this)},Array.hasOwnProperty("q")||(Array.prototype.q=function(){return this.asQueryable()}),r=function(n){this.array=n;i.QueryBase.call(this)},t.inherit(r,i.QueryBase),n=r.prototype,n.executeAfterExecuter=!0,n.execute=function(n){return this.options&&(n=t.combine(this.options.varContext,n)),this.toFunction()(this.array,n)},n.clone=function(){var n=new o.ArrayQuery(this.array);return this.copy(n),n},n.copy=function(n){i.QueryBase.prototype.copy.call(this,n)},r}(),EntityQuery:function(){function e(n,i){if(n==null)return null;if(f.isTypeOf(n,"string")){if(i==null)throw t.createError(r.onlyManagerCreatedCanAcceptEntityShortName);return i.getEntityType(n,!0)}return t.assertPrm(n,"type").isInstanceOf(l.EntityType).check(),n}var u=function(n,t,r){this.resource=n;this.entityType=e(t,r);this.manager=r;this.liveValidate=r&&r.liveValidate;this.parameters=[];i.QueryBase.call(this)},n;return t.inherit(u,i.QueryBase),n=u.prototype,n.toString=function(){var n=[];return n.push("resource: ("+this.resource+")"),this.entityType&&n.push("entityType: ("+this.entityType.shortName+")"),this.manager&&n.push("manager: ("+this.manager.toString()+")"),n.push(i.QueryBase.prototype.toString.call(this)),n.join(", ")},n.expand=function(n){var t=this.clone(),i=t.getExpression(o.expressions.ExpandExp);return i?i.combine(n):t.addExpression(new o.expressions.ExpandExp(n)),t},n.include=function(){return this.expand.apply(this,arguments)},n.setParameter=function(n,i){var r=this.clone(),u=t.findInArray(r.parameters,n,"name");return u?u.value=i:r.parameters.push({name:n,value:i}),r},n.setEntityType=function(n){n=e(n,this.manager);var t=this.clone();return t.entityType=n,t},n.execute=function(n,i,u){if(!this.manager)throw t.createError(r.onlyManagerCreatedCanBeExecuted,{query:this,options:n});return this.manager.executeQuery(this,n,i,u)},n.executeLocally=function(n){if(!this.manager)throw t.createError(r.onlyManagerCreatedCanBeExecuted,{query:this,options:options});return this.manager.executeQueryLocally(this,n)},n.clone=function(){var n=new o.EntityQuery(this.resource,this.entityType,this.manager);return this.copy(n),n},n.copy=function(n){i.QueryBase.prototype.copy.call(this,n);t.forEach(this.parameters,function(t){n.parameters.push(t)})},u}()}}(),e=function(){return{ValueNotifyWrapper:function(){return function(n,i){this.value=n;this.fromBeetle=i===!0;t.tryFreeze(this)}}(),TrackableArray:function(){function u(n,i){n&&t.forEach(n,function(n){Array.prototype.push.call(i,n)})}function r(n,i){var o=i.object,r=i.property,u;r&&(o.$tracker&&o.$tracker.manager&&(u=o.$tracker.manager.handleUnmappedProperties),u==null&&(u=s.handleUnmappedProperties),f.isInstanceOf(r,l.NavigationProperty)?t.forEach(n,function(n){r.checkAssign(n)}):f.isInstanceOf(r,l.DataProperty)?t.forEach(n,function(t,i){n[i]=r.handle(t)}):u===!0&&t.forEach(n,function(t,i){n[i]=e.dataTypes.handle(t)}))}var i=function(n,t,i,r){this.object=t;this.property=i;this.after=r;this.changing=new e.Event(i+"ArrayChanging",this);this.changed=new e.Event(i+"ArrayChanged",this);u(n,this)},n;return t.inherit(i,Array),n=i.prototype,n.pop=function(){var n=[this[this.length-1]],t;return this.changing.notify({added:[],removed:n}),t=Array.prototype.pop.call(this),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),t},n.push=function(){this.changing.notify({added:arguments,removed:[]});r(arguments,this);var n=Array.prototype.push.apply(this,arguments);return this.after(this.object,this.property,this,null,arguments),this.changed.notify({added:arguments,removed:[]}),n},n.unshift=function(){this.changing.notify({added:arguments,removed:[]});r(arguments,this);var n=Array.prototype.unshift.apply(this,arguments);return this.after(this.object,this.property,this,null,arguments),this.changed.notify({added:arguments,removed:[]}),n},n.shift=function(){var n=[this[0]],t;return this.changing.notify({added:[],removed:n}),t=Array.prototype.shift.call(this),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),t},n.splice=function(n,t){var i,u,f;return t=t||this.length,i=null,arguments.length>2&&(i=Array.prototype.slice.call(arguments).slice(2)),u=this.slice(n,n+t),this.changing.notify({added:i,removed:u}),i&&r(i,this),f=Array.prototype.splice.apply(this,arguments),this.after(this.object,this.property,this,u,i),this.changed.notify({added:i,removed:u}),f},n.remove=function(){var n=[],i=this;return this.changing.notify({added:[],removed:arguments}),t.forEach(arguments,function(r){var u=t.indexOf(i,r);u>=0&&(Array.prototype.splice.call(i,u,1),n.push(r))}),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:arguments}),n},n.load=function(n,t,i,r,u){return this.object.$tracker.loadNavigationProperty(this.propertyName,n,t,i,r,u)},i}(),Event:function(){var i=function(n,t){this.name=n;this.subscribers=[];this.publisher=t},n=i.prototype;return n.toString=function(){return this.name},n.subscribe=function(n){t.findInArray(this.subscribers,n)||this.subscribers.push(n)},n.unsubscribe=function(n){t.removeFromArray(this.subscribers,n)},n.notify=function(){var n=arguments;t.forEach(this.subscribers,function(t){t.apply(t,n)})},i}(),dataTypes:function(){function u(n,i){throw t.createError(r.assignError,[n.name,i],{dataType:n,value:i});}var e=function(){var r=function(n){i.DataTypeBase.call(this,"dateBase");this.name=n},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return new Date(-6847812e6)},n.isValid=function(n){return Object.prototype.toString.call(n)==="[object Date]"},n.handle=function(n){if(!this.isValid(n)){var t=n;n=this.tryParse(t);n||u(this,t)}return n},n.autoValue=function(){return new Date},n.getRawValue=function(n){return n==null?null:s.getDateConverter().toISOString(n)},n.tryParse=function(n){return s.getDateConverter().parse(n)},n.toODataValue=function(n){return n=this.handle(n),"datetime'"+s.getDateConverter().toISOString(n)+"'"},n.toBeetleValue=function(n){return n=this.handle(n),'"'+s.getDateConverter().toISOString(n)+'"'},r}(),n={};return n.object=function(){var n=function(){i.DataTypeBase.call(this,"object");t.tryFreeze(this)};return t.inherit(n,i.DataTypeBase),new n}(),n.array=function(){var u=function(){i.DataTypeBase.call(this,"array");t.tryFreeze(this)},n;return t.inherit(u,i.DataTypeBase),n=u.prototype,n.isValid=function(n){return n instanceof Array},n.defaultValue=function(){return[]},n.handle=function(n){return this.isValid(n)||(n=n.split(",")),n},n.autoValue=function(){throw t.createError(r.notImplemented,[this.name,"defaultValue"]);},n.toODataValue=function(n){return n},n.toBeetleValue=function(n){return n},new u}(),n.function=function(){var n=function(){i.DataTypeBase.call(this,"function");t.tryFreeze(this)};return t.inherit(n,i.DataTypeBase),new n}(),n.string=function(){var u=0,r=function(){i.DataTypeBase.call(this,"string");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return""},n.handle=function(n){return this.isValid(n)||(n=n.toString()),n},n.autoValue=function(){return"key_"+--u},n.toODataValue=function(n){return"'"+n.replace(/'/g,"''")+"'"},n.toBeetleValue=function(n){return'"'+n.replace(/"/g,'""')+'"'},new r}(),n.guid=function(){var r=function(){i.DataTypeBase.call(this,"guid");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return"00000000-0000-0000-0000-000000000000"},n.isValid=function(n){return typeof n=="string"&&n.match(/^\{?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\}?$/i)},n.handle=function(n){return this.isValid(n)||u(this,n),n},n.autoValue=function(){return t.createGuid()},n.toODataValue=function(n){return"guid'"+n+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new r}(),n.date=function(){var n=function(){e.call(this,"date");t.tryFreeze(this)};return t.inherit(n,e),new n}(),n.dateTimeOffset=function(){var n=function(){e.call(this,"dateTimeOffset");t.tryFreeze(this)},i;return t.inherit(n,e),i=n.prototype,i.toODataValue=function(n){return n=this.handle(n),"datetimeoffset'"+s.getDateConverter().toISOString(n)+"'"},new n}(),n.time=function(){var r=function(){i.DataTypeBase.call(this,"time");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return"00:00:00"},n.isValid=function(n){return/^([01]?\d|2[0-3])(((:[0-5]?\d){2}(\.\d{1,3}){0,1})|(:[0-5]?\d){0,2})?$/.test(n)},n.handle=function(n){return this.isValid(n)||u(this,n),n},n.autoValue=function(){return"00:00:00"},n.toODataValue=function(n){return"time'"+n+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new r}(),n.boolean=function(){var r=function(){i.DataTypeBase.call(this,"boolean");t.tryFreeze(this)},f;return t.inherit(r,i.DataTypeBase),f=r.prototype,f.defaultValue=function(){return!1},f.handle=function(t){if(!this.isValid(t)){if(n.String.isValid(t)){var i=t.toLowerCase();if(i=="true"||i=="1")return!0;if(i=="false"||i=="0")return!1}throw u(this,t);}return t},new r}(),n.int=function(){var f=0,r=function(){i.DataTypeBase.call(this,"int");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return typeof n=="number"&&n%1==0},n.handle=function(n){return typeof n!="number"&&(n=Number(n)),this.isValid(n)||u(this,n),n},n.autoValue=function(){return--f},new r}(),n.number=function(){var f=0,r=function(){i.DataTypeBase.call(this,"number");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return!isNaN(n)&&typeof n=="number"},n.handle=function(n){return typeof n!="number"&&(n=Number(n)),this.isValid(n)||u(this,n),n},n.autoValue=function(){return--f},new r}(),n.byte=function(){var f=0,r=function(){i.DataTypeBase.call(this,"byte");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return typeof n=="number"&&n%1==0&&n>=0&&n<256},n.handle=function(n){return typeof n!="number"&&(n=Number(n)),this.isValid(n)||u(this,n),n},n.autoValue=function(){return--f},new r}(),n.binary=function(){var r=function(){i.DataTypeBase.call(this,"binary");t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return'"AAAAAAAAAAA="'},n.isValid=function(){return!0},n.handle=function(n){return n},n.toODataValue=function(n){return n=this.handle(n),"X'"+s.getDateConverter().toISOString(n)+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new r}(),n.enum=function(){function e(n,i){var e,r,u,o;if(f.isArray(n))return e=0,t.forEach(n,function(n){e|=n.value}),e;if(f.isTypeOf(n,"string")){if(r=n.split(", "),r.length==1)return i[n];for(u=0;u<r.length;u++)if(i[r[u]]==null)return null;return n}return f.isTypeOf(n,"number")?(o=n,t.forEach(i.symbols(),function(t){if(t.value==n){o=t;return}}),o):f.isEnum(n,i)?n:null}var u=function(n,r,u){i.DataTypeBase.call(this,"enum");this.enumType=n;this.enumTypeName=r;this.displayName=u||r;t.tryFreeze(this)},n;return t.inherit(u,i.DataTypeBase),n=u.prototype,n.defaultValue=function(){},n.isValid=function(n){return e(n,this.enumType)!=null},n.handle=function(n){var i=e(n,this.enumType);if(i==null)throw t.createError(r.invalidEnumValue,[n,this.enumTypeName],{enumType:this.enumType,value:n});return i},n.getRawValue=function(n){return f.isEnum(n,this.enumType)?n.value:n},n.toODataValue=function(n){return this.getRawValue(n)},n.toBeetleValue=function(n){return this.getRawValue(n)},u}(),n.geometry=function(){var r=function(){i.DataTypeBase.call(this,"geometry");this.isComplex=!0;t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return{$type:"System.Data.Spatial.DbGeometry",CoordinateSystemId:null,WellKnownText:"",WellKnownBinary:null}},n.isValid=function(n){return n.$tracker&&n.$tracker.getValue("WellKnownText")},n.handle=function(n){return n.$tracker&&(n.$tracker.entityType.isComplexType=!0),n},new r}(),n.geography=function(){var r=function(){i.DataTypeBase.call(this,"geography");this.isComplex=!0;t.tryFreeze(this)},n;return t.inherit(r,i.DataTypeBase),n=r.prototype,n.defaultValue=function(){return{$type:"System.Data.Spatial.DbGeography",CoordinateSystemId:null,WellKnownText:"",WellKnownBinary:null}},n.isValid=function(n){return n.$tracker&&n.$tracker.getValue("WellKnownText")},n.handle=function(n){return n.$tracker&&(n.$tracker.entityType.isComplexType=!0),n},new r}(),n.byName=function(i){var u=n[i];if(!u)throw t.createError(r.unknownDataType,[i]);return u},n.byValue=function(t){return n.string.isValid(t)?n.guid.isValid(t)?n.guid:n.date.tryParse(t)?n.date:n.string:n.date.isValid(t)?n.date:n.boolean.isValid(t)?n.boolean:n.int.isValid(t)?n.int:n.number.isValid(t)?n.number:n.array.isValid(t)?n.array:n.binary},n.handle=function(t){var i=n.date.tryParse(t);return i!=null?i:t},n.toODataValue=function(t){return t==null?"null":n.byValue(t).toODataValue(t)},n.toBeetleValue=function(t){return t==null?"null":n.byValue(t).toBeetleValue(t)},n}(),Validator:function(){function i(i,u,f,e){var o=function(n){return n==null?!1:u.test(n)};return f=t.formatString(f||r.invalidValue,e),new n(i,o,f,{pattern:u})}var n=function(n,i,r,u){this.name=n;this.func=i;this.message=r;this.args=u;t.tryFreeze(this)},u=n.prototype;return u.toString=function(){var n=[],t;if(this.args)for(t in this.args)n.push(t+": "+this.args[t]);return n.length>0?this.name+" ("+n.join(", ")+")":this.name},u.validate=function(n,t){return this.func(n,t)==!0?null:this.message},n.byCode=function(i,u,f,e,o,h){var c=s.getLocalizeFunction();c&&(f=e&&c(e)||f,o=h&&c(h)||o);u=u||[];u.push(f);u.push(o);switch(i){case"re":return n.required.apply(null,u);case"sl":return n.stringLength.apply(null,u);case"ma":return n.maxLength.apply(null,u);case"mi":return n.minLength.apply(null,u);case"ra":return n.range.apply(null,u);case"rx":return n.regularExpression.apply(null,u);case"ea":return n.emailAddress.apply(null,u);case"cc":return n.creditCard.apply(null,u);case"ur":return n.url.apply(null,u);case"ph":return n.phone.apply(null,u);case"po":return n.postalCode.apply(null,u);case"ti":return n.time.apply(null,u);case"co":return n.compare.apply(null,u);default:throw t.createError(r.unknownValidator,[i]);}},n.required=function(i,u,e){var o=function(n){return n==null?!1:f.isTypeOf(n,"string")&&!i&&n==""?!1:!0};return u=t.formatString(u||r.requiredError,e),new n("Required",o,u,{allowEmptyStrings:i})},n.stringLength=function(i,u,e,o){var s=function(n){return!i&&!u?!0:f.isNotEmptyString(n)?i&&n.length<i?!1:u&&n.length>u?!1:!0:!1};return e=t.formatString(e||r.stringLengthError,o,i,u),new n("StringLength",s,e,{min:i,max:u})},n.maxLength=function(i,u,f){var e=function(n){return n==null?!0:i&&n.length>i?!1:!0};return u=t.formatString(u||r.maxLenError,f,i),new n("MaxLength",e,u,{length:i})},n.minLength=function(i,u,f){var e=function(n){return n==null?!1:i&&n.length<i?!1:!0};return u=t.formatString(u||r.minLenError,f,i),new n("MinLength",e,u,{length:i})},n.range=function(i,u,f,e){var o=function(n){return!i&&!u?!0:i&&n<i?!1:u&&n>u?!1:!0};return f=t.formatString(f||r.rangeError,e,i,u),new n("Range",o,f,{min:i,max:u})},n.regularExpression=function(n,t,r){return f.isTypeOf(n,"string")&&(n=new RegExp(n)),i("RegularExpression",n,t,r)},n.emailAddress=function(n,t){return i("EmailAddress",/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,n,t)},n.creditCard=function(n,t){return i("CreditCard",/^((4\d{3})|(5[1-5]\d{2})|(6011)|(3[68]\d{2})|(30[012345]\d))[ -]?(\d{4})[ -]?(\d{4})[ -]?(\d{4}|3[4,7]\d{13})$/,n,t)},n.url=function(n,t){return i("Url",/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/,n,t)},n.phone=function(n,t){return i("Phone",/^(?!.*-.*-.*-)(?=(?:\d{8,10}$)|(?:(?=.{9,11}$)[^-]*-[^-]*$)|(?:(?=.{10,12}$)[^-]*-[^-]*-[^-]*$)  )[\d-]+$/,n,t)},n.postalCode=function(n,t){return i("PostalCode",/^\d{5}([\-]?\d{4})?$/,n,t)},n.time=function(n,t){return i("Time",/^([01]?\d|2[0-3])(((:[0-5]?\d){2}(\.\d{1,3}){0,1})|(:[0-5]?\d){0,2})?$/,n,t)},n.compare=function(i,u,f){var o=function(n,r){var u=t.getValue(r,i);return n==u},e=s.getLocalizeFunction(),h=e&&e(i)||i;return u=t.formatString(u||r.compareError,f,h),new n("Compare",o,u,{property:i})},n}(),EntityContainer:function(){function r(n,t){var i=new u(n);return t.push(i),i}var u=function(){function u(n,t){var i=r(n,t);return i>-1?t[i]:null}function r(n,t){var f=t.length,r,u,i;if(f>0)for(r=0,u=f-1;r<=u;){if(i=Math.floor((r+u)/2),t[i].key<n){r=i+1;continue}if(t[i].key>n){u=i-1;continue}return i}return-1}function f(n,t){for(var i=0;i<t.length&&n>t[i].key;)i++;return i}var i=function(n){this.typeName=n.name;this.keyIndex=[];t.tryFreeze(this)},n=i.prototype;return n.toString=function(){return this.typeName+": "+this.keyIndex.length},n.push=function(n,t){var i=f(n,this.keyIndex);this.keyIndex.splice(i,0,{key:n,entity:t})},n.remove=function(n){var t=r(n,this.keyIndex);this.keyIndex.splice(t,1)},n.getEntity=function(n){var t=u(n,this.keyIndex);return t?t.entity:null},n.getRelations=function(n,t){var f=t.inverse,r,i,u;if(!f)return null;for(r=[],i=0;i<this.keyIndex.length;i++)u=this.keyIndex[i],u.entity.$tracker.foreignKey(f)===n&&r.push(u.entity);return r},n.relocateKey=function(n,t,i){this.remove(t);i&&this.push(i,n)},n.getEntities=function(){var n=[];return t.forEach(this.keyIndex,function(t){n.push(t.entity)}),n},i}(),i=function(){this.entitySets=[];this.allEntities=[];t.tryFreeze(this)},n=i.prototype;return n.toString=function(){return this.allEntities.length},n.push=function(n){var u;this.allEntities.push(n);var i=n.$tracker,t=i.entityType,r=i.key;if(r)while(t)u=this.getEntitySet(t),u.push(r,n),t=t.baseType},n.remove=function(n){var r;t.removeFromArray(this.allEntities,n);var u=n.$tracker,i=u.entityType,f=u.key;if(f)while(i)r=this.findEntitySet(i),r&&(r.remove(f),i=i.baseType)},n.getEntities=function(){return this.allEntities},n.getEntityByKey=function(n,t){if(!n)return null;var i=this.findEntitySet(t);return i?i.getEntity(n):null},n.getRelations=function(n,t){var f=t.inverse,u,i,r;return f?(u=t.entityType,i=n.$tracker.key,!i)?null:(r=this.findEntitySet(u),r)?r.getRelations(i,t):null:null},n.relocateKey=function(n,t,i){for(var u=n.$tracker.entityType,f;u;)f=this.findEntitySet(u),f?f.relocateKey(n,t,i):(f=r(u,this.entitySets),f.push(i,n)),u=u.baseType},n.getChanges=function(){return t.filterArray(this.allEntities,function(n){return!(n.$tracker.entityType.isComplexType&&n.$tracker.owners.length>0)&&n.$tracker.isChanged()})},n.count=function(){return this.allEntities.length},n.findEntitySet=function(n){return t.findInArray(this.entitySets,n.name,"typeName")},n.getEntitySet=function(n){var t=this.findEntitySet(n);return t||(t=r(n,this.entitySets)),t},i}(),EntitySet:function(){function u(n,i){var f,u,e;if(n==null)throw t.createError(r.cannotCheckInstanceOnNull);if(f=i.entityType,!f.isAssignableWith(n)&&(u=n.$tracker&&n.$tracker.entityType,e=u&&u.shortName||"Object",!u||!f.isAssignableWith(u)))throw t.createError(r.typeError,[e,f.shortName]);}var i=function(n,t){this.entityType=n;this.manager=t;this.local=t.entities.getEntitySet(n);o.EntityQuery},n;return t.inherit(i,o.EntityQuery),n=i.prototype,n.toString=function(){return"EntitySet: "+this.entityType.shortName},n.add=function(n){u(n,this);this.manager.addEntity(n)},n.attach=function(n){u(n,this);this.manager.attachEntity(n)},n.remove=function(n){u(n,this);this.manager.deleteEntity(n)},i}(),EntityTracker:function(){function y(n,t,i,r){r.entity=n;n.$tracker=r;r.entityType=t;r.entityState=u.entityStates.Detached;r.observableProvider=i;r.forceUpdate=!1;r.originalValues=[];r.changedValues=[];r.manager=null;r.owners=[];r.validationErrors=[];r.validationErrorsChanged=new e.Event("validationErrorsChanged",r);r.entityStateChanged=new e.Event("entityStateChanged",r);r.propertyChanged=new e.Event("propertyChanged",r);r.arrayChanged=new e.Event("arrayChanged",r);t.hasMetadata&&(r.key=l(r))}function w(n,t,i){var r={propertyChange:b,arrayChange:k,dataPropertyChange:d,scalarNavigationPropertyChange:g,pluralNavigationPropertyChange:nt,arraySet:tt};return i.observableProvider.toObservable(n,t,r)}function c(n,t){n.baseType&&c(n.baseType,t);n.initializer&&n.initializer.call(t,t)}function l(n,t,i){var e=n.entityType,o,r,u,f;if(e.keys.length==0)return null;for(o=[],r=0;r<e.keys.length;r++)u=e.keys[r],f=u===t?i:n.getValue(u.name),u.dataType.name=="guid"&&(f=f.toLowerCase()),o.push(f);return o.join(",")}function a(n,i,f,e){var o,s;if(!n)throw t.createError(r.propertyNotFound,[i],{propertyName:i,entity:e.entity,manager:e.manager});if(o=n.entityType.createQuery(f,e.manager),n.isScalar)t.forEach(n.foreignKeys,function(t,i){var r=n.entityType.keys[i],f=e.getValue(t.name);o=o.where(r.name,u.filterOps.Equals,f)});else{if(s=n.inverse,!s)throw t.createError(r.pluralNeedsInverse,{property:n});t.forEach(s.foreignKeys,function(n,t){var i=n.name,r=e.getValue(s.entityType.keys[t]);o=o.where(i,u.filterOps.Equals,r)})}return o}function b(n,t,r,u){var l=!1,h,o,c;(f.isInstanceOf(u,e.ValueNotifyWrapper)&&(l=!u.fromBeetle,u=u.value),h=r(),h!==u)&&(o=n.$tracker,o.manager&&(c=o.manager.handleUnmappedProperties),c==null&&(c=s.handleUnmappedProperties),c!==!0||(u=e.dataTypes.handle(u),h!==u))&&(r(u),o.manager&&i(n,t,h,o),l||o.propertyChanged.notify({entity:n,property:t,oldValue:h,newValue:u}))}function k(n,t,r,u,f){var e=n.$tracker;e.manager&&i(n,null,null,e);e.arrayChanged.notify({entity:n,property:t,items:r,removedItems:u,addedItems:f})}function d(n,u,h,c){var rt=!1,nt=!1,v,k,y,w,b,g,d;if((f.isInstanceOf(c,e.ValueNotifyWrapper)&&(rt=c.fromBeetle,nt=!c.fromBeetle,c=c.value),v=h(),v!==c)&&(c=u.handle(c),v!==c)&&(u.dataType!==e.dataTypes.date&&u.dataType!==e.dataTypes.dateTimeOffset||v==null||c==null||v.valueOf()!==c.valueOf())){var a=n.$tracker,tt=null,p=null;if(u.isKeyPart){if(tt=a.key,p=l(a,u,c),a.manager&&(k=a.manager.getEntityByKey(p,a.entityType.floorType),k&&k!==n))throw t.createError(r.sameKeyExists,{key:p,entity:k});a.key=p}if(y=a.liveValidate,a.manager?(i(n,u.name,u.dataType.getRawValue(v),a),y==null&&(y=a.manager.liveValidate)):a.entityType.isComplexType&&t.forEach(a.owners,function(n){i(n.entity,n.property.name+"."+u.name,c,n.entity.$tracker)}),h(c),y==null&&(y=s.liveValidate),y===!0&&o(u.validate(n),a,u),nt||a.propertyChanged.notify({entity:n,property:u,oldValue:v,newValue:c}),u.isKeyPart&&(a.manager&&a.manager.entities.relocateKey(n,tt,p),it(n)),u.isComplex){for(w=v.$tracker.owners,b=w.length-1;b>=0;b--)g=w[b],g.entity==n&&g.property==u&&w.splice(b,1);w.length==0&&v.$tracker.manager&&v.$tracker.manager.detachEntity(v);c.$tracker.owners.push({entity:n,property:u})}a.manager&&(d=a.manager.autoFixScalar,d==null&&(d=s.autoFixScalar),t.forEach(u.relatedNavigationProperties,function(n){var t,i,r;if(n.isScalar===!0)if(t=a.foreignKey(n),t){if(i=a.getValue(n.name),i&&i.$tracker.key===t)return;r=null;d&&(r=a.manager.getEntityByKey(t,n.entityType));r?a.setValue(n.name,r):i&&a.setValue(n.name,new e.ValueNotifyWrapper(null,!0))}else a.setValue(n.name,null)}))}}function g(n,u,h,c){var g=!1,nt=!1,l,a,p,b,w,k,y,d;if(f.isInstanceOf(c,e.ValueNotifyWrapper)&&(g=c.fromBeetle,nt=!c.fromBeetle,c=c.value),l=h(),l!==c)if(u.checkAssign(c),h(c),a=n.$tracker,p=a.liveValidate,p==null&&a.manager&&(p=a.manager.liveValidate),p==null&&(p=s.liveValidate),p===!0&&o(u.validate(n),a,u),nt||a.propertyChanged.notify({entity:n,property:u,oldValue:l,newValue:c}),v(c,a.manager),u.isComplex){if(c==null)throw t.createError(r.complexCannotBeNull,[u.displayName],{entity:n,property:u});for(b=l.$tracker.owners,w=b.length-1;w>=0;w--)k=b[w],k.entity==n&&k.property==u&&b.splice(w,1);l.$tracker.owners.length==0&&l.$tracker.manager&&l.$tracker.manager.detachEntity(l);c.$tracker.owners.push({entity:n,property:u});i(n,u.name,c.$tracker.toRaw(),a)}else g||(u.triggerOwnerModify&&u.foreignKeys.length==0&&i(n,null,null,a),t.setForeignKeys(n,u,c)),y=u.inverse,y&&(y.isScalar?(l&&l.$tracker.setValue(y.name,null),c&&c.$tracker.setValue(y.name,n)):(l&&l.$tracker.getValue(y.name).remove(n),c&&(d=c.$tracker.getValue(y.name),t.findInArray(d,n)||d.push(n))))}function nt(n,r,u,f,e){var h=n.$tracker,c=h.liveValidate,l;c==null&&h.manager&&(c=h.manager.liveValidate);c==null&&(c=s.liveValidate);c===!0&&o(r.validate(n),h,r);r.triggerOwnerModify&&i(n,null,null,h);h.arrayChanged.notify({entity:n,property:r,items:u,removedItems:f,addedItems:e});l=r.inverse;l&&(f&&t.forEach(f,function(t){t.$tracker.getValue(l.name)==n&&t.$tracker.setValue(l.name,null)}),e&&t.forEach(e,function(t){v(t,h.manager);t.$tracker.setValue(l.name,n)}))}function tt(n,i,f,e){var c,h,o,l;if(i!==f){if(c=s.getArraySetBehaviour(),c==u.arraySetBehaviour.NotAllowed)throw t.createError(r.settingArrayNotAllowed,{entity:n,property:e});if(h=[],o=t.filterArray(f,function(){return!0}),c==u.arraySetBehaviour.Replace?t.forEach(i,function(n){t.findInArray(o,n)?t.removeFromArray(o,n):h.push(n)}):c==u.arraySetBehaviour.Append&&t.forEach(f,function(n){t.findInArray(i,n)&&t.removeFromArray(o,n)}),h.length>0)for(l=h.length-1;l>=0;l--)i.splice(t.indexOf(i,h[l]),1);o.length>0&&i.push.apply(i,o)}}function it(n){var i=n.$tracker;t.forEach(i.entityType.navigationProperties,function(r){var f,e,u;r.inverse&&(f=r.inverse,r.isScalar?(e=i.getValue(r.name),e&&t.setForeignKeys(e,f,n)):(u=i.getValue(r.name),u&&u.length>0&&t.forEach(u,function(i){t.setForeignKeys(i,f,n)})))})}function v(n,i){if(n&&i&&!n.$tracker.entityType.isComplexType&&!i.isInManager(n)){if(n.$tracker.manager)throw t.createError(r.entityAlreadyBeingTracked,null,{entity:n,manager:i});i.addEntity(n)}}function i(n,r,f,e){var o=e.entityState;o==u.entityStates.Unchanged&&(t.forEach(e.entityType.navigationProperties,function(n){var u=n.inverse,r;u&&u.triggerOwnerModify&&(r=e.getValue(n.name),r&&(n.isScalar?i(r,null,null,r.$tracker):t.forEach(r,function(n){i(n,null,null,n.$tracker)})))}),e.toModified());rt(r,f,e.originalValues,e.changedValues)}function rt(n,i,r,u){var f,e;n!=null&&(i==null||i.$tracker==null||i.$tracker.entityType.isComplexType)&&(f=t.findInArray(r,n,"p"),f||r.push({p:n,v:i}),e=t.findInArray(u,n,"p"),e||u.push({p:n,v:i}))}function o(n,i,r){var u=[],f=r?t.filterArray(i.validationErrors,function(n){return n.property===r}):t.filterArray(i.validationErrors,function(){return!0});t.forEach(f,function(r){t.findInArray(n,r.validator,"validator")?t.removeFromArray(n,r.validator,"validator"):(t.removeFromArray(i.validationErrors,r),u.push(r))});i.validationErrors=i.validationErrors.concat(n);(u.length>0||n.length>0)&&i.validationErrorsChanged.notify({errors:i.validationErrors,added:n,removed:u})}var h=function(n,t,i){delete n.$type;delete n.$id;y(n,t,i||s.getObservableProvider(),this);w(n,t,this);c(t,n)},n=h.prototype;return n.toString=function(){return"EntityTracker: "+this.entityType.shortName+", key: "+this.key},n.setManagerInfo=function(n){if(this.manager)throw t.createError(r.entityAlreadyBeingTracked,{otherManager:this.manager});t.assertPrm(n,"manager").isInstanceOf(e.EntityManager).check();this.manager=n},n.isChanged=function(){return this.entityState===u.entityStates.Added||this.entityState===u.entityStates.Deleted||this.entityState===u.entityStates.Modified},n.toAdded=function(){if(this.entityState!=u.entityStates.Added){var n={entity:this.entity,oldState:this.entityState,newState:u.entityStates.Added,newChanged:!this.isChanged()};this.entityState=u.entityStates.Added;this.entityStateChanged.notify(n)}},n.toModified=function(){if(this.entityState!=u.entityStates.Modified){var n={entity:this.entity,oldState:this.entityState,newState:u.entityStates.Modified,newChanged:!this.isChanged()};this.entityState=u.entityStates.Modified;this.entityStateChanged.notify(n)}},n.toDeleted=function(){if(this.entityState!=u.entityStates.Deleted){var n={entity:this.entity,oldState:this.entityState,newState:u.entityStates.Deleted,newChanged:!this.isChanged()};this.entityState=u.entityStates.Deleted;this.entityStateChanged.notify(n)}},n.toUnchanged=function(){if(this.entityState!=u.entityStates.Unchanged){var n={entity:this.entity,oldState:this.entityState,newState:u.entityStates.Unchanged,newUnchanged:this.isChanged()};this.originalValues.length=0;this.changedValues.length=0;this.entityState=u.entityStates.Unchanged;this.entityStateChanged.notify(n)}},n.toDetached=function(){if(this.entityState!=u.entityStates.Detached){var n={entity:this.entity,oldState:this.entityState,newState:u.entityStates.Detached,newUnchanged:this.isChanged()};this.entityState=u.entityStates.Detached;this.entityStateChanged.notify(n)}},n.undoChanges=function(){var n=this;t.forEach(this.changedValues,function(t){n.setValue(t.p,t.v)});this.changedValues.length=0},n.acceptChanges=function(){this.changedValues.length=0},n.getValue=function(n){return this.observableProvider.getValue(this.entity,n)},n.setValue=function(n,t){this.observableProvider.setValue(this.entity,n,t)},n.getOriginalValue=function(n){var i=t.findInArray(this.originalValues,n,"p");return i?i.v:this.getValue(n)},n.foreignKey=function(n){var r=n.entityType,u,t,e,f,o,i;if(r.keys.length==0)return null;for(u=[],t=0;t<r.keys.length;t++){if((e=r.keys[t],f=n.foreignKeys[t],f==null)||(o=f.name,i=this.getValue(o),i==null))return null;e.dataType.name=="guid"&&(i=i.toLowerCase());u.push(i)}return u.join(",")},n.createLoadQuery=function(n,i){var r=t.findInArray(this.entityType.navigationProperties,n,"name");return a(r,n,i,this)},n.loadNavigationProperty=function(n,i,f,e,o,s){var c,h,l;if(this.manager==null)throw t.createError(r.entityNotBeingTracked,{entity:this.entity});return c=t.findInArray(this.entityType.navigationProperties,n,"name"),h=a(c,n,f,this),i&&t.forEach(i,function(n){h=h.expand(n)}),l=this,e=e||{},e.merge==null&&(e.merge=u.mergeStrategy.Preserve),e.autoFixScalar==null&&(e.autoFixScalar=!0),e.autoFixPlural==null&&(e.autoFixPlural=!0),this.manager.executeQuery(h,e,function(){c.inverse||l.manager.fixNavigations(entity);o&&o.apply(null,arguments)},s)},n.validate=function(){return this.entityState==u.entityStates.Deleted?this.validationErrors=[]:o(this.entityType.validate(this.entity),this),this.validationErrors},n.toRaw=function(n){var r=this.entityType,i={},u=this;return r.hasMetadata&&(t.forEach(r.dataProperties,function(t){var r=u.getValue(t.name);r!=null&&r.$tracker?(n==!0||r.$tracker.entityType.isComplexType)&&(i[t.name]=r.$tracker.toRaw(n)):i[t.name]=t.dataType.getRawValue(r)}),n==!0&&t.forEach(r.navigationProperties,function(n){var r=u.getValue(n.name);r==null?i[n.name]=null:f.isArray(r)?t.forEach(r,function(n){n!=null&&n.$tracker?i[p].push(n.$tracker.toRaw(!0)):i[p].push(n)}):i[n.name]=r.$tracker.toRaw(!0)})),t.forEach(r.properties,function(r){var e=u.getValue(r);f.isArray(e)?(i[r]=[],t.forEach(e,function(t){t!=null&&t.$tracker?n==!0&&i[r].push(t.$tracker.toRaw(!0)):i[r].push(t)})):e!=null&&e.$tracker?(n==!0||e.$tracker.entityType.isComplexType)&&(i[r]=e.$tracker.toRaw(n)):i[r]=e}),i},h.toEntity=function(n,t,i){return new e.EntityTracker(n,t,i).entity},h}(),EntityManager:function(){function b(n,t,i,r,e,o){var l,h,a,v,w;return(i=i||{},l=i.async,l==null&&(l=o.workAsync),l==null&&(l=s.workAsync),i.async=l,h=l?o.promiseProvider:null,a=null,h&&(a=h.deferred()),v=i.makeObservable,v==null&&(v=!0),w=null,o.dataService.createEntityAsync(n,t,i,function(n,t){try{var i=!1;f.isArray(n)||(n=[n],i=!0);v&&c(n,t,u.mergeStrategy.ThrowError,u.entityStates.Added,o);i&&(n=n[0]);p(r,h,a,n);h||(w=n)}catch(s){y(e,h,a,n,o)}},function(t){t.typeName=n;y(e,h,a,t,o)}),h)?h.getPromise(a):w}function k(n,t,i,r){var f=u.mergeStrategy.ThrowError,e=i;t?(t.merge!=null&&(f=t.merge),t.state!=null&&(e=t.state)):t={};c([n],null,f,e,r,t.autoFixScalar,t.autoFixPlural)}function ht(o,h){function b(n,i){return function(r){t.extend(this,r);i.createEntity(n,this)}}function k(n){return function(i,r){t.extend(this,i);r==!0?n.createRawEntity(this):n.createEntity(this)}}var p,w,y;if(h._readyCallbacks=[],h._readyPromises=[],o.length<1||o.length>3)throw t.createError(r.managerInvalidArgs,{entityManager:h});var a=o[0],l=o[1],c=o[2];if(f.isInstanceOf(a,i.DataServiceBase))h.dataService=a,c=o[1];else if(f.isTypeOf(a,"string"))o.length===2&&f.isObject(l)&&!f.isInstanceOf(l,e.metadataManager)&&(c=l,l=undefined),p=s.getDefaultServiceType(),w=p===u.serviceTypes.WebApi?v.WebApiService:v.MvcService,h.dataService=new w(a,l,c);else throw t.createError(r.managerInvalidArgs,{entityManager:this,arguments:o});c=c||{};h.promiseProvider=c.promiseProvider||s.getPromiseProvider();h.autoFixScalar=c.autoFixScalar;h.autoFixPlural=c.autoFixPlural;h.validateOnMerge=c.validateOnMerge;h.validateOnSave=c.validateOnSave;h.liveValidate=c.liveValidate;h.handleUnmappedProperties=c.handleUnmappedProperties;h.forceUpdate=c.forceUpdate;h.workAsync=c.workAsync;h.minimizePackage=c.minimizePackage;h.pendingChangeCount=0;h.entities=new e.EntityContainer;h.validationErrors=[];h.entityStateChanged=new e.Event("entityStateChanged",h);h.validationErrorsChanged=new e.Event("validationErrorsChanged",h);h.hasChangesChanged=new e.Event("hasChangesChanged",h);h.queryExecuting=new e.Event("queryExecuting",h);h.queryExecuted=new e.Event("queryExecuted",h);h.saving=new e.Event("saving",h);h.saved=new e.Event("saved",h);y=c.registerMetadataTypes;y==null&&(y=s.registerMetadataTypes);h.dataService.ready(function(){var c=h.dataService.metadataManager,r,u,i,t,f,l,o,s;if(y&&c){if(r=c.types,r)for(h.entitySets={},u=0;u<r.length;u++)i=r[u],t=i.shortName,h.hasOwnProperty(t)||(h[t]=b(t,h)),f=i.setName,f&&!h.hasOwnProperty(f)&&(l=new e.EntitySet(i,h),h[f]=l,h.entitySets[t]=l),n.hasOwnProperty(t)||(n[t]=k(i));if(o=c.enums,o)for(s in o)n.hasOwnProperty(s)||(n[s]=o[s])}d(h)})}function d(n){var i,e,t,r,u,f;if(n.isReady())for(i=n._readyCallbacks.slice(0),e=n._readyPromises.slice(0),n._readyCallbacks=[],n._readyPromises=[],t=0;t<i.length;t++)r=i[t],r&&r.call(n),u=e[t],u&&(f=n.promiseProvider,f&&f.resolve(u))}function c(n,i,e,o,h,c,l){var v;e||(e=u.mergeStrategy.Preserve);o&&o!==u.entityStates.Detached||(o=u.entityStates.Added);c==null&&(c=h.autoFixScalar);c==null&&(c=s.autoFixScalar);l==null&&(l=h.autoFixPlural);l==null&&(l=s.autoFixPlural);v=h.validateOnMerge;v==null&&(v=s.validateOnMerge);i=i||h.flatEntities(f.isArray(n)?n:[n]);var p=[],w=[],y=[],b=h.entities.count(),a=h;t.forEach(i,function(n){var f;if(n!=null){if(f=n.$tracker,!f&&n.$type)f=a.toEntity(n,n.$type).$tracker;else if(f.entityType.isComplexType||h.isInManager(n))return;var o=f.entityType,s=f.key,i=null;if(b>0&&s&&(i=a.entities.getEntityByKey(s,o.floorType)),i){if(o.name!==i.$tracker.entityType.name)throw t.createError(r.sameKeyOnDifferentTypesError,[i.$tracker.entityType.shortName,o.shortName],{existingEntity:i,entity:n,manager:a});if(e===u.mergeStrategy.ThrowError)throw t.createError(r.sameKeyExists,{existingEntity:i,entity:n,manager:a});else e===u.mergeStrategy.Preserve?y.push({o:n,n:i}):(y.push({o:n,n:i}),w.push({o:i,n:n}))}else a.entities.push(n),n.$tracker.setManagerInfo(a),p.push(n)}});t.forEach(p,function(n){tt(n,c,l,a);yt(n,a);nt(n,o);v===!0&&n.$tracker.validate()});t.forEach(w,function(n){ct(n.o,n.n);nt(n.o,o)});t.forEach(y,function(i){var r=t.indexOf(n,i.o);r>=0&&(n[r]=i.n);lt(i.o,i.n,c,l,a)})}function g(n,i){if(!i.isInManager(n))throw t.createError(r.entityNotBeingTracked,{entity:n,manager:i});}function nt(n,i){if(i===u.entityStates.Unchanged)n.$tracker.toUnchanged();else if(i===u.entityStates.Modified)n.$tracker.toModified();else if(i===u.entityStates.Added)n.$tracker.toAdded();else throw t.createError(r.mergeStateError,[i],{entity:n,state:i});}function ct(n,i){var r=i.$tracker;t.forEach(r.entityType.dataProperties,function(t){n.$tracker.setValue(t.name,r.getValue(t.name))})}function tt(n,i,r,u){if(i==!0||r==!0){var e=n.$tracker,o=e.entityType;t.forEach(o.navigationProperties,function(t){var f=e.getValue(t.name),o,h,s,c;if(t.isComplex){for(o=f.$tracker.owners,h=!1,s=0;s<o.length;s++)if(c=o[s],c.entity==n&&c.property==t){h=!0;break}h||o.push({entity:n,property:t})}else t.isScalar?it(e,f,t,t.name,i,u):(rt(f,u),r&&ft(n,t,f,u))});t.forEach(o.dataProperties,function(t){var u,i,f,r,o;if(t.isComplex){for(u=e.getValue(t.name),u.$tracker.entityType.isComplexType=!0,i=u.$tracker.owners,f=!1,r=0;r<i.length;r++)if(o=i[r],o.entity==n&&o.property==t){f=!0;break}f||i.push({entity:n,property:t})}});t.forEach(e.entityType.properties,function(n){var t=e.getValue(n);f.isArray(t)?rt(t,u):it(e,t,null,n,!1,u)})}}function it(n,i,r,u,f,e){i?(i.$tracker&&i.$tracker.manager!=e&&(i=e.getEntityByKey(i.$tracker.key,i.$tracker.entityType),n.setValue(u,i)),r&&t.setForeignKeys(n.entity,r,i)):r&&f&&ut(n,r,e)}function rt(n,t){for(var r,u,i=n.length-1;i>=0;i--)r=n[i],r&&r.$tracker&&r.$tracker.manager!=t&&(u=t.getEntityByKey(r.$tracker.key,r.$tracker.entityType),u?n.splice(i,1,u):n.splice(i,1))}function lt(n,i,r,f,e){var s=i.$tracker,c,o,h,l;s.entityState!=u.entityStates.Deleted&&(c=n.$tracker,l=c.entityType,t.forEach(l.navigationProperties,function(u){var y,p,l,a,v;u.isComplex||(o=c.getValue(u.name),h=s.getValue(u.name),u.isScalar?h||(r==!0?ut(s,u,e):r===!0&&u.inverse&&u.inverse.isScalar||f===!0&&u.inverse&&!u.inverse.isScalar||(y=c.foreignKey(u),p=s.foreignKey(u),y==p&&o!=null&&e.isInManager(o)&&(l=u.inverse,l?l.isScalar?o.$tracker.setValue(l.name,i):(a=o.$tracker.getValue(l.name),v=t.indexOf(a,n),v>=0&&a.splice(v,1,i)):s.setValue(u.name,o)))):f?ft(i,u,h,e):r===!0&&u.inverse||t.forEach(o,function(n){e.isInManager(n)&&!t.findInArray(h,n)&&h.push(n)}))}))}function ut(n,t,i){var f=n.foreignKey(t),r=i.entities.getEntityByKey(f,t.entityType);r&&r.$tracker.entityState==u.entityStates.Deleted&&(r=null);n.setValue(t.name,r)}function ft(n,i,r,f){var e=f.entities.getRelations(n,i);e&&t.forEach(e,function(n){n.$tracker.entityState==u.entityStates.Deleted||t.findInArray(r,n)||r.push(n)})}function et(n,i){var r=n.$tracker,u=r.entityType,f=i?new e.ValueNotifyWrapper(null,!0):null;u.hasMetadata&&t.forEach(u.navigationProperties,function(n){n.isScalar?r.setValue(n.name,f):r.getValue(n.name).splice(0)})}function at(n,i,r){t.forEach(n,function(n){n.$tracker.entityState==u.entityStates.Deleted?(n.$tracker.toDetached(),ot(n,r),i.remove(n)):n.$tracker.toUnchanged()})}function vt(n,i,r){if(i.removed.length>0)for(var u=i.removed.length-1;u>=0;u--)r.validationErrors.splice(t.indexOf(r.validationErrors,i.removed[u]),1);i.added.length>0&&r.validationErrors.push.apply(r.validationErrors,i.added);(i.removed.length>0||i.added.length>0)&&r.validationErrorsChanged.notify({errors:r.validationErrors,added:i.added,removed:i.removed})}function yt(n,t){n.$tracker.entityStateChanged.subscribe(function(n){var i=t.pendingChangeCount;n.newChanged===!0?t.pendingChangeCount++:n.newUnchanged===!0&&t.pendingChangeCount--;t.entityStateChanged.notify(n);i==0&&t.pendingChangeCount>0?t.hasChangesChanged.notify({hasChanges:!0}):i>0&&t.pendingChangeCount==0&&t.hasChangesChanged.notify({hasChanges:!1})});n.$tracker.validationErrorsChanged.subscribe(function(i){vt(n,i,t)})}function ot(n,i){n.$tracker.entityStateChanged.unsubscribe(i.entityStateChanged.notify);n.$tracker.validationErrorsChanged.unsubscribe(i.validationErrorsChanged.notify);var r=t.filterArray(i.validationErrors,function(t){return t.entity==n});t.removeFromArray(i.validationErrors,n,"entity");i.validationErrorsChanged.notify({errors:i.validationErrors,removed:r,added:[]})}function pt(n,t,i){var r={manager:n,query:t,options:i};return n.queryExecuting.notify(r),a.queryExecuting.notify(r),r}function st(n,t,i,r){var u={manager:n,query:t,options:i,result:r};return n.queryExecuted.notify(u),a.queryExecuted.notify(u),u.result}function wt(n,t,i){var r={manager:n,changes:t,options:i};return n.saving.notify(r),a.saving.notify(r),r.options}function bt(n,t,i){var r={manager:n,changes:t,options:i};n.saved.notify(r);a.saved.notify(r)}function p(n,t,i,r){n&&n(r);t&&t.resolve(i,r)}function y(n,t,i,r,u){if(n&&n(r),t&&t.reject(i,r),r.manager=u,!n&&!t)throw new r;}var w=function(){ht(arguments,this)},h=w.prototype;return h.toString=function(){return this.dataService.toString()+", "+r.pendingChanges+": "+this.pendingChangeCount+", "+r.validationErrors+": "+this.validationErrors.length},h.isReady=function(){return this.dataService.isReady()},h.ready=function(n){var t,i,r,u;return this._readyCallbacks.push(n),t=this.promiseProvider,i=null,t&&(r=t.deferred(),this._readyPromises.push(r),i=t.getPromise(r)),u=this,setTimeout(function(){d(u)},10),i},h.getEntityType=function(n){return this.dataService.getEntityType(n)},h.createQuery=function(n,t){return this.dataService.createQuery(n,t,this)},h.createEntityQuery=function(n,t){return this.dataService.createEntityQuery(n,t,this)},h.registerCtor=function(n,t,i){this.dataService.registerCtor(n,t,i)},h.createEntity=function(n,t){var i=this.dataService.createEntity(n,t),r=[i];return c(r,null,u.mergeStrategy.ThrowError,u.entityStates.Added,this),i},h.createDetachedEntity=function(n,t){return this.dataService.createEntity(n,t)},h.createRawEntity=function(n,t){return this.dataService.createRawEntity(n,t)},h.createEntityAsync=function(n,t,i,r,u){return b(n,t,i,r,u,this)},h.createRawEntityAsync=function(n,t,i,r,u){return i?i.makeObservable=!1:i={makeObservable:!1},b(n,t,i,r,u,this)},h.executeQuery=function(n,i,e,o){var d,v,h,w,g,nt,k;n.options&&(i=t.combine(n.options,i));d=pt(this,n,i);n=d.query;i=d.options;i=i||{};v=i.async;v==null&&(v=this.workAsync);v==null&&(v=s.workAsync);h=v?this.promiseProvider:null;w=null;h&&(w=h.deferred());var a=u.mergeStrategy.Preserve,l=u.executionStrategy.Server,b=null;if(f.isEnum(i,u.mergeStrategy)?(a=i,i={makeObservable:a!=u.mergeStrategy.NoTrackingRaw}):f.isEnum(i,u.executionStrategy)?l=i:(i.merge&&(a=i.merge),i.execution&&(l=i.execution),i.async=v,i.makeObservable=a!=u.mergeStrategy.NoTrackingRaw,i.handleUnmappedProperties==null&&(i.handleUnmappedProperties=this.handleUnmappedProperties)),g=a==u.mergeStrategy.NoTracking||a==u.mergeStrategy.NoTrackingRaw,g&&l==u.executionStrategy.Both)throw t.createError(r.executionBothNotAllowedForNoTracking,{executionStrategy:l,mergeStrategy:a});return((l==u.executionStrategy.Local||l==u.executionStrategy.LocalIfEmptyServer)&&(b=this.executeQueryLocally(n,i.varContext)),nt=null,l==u.executionStrategy.Local||l==u.executionStrategy.LocalIfEmptyServer&&b&&(b.length==null||b.length>0)?(b=st(this,n,i,b),p(e,h,w,b)):(k=this,this.dataService.executeQuery(n,i,function(t,r,s,v){try{var d=!1,b=s("X-InlineCount");b!=null&&(b=Number(b));t&&(g||(f.isArray(t)||(t=[t],d=!0),c(t,r,a,u.entityStates.Unchanged,k,i.autoFixScalar,i.autoFixPlural),d&&(t=t[0])));l==u.executionStrategy.Both&&(t=k.executeQueryLocally(n,i.varContext,!0),t.$inlineCountDiff!=null&&(b!=null&&(b+=t.$inlineCountDiff),delete t.$inlineCountDiff));t&&f.isObject(t)&&(n.inlineCountEnabled&&b!=null&&(t.$inlineCount=b),t.$extra={userData:s("X-UserData")},i.includeXhr===!0&&(t.$extra.xhr=v));t=st(k,n,i,t);p(e,h,w,t);h||(nt=t)}catch(tt){y(o,h,w,tt,k)}},function(t){t.query=n;y(o,h,w,t,k)})),h)?h.getPromise(w):nt},h.executeQueryLocally=function(n,i,f){var v=n.entityType,y,h,s,p,w;if(v)if(h=this.entities.findEntitySet(v),h)y=h.getEntities();else return[];else throw t.createError(r.typeRequiredForLocalQueries);f&&n.getExpression(o.expressions.GroupByExp,!1)&&(a.warning.notify({message:r.countDiffCantBeCalculatedForGrouped,query:n,options:options}),f=!1);var e=[],c=[],l=[];return t.forEach(y,function(n){n.$tracker.entityState==u.entityStates.Added?(f&&c.push(n),e.push(n)):n.$tracker.entityState==u.entityStates.Deleted?f&&l.push(n):e.push(n)}),s=n.toFunction(),e=s(e,i),f&&e.$inlineCount!=null&&(p=c.length>0?s(c,i).$inlineCount:0,w=l.length>0?s(l,i).$inlineCount:0,e.$inlineCountDiff=p-w),e},h.getEntityByKey=function(n,t){var i=f.isInstanceOf(t,l.EntityType)?t:this.getEntityType(t,!0);return this.entities.getEntityByKey(n,i)},h.deleteEntity=function(n){var i,f,e;for(g(n,this),i=this,f=[],t.forEach(n.$tracker.entityType.navigationProperties,function(u){var e,o;if(u.cascadeDelete){if(u.inverse&&u.inverse.cascadeDelete)throw t.createError(r.twoEndCascadeDeleteNotAllowed,{entity:n,property:u});e=n.$tracker.getValue(u.name);e&&(u.isScalar?u.foreignKeys!=null&&u.foreignKeys.length>0?f.push(e):i.deleteEntity(e):(o=t.filterArray(e,function(){return!0}),t.forEach(o,function(n){i.deleteEntity(n)})))}}),n.$tracker.entityState===u.entityStates.Added?this.detachEntity(n):(et(n,!0),n.$tracker.toDeleted()),e=0;e<f.length;e++)i.deleteEntity(f[e])},h.addEntity=function(n,t){k(n,t,u.entityStates.Added,this)},h.attachEntity=function(n,t){k(n,t,u.entityStates.Unchanged,this)},h.detachEntity=function(n){if(n.$tracker.entityType.isComplexType&&n.$tracker.owners.length>0)throw t.createError(r.cannotDetachComplexTypeWithOwners);g(n,this);et(n,!0);ot(n,this);n.$tracker.toDetached();n.$tracker.manager=null;this.entities.remove(n)},h.createSavePackage=function(n,t){var u,i,r,f;return t=t||{},u=t.userData||null,i=t.forceUpdate,i==null&&(i=this.forceUpdate),i==null&&(i=s.forceUpdate),r={userData:u,forceUpdate:i},f=this.exportEntities(n||this.getChanges(),t),r.entities=f,r},h.rejectChanges=function(n,i){var e=this,r;f.isArray(n)||(n=[n]);r=i===!0?this.flatEntities(n):n;t.forEach(r,function(n){var t=n.$tracker;t.entityState==u.entityStates.Added?e.detachEntity(n):t.entityState==u.entityStates.Modified&&(t.undoChanges(),t.toUnchanged())})},h.undoChanges=function(n,i){f.isArray(n)||(n=[n]);var r=i===!0?this.flatEntities(n):n;t.forEach(r,function(n){n.$tracker.undoChanges()})},h.acceptChanges=function(n,i){f.isArray(n)||(n=[n]);var r=i===!0?this.flatEntities(n):n;t.forEach(r,function(n){n.$tracker.acceptChanges()})},h.exportEntities=function(n,i){var f,r;return i=i||{},f=[],n=n||this.entities.getEntities(),r=i.minimizePackage,r==null&&(r=this.minimizePackage),r==null&&(r=s.minimizePackage),t.forEach(n,function(n,i){var e=n.$tracker,a=e.entityType,s=e.entityState,h=e.forceUpdate,c={},o,l;if(r===!0)if(s==u.entityStates.Modified)if(e.originalValues.length>0)o={},t.forEach(e.originalValues,function(t){var f,r=t.p.split("."),s,u,i;if(r.length>1){for(s=0;s<r.length-1;s++)u=r[s],n=n.$tracker.getValue(u),o[u]==null&&(o[u]={}),o=o[u];f=r[r.length-1]}else f=t.p;i=e.getValue(f);i&&i.$tracker&&(i=i.$tracker.toRaw());o[f]=i}),t.forEach(e.entityType.dataProperties,function(n){(n.isKeyPart===!0||n.useForConcurrency===!0)&&(o[n.name]=e.getValue(n.name))});else if(h===!0)o=e.toRaw(n);else return;else if(s==u.entityStates.Deleted)o={},t.forEach(e.entityType.dataProperties,function(n){(n.isKeyPart===!0||n.useForConcurrency===!0)&&(o[n.name]=e.getValue(n.name))});else if(s==u.entityStates.Added)o=e.toRaw(n);else return;else o=e.toRaw(n);s==u.entityStates.Modified&&t.forEach(e.originalValues,function(n){var t=n.v;t&&t.$tracker&&(t=t.$tracker.toRaw());c[n.p]=t});l={t:a.name,s:s.toString(),o:c,i:i,f:h};o.$t=l;f.push(o)}),f},h.importEntities=function(n,i){var e=this;f.isArray(n)||(n=[n]);t.forEach(n,function(n){var f=n.$t,s,o,h,l;switch(f.s){case"Unchanged":s=u.entityStates.Unchanged;break;case"Added":s=u.entityStates.Added;break;case"Deleted":s=u.entityStates.Deleted;break;case"Modified":s=u.entityStates.Modified;break;default:throw t.createError(r.unsoppertedState,[f.s],{entity:n});}if(o=e.toEntity(n,f.t),c(o,[o],i||u.mergeStrategy.Preserve,s,e,!0,!0),f.o)for(h in f.o)l=f.o[h],o.$tracker.originalValues.push({p:h,v:l});o.$tracker.forceUpdate=f.forceUpdate;delete o.$t})},h.hasChanges=function(){return this.pendingChangeCount>0},h.getChanges=function(){return this.entities.getChanges()},h.saveChanges=function(n,i,e){var o,v,h,l,k,b,w,d,a;return(n=n||{},o=n.entities||this.getChanges(),n=wt(this,o,n),v=n.async,v==null&&(v=this.workAsync),v==null&&(v=s.workAsync),n.async=v,h=v?this.promiseProvider:null,l=null,h&&(l=h.deferred()),k=null,f.isArray(o)||(o=[o]),o&&o.length>0?(b=[],w=n.validateOnSave,w==null&&(w=this.validateOnSave),w==null&&(w=s.validateOnSave),w===!0&&t.forEach(o,function(n){if(n.$tracker.entityState!=u.entityStates.Deleted){var t=n.$tracker.validate();t&&t.length>0&&b.push({entity:n,validationErrors:t})}}),b.length>0?(d=new t.createError(r.validationFailed,{entities:o,validationErrors:b}),d.entitiesInError=b,y(e,h,l,d,this)):(a=this,this.dataService.saveChanges(this.createSavePackage(o,n),n,function(r){try{r.GeneratedEntities!=null&&r.GeneratedEntities.length>0&&c(r.GeneratedEntities,null,u.mergeStrategy.Preserve,u.entityStates.Unchanged,a,n.autoFixScalar,n.autoFixPlural);r.GeneratedValues&&t.forEach(r.GeneratedValues,function(t){var f=o[t.Index],e,i=t.Property.split("."),r,h,s;if(i.length>1){for(r=0;r<i.length-1;r++)f=f.$tracker.getValue(i[r]);e=i[i.length-1]}else e=t.Property;h=f.$tracker;t.Value!=null&&t.Value.$type&&(s=[t.Value],c(s,null,u.mergeStrategy.Preserve,u.entityStates.Unchanged,a,n.autoFixScalar,n.autoFixPlural),t.Value=s[0]);h.setValue(e,t.Value)});at(o,a.entities,a);bt(a,o,n);p(i,h,l,r);h||(k=r)}catch(f){f.changes=o;y(e,h,l,f,a)}},function(n){n.changes=o;y(e,h,l,n,a)}))):p(i,h,l,{AffectedCount:0,GeneratedValues:[]}),h)?h.getPromise(l):k},h.toEntity=function(n,t){return n.$type&&!t&&(t=n.$type),this.dataService.toEntity(n,t)},h.fixNavigations=function(n){if(!this.isInManager(n))throw t.createError(r.entityNotBeingTracked,null,{entity:n});tt(n,!0,!0,this)},h.isInManager=function(n){return n.$tracker.manager==this},h.flatEntities=function(n){var r=this,i=arguments[1]||[];return f.isArray(n)||(n=[n]),t.forEach(n,function(n){var u,s,o,e;if(n!=null){if(f.isArray(n)){r.flatEntities(n,i);return}if(!t.findInArray(i,n))if(u=n.$tracker,s=n.$type,u)i.push(n),u.entityType.hasMetadata?(t.forEach(u.entityType.dataProperties,function(n){if(n.isComplex){var t=u.getValue(n.name);t&&(f.isArray(t)?r.flatEntities(t,i):(t.$tracker||t.$type)&&r.flatEntities([t],i))}}),t.forEach(u.entityType.navigationProperties,function(n){var t=u.getValue(n.name);t&&(f.isArray(t)?r.flatEntities(t,i):(t.$tracker||t.$type)&&r.flatEntities([t],i))})):t.forEach(u.entityType.properties,function(n){var t=u.getValue(n);t&&(f.isArray(t)?r.flatEntities(t,i):(t.$tracker||t.$type)&&r.flatEntities([t],i))});else if(s){i.push(n);for(o in n)o!=="$type"&&(e=n[o],e&&(f.isArray(e)?r.flatEntities(e,i):(e.$tracker||e.$type)&&r.flatEntities([e],i)))}}}),i},h.entry=function(n){return n.$tracker},h.set=function(n){return this.entitySets&&this.entitySets[n]},w}()}}(),v=function(){var n={};return n.MvcService=function(){function u(n){var t=0,i,r,u;if(n.length==0)return t;for(i=0,u=n.length;i<u;i++)r=n.charCodeAt(i),t=(t<<5)-t+r|0;return t}var r=function(n,t,r){i.DataServiceBase.call(this,n,t,r)},n;return t.inherit(r,i.DataServiceBase),n=r.prototype,n.fetchMetadata=function(n,t,i){var u=null,o=this,r,f,e;return n=n||{},r=n.async,r==null&&(r=!this.ajaxProvider.syncSupported),f=n.timeout||this.ajaxTimeout||s.ajaxTimeout,e=n.extra,this.ajaxProvider.doAjax(this.uri+"Metadata","GET",this.dataType,this.contentType,null,r,f,e,null,function(n){u=o.serializationService.deserialize(n);t(u)},i),u},n.createEntityAsync=function(n,t,i,r,u){var f=this,e,o;i=i||{};e=i.makeObservable;e==null&&(e=!0);o=i.async;o==null&&(o=s.workAsync);var c=i.timeout||this.ajaxTimeout||s.ajaxTimeout,l=i.extra,h=f.uri+"CreateType?typeName="+n+"&initialValues=";t!=null&&(h+=f.serializationService.serialize(t));this.ajaxProvider.doAjax(h,"GET",this.dataType,this.contentType,null,o,c,l,null,function(n){n=f.serializationService.deserialize(n);var t=f.fixResults(n,e);r(n,t)},function(n){u(n)})},n.executeQuery=function(n,t,i,r){var u=this.toBeetleQueryParams(n,t&&t.varContext);return this.executeQueryParams(n.resource,u,t,i,r)},n.executeQueryParams=function(n,i,r,f,e){var h,v,y,b,p,w;r=r||{};var k=r.makeObservable,d=r.handleUnmappedProperties,g=r.usePost||!1,nt=r.dataType||this.dataType,tt=r.contentType||this.contentType,c=r.async;c==null&&(c=s.workAsync);var it=r.timeout||this.ajaxTimeout||s.ajaxTimeout,rt=r.extra,l,a=null,o=r.uri||this.uri||"";o&&o[o.length-1]!="/"&&(o+="/");o=o+n;g===!0?(v={},t.forEach(i,function(n){v[n.name]=n.value}),a=this.serializationService.serialize(v),h=a,l="POST"):(y=[],t.forEach(i,function(n){y.push(n.name+"="+encodeURIComponent(n.value))}),h=y.join("&"),o+="?"+h,l="GET");b=u(h);p={"x-beetle-request":b,"x-beetle-request-len":h.length};t.extend(p,r.headers);w=this;this.ajaxProvider.doAjax(o,l,nt,tt,a,c,it,rt,p,function(n,t){try{n=w.serializationService.deserialize(n)}catch(r){}n!=null&&n.$d!=null&&(n=n.$d);var i=null;n&&(i=w.fixResults(n,k,d));f(n,i,t)},function(n){e(n)})},n.saveChanges=function(n,i,r,f){var c=this,o,l;i=i||{};o=i.async;o==null&&(o=s.workAsync);var v=i.timeout||this.ajaxTimeout||s.ajaxTimeout,y=i.extra,e=i.uri||this.uri||"";e&&e[e.length-1]!="/"&&(e+="/");l=i.saveAction||"SaveChanges";e=e+l;var h=this.serializationService.serialize(n),p=u(h),a={"x-beetle-request":p,"x-beetle-request-len":h.length};t.extend(a,i.headers);this.ajaxProvider.doAjax(e,"POST",this.dataType,this.contentType,h,o,v,y,a,function(n){try{n=c.serializationService.deserialize(n)}catch(t){}n&&(c.fixResults(n,!1,null),delete n.$id,delete n.$type);r(n)},function(n){f(n)})},n.fixResults=function(n,i,r){function h(n){var l=n.$id,s,t,c;delete n.$id;u[l-1]=n;for(s in n)s!=="$type"&&(t=n[s],t&&(t.$ref?n[s]=u[t.$ref-1]:t.$id?h(t):f.isArray(t)?o.fixResults(t,i,r,u):r!==!1&&(n[s]=e.dataTypes.handle(t))));i!==!1&&(c=n.$type,o.toEntity(n,c))}var o=this,u=arguments[3]||[];return f.isArray(n)||(n=[n]),r==null&&(r=s.handleUnmappedProperties),t.forEach(n,function(t,s){t!=null&&(t.$ref?n[s]=u[t.$ref-1]:t.$id?h(t):f.isArray(t)?o.fixResults(t,i,r,u):r!==!1&&(n[s]=e.dataTypes.handle(t)))}),u},r}(),n.WebApiService=function(){var i=function(n,t,i){v.MvcService.call(this,n,t,i);this.useBeetleQueryStrings=!1},u;return t.inherit(i,n.MvcService),u=i.prototype,u.executeQuery=function(n,t,i,u){var f,e,o;return t=t||{},e=t.varContext,o=t.useBeetleQueryStrings!=null?t.useBeetleQueryStrings:this.useBeetleQueryStrings,o===!0?f=this.toBeetleQueryParams(n,e):n.isMultiTyped===!0?(f=this.toBeetleQueryParams(n,e),a.warning.notify({message:r.beetleQueryChosenMultiTyped,query:n,options:t})):t.usePost?(f=this.toBeetleQueryParams(n,e),a.warning.notify({message:r.beetleQueryChosenPost,query:n,options:t})):f=this.toODataQueryParams(n,e),this.executeQueryParams(n.resource,f,t,i,u)},i}(),n}(),u=function(){return{observableProviders:new h.Enum({Knockout:{code:"ko",instance:c.koObservableProviderInstance},Property:{code:"prop",instance:c.propertyObservableProviderInstance}}),promiseProviders:new h.Enum({Q:{code:"Q",instance:c.qPromiseProviderInstance},jQuery:{code:"jQuery",instance:c.jQueryPromiseProviderInstance}}),ajaxProviders:new h.Enum({jQuery:{code:"jQuery",instance:c.jQueryAjaxProviderInstance},Angular:{code:"Angular",instance:c.angularAjaxProviderInstance}}),entityStates:new h.Enum("Detached","Unchanged","Added","Deleted","Modified"),langOperators:function(){var n=function(n,t,i,r,u){this.name=n;this.code=t;this.asFunc=i;this.oData=r;this.js=u||t},i=[];return i.push(new n("Not","!",function(n){return!n()},"not ")),i.push(new n("Negative","-",function(n){return-1*n()})),i.push(new n("And","&&",function(n,t){return n()&&t()},"and")),i.push(new n("Or","||",function(n,t){return n()||t()},"or")),i.push(new n("Equals","==",function(n,i){return t.equals(n(),i(),!1,this)},"eq")),i.push(new n("StrictEquals","==",function(n,i){return t.equals(n(),i(),!0,this)},"eq","===")),i.push(new n("NotEqual","!=",function(n,i){return!t.equals(n(),i(),!1,this)},"ne")),i.push(new n("StrictNotEqual","!=",function(n,i){return!t.equals(n(),i(),!0,this)},"ne","!==")),i.push(new n("Greater",">",function(n,t){return n()>t()},"gt")),i.push(new n("Lesser","<",function(n,t){return n()<t()},"lt")),i.push(new n("GreaterEqual",">=",function(n,t){var i=n(),r=t();return i==r||i>r},"ge")),i.push(new n("LesserEqual","<=",function(n,t){var i=n(),r=t();return i==r||i<r},"le")),i.push(new n("Sum","+",function(n,t){return n()+t()},"add")),i.push(new n("Subtract","-",function(n,t){return n()-t()},"sub")),i.push(new n("Multiply","*",function(n,t){return n()*t()},"mul")),i.push(new n("Divide","/",function(n,t){return n()/t()},"div")),i.push(new n("Modulo","%",function(n,t){return n()%t()},"mod")),i.push(new n("BitAnd","&",function(n,t){return n()&t()})),i.push(new n("BitOr","|",function(n,t){return n()|t()})),i.push(new n("BitShiftLeft","<<",function(n,t){return n()<<t()})),i.push(new n("BitShiftRight",">>",function(n,t){return n()>>t()})),n.find=function(n){var r=t.filterArray(i,function(t){return t.code==n||t.oData==n||t.js==n});return r.length>0?r[0]:null},n}(),filterOps:new h.Enum({Equals:{oData:"eq",code:"=="},NotEqual:{oData:"ne",code:"!="},Greater:{oData:"gt",code:">"},Lesser:{oData:"lt",code:"<"},GreaterEqual:{oData:"ge",code:">="},LesserEqual:{oData:"le",code:"<="},Contains:{oData:"substringof",code:"contains",isFunc:!0},StartsWith:{oData:"startswith",code:"startswith",isFunc:!0},EndsWith:{oData:"endswith",code:"endswith",isFunc:!0}}),mergeStrategy:new h.Enum("Preserve","Overwrite","ThrowError","NoTracking","NoTrackingRaw"),executionStrategy:new h.Enum("Server","Local","Both","LocalIfEmptyServer"),generationPattern:new h.Enum("Identity","Computed"),arraySetBehaviour:new h.Enum("NotAllowed","Replace","Append"),serviceTypes:new h.Enum("WebApi","Mvc")}}(),a=function(){return{queryExecuting:new e.Event("beetleQueryExecuting",this),queryExecuted:new e.Event("beetleQueryExecuted",this),saving:new e.Event("beetleSaving",this),saved:new e.Event("beetleSaved",this),info:new e.Event("beetleInfo",this),warning:new e.Event("beetleWarning",this),error:new e.Event("beetleError",this)}}(),s=function(){function o(n,i,u){var o,e,s;if(i&&f.isInstanceOf(n,i))return n;if(u!=null){if(f.isNotEmptyString(n))for(o=u.symbols(),e=0;e<o.length;e++)if(s=o[e],t.equals(s.name,n,!1,{isCaseSensitive:!1,ignoreWhiteSpaces:!1})){n=s;break}if(f.isEnum(n,u))return n.instance}throw t.createError(r.invalidArguments,null,{args:arguments});}var s,h,l;s=n.ko?c.koObservableProviderInstance:c.propertyObservableProviderInstance;h=n.Q?c.qPromiseProviderInstance:!n.$&&n.angular?c.angularPromiseProviderInstance:c.jQueryPromiseProviderInstance;l=!n.$&&n.angular?c.angularAjaxProviderInstance:c.jQueryAjaxProviderInstance;var a=c.jsonSerializationServiceInstance,v=u.arraySetBehaviour.NotAllowed,y=u.serviceTypes.WebApi,p=c.defaultDateConverterInstance,w,e={};return e.autoFixScalar=!0,e.autoFixPlural=!1,e.validateOnMerge=!0,e.validateOnSave=!0,e.liveValidate=!0,e.handleUnmappedProperties=!0,e.isCaseSensitive=!1,e.ignoreWhiteSpaces=!1,e.forceUpdate=!1,e.cacheMetadata=!0,e.registerMetadataTypes=!0,e.workAsync=!0,e.ajaxTimeout=null,e.minimizePackage=!1,e.getObservableProvider=function(){return s},e.setObservableProvider=function(n){s=o(n,i.ObservableProviderBase,u.observableProviders)},e.getPromiseProvider=function(){return h},e.setPromiseProvider=function(n){h=o(n,i.PromiseProviderBase,u.promiseProviders)},e.getAjaxProvider=function(){return l},e.setAjaxProvider=function(n){l=o(n,i.AjaxProviderBase,u.ajaxProviders)},e.getSerializationService=function(){return a},e.setSerializationService=function(n){a=o(n,i.SerializationServiceBase)},e.getArraySetBehaviour=function(){return v},e.setArraySetBehaviour=function(n){v=o(n,null,u.arraySetBehaviour)},e.getDefaultServiceType=function(){return y},e.setDefaultServiceType=function(n){y=o(n,null,u.serviceTypes)},e.getDateConverter=function(){return p},e.setDateConverter=function(n){t.assertPrm(n,"converter").isInstanceOf(n,i.DateConverterBase).check();p=n},e.getLocalizeFunction=function(){return w},e.setLocalizeFunction=function(n){t.assertPrm(n,"func").isFunction().check();w=n},e}(),r=function(){return n.beetleI18N==null&&(n.beetleI18N={argCountMismatch:'Argument count mismatch for "%0".',arrayEmpty:"The array does not contain any element.",arrayNotSingle:"The array does not contain exactly one element.",arrayNotSingleOrEmpty:"The array does not contain zero or one element.",assignError:"Cannot set %0 property with %1.",assignErrorNotEntity:"Cannot set %0 property, value is not an entity.",autoGeneratedCannotBeModified:"Auto generated properties cannot be modified.",beetleQueryChosenMultiTyped:"Beetle query string is used because query is multi-typed.",beetleQueryChosenPost:"Beetle query string is used because query method is POST.",beetleQueryNotSupported:"Beetle queries are not supported, you may use only OData query parameters (where, orderBy, select, expand, top, skip).",cannotBeEmptyString:"%0 value can not be empty string.",cannotCheckInstanceOnNull:"Cannot check instance on null value.",cannotDetachComplexTypeWithOwners:"Complex types with owners cannot be detached.",compareError:"%0 property value must be equal with %1.",complexCannotBeNull:"%0 complex property can not be null.",couldNotLoadMetadata:"Could not load metadata.",couldNotLocateNavFixer:"Could not locate any observable provider.",couldNotLocatePromiseProvider:"Could not locate any promise provider.",couldNotParseToken:"Could not parse %0.",countDiffCantBeCalculatedForGrouped:'In-line count difference can not be calculated when query contains a "groupBy" expression',dataPropertyAlreadyExists:"Data property already exists: %0.",entityAlreadyBeingTracked:"Entity is already being tracked by another manager.",entityNotBeingTracked:"Entity is not being tracked by a manager.",executionBothNotAllowedForNoTracking:"Execution strategy cannot be Both when merge strategy is NoTracking or NoTrackingRaw.",expressionCouldNotBeFound:"Expression could not be found.",functionNeedsAlias:"%0 function needs alias to work properly. You can set alias like Linq, p => p.Name.",functionNotSupportedForOData:"OData does not support %0 function.",instanceError:"%0 is not an instance of %1.",invalidArguments:"Invalid arguments.",invalidDefaultValue:"%0 is not a valid default value for %0.",invalidEnumValue:"Invalid enum value, %0 cannot be found in %1.",invalidExpression:"%0 can only have %1 type expressions.",invalidPropertyAlias:"Invalid property alias.",invalidStatement:"Invalid statement.",invalidValue:"Invalid value for %0 property.",managerInvalidArgs:"Invalid arguments. Valid args are: {DataService, [Injections]} or {Uri, [Metadata], [Injections]}.",maxLenError:"%0 property length cannot exceed %1.",maxPrecisionError:"Value %0 exceeded maximum precision of %1.",mergeStateError:"Cannot merge entities with %0 state.",minLenError:"%0 property length must be greater than %1.",noMetadataEntityQuery:"Cannot create entity query when no metadata is available.",noMetadataRegisterCtor:"Cannot register constructor when no metadata is available.",noOpenGroup:"Could not find any open group.",notFoundInMetadata:"Could not find %0 in metadata.",notImplemented:"%0 %1 is not implemented.",notNullable:"Cannot set %0 with null, property is not nullable.",oDataNotSupportMultiTyped:"Multi-Typed queries cannot be used for OData services.",odataDoesNotSupportAlias:"OData services does not support query alias and primitive typed resources.",onlyManagerCreatedCanBeExecuted:"Only queries which are created from a manager can be directly executed.",onlyManagerCreatedCanAcceptEntityShortName:"Only queries which are created from a manager can accept entity type short name parameter.",pendingChanges:"Pending changes",pluralNeedsInverse:"To load plural relations, navigation property must have inverse.",projectionsMustHaveAlias:"All projected values must have a property name or alias.",propertyNotFound:"Could not find property: %0.",queryClosed:"Query is closed, expression cannot be added. Queries must be executed after some expressions like first, single, any, all etc..",rangeError:"%0 property value must be between %1 and %2.",requiredError:"%0 property is required.",sameKeyExists:"There is already an entity with same key in the manager.",sameKeyOnDifferentTypesError:"Two different types of entities cannot have same keys when they are from same inheritance root (%0, %1).",settingArrayNotAllowed:"Setting array property is not allowed, you may change this via beetle.settings.setArraySetBehaviour(behavior).",stringLengthError:"%0 property length must be between %1 and %2.",syncNotSupported:"%0 does not support sync ajax calls.",twoEndCascadeDeleteNotAllowed:"Two-end cascade deletes are not supported.",typeError:"%0 type is not %1.",typeMismatch:"%0 value type mismatch. expected type: %1, given type: %2, value: %3",typeRequiredForLocalQueries:'To execute queries locally, entity type must be provided (createQuery("Entities", "Entity") or createEntityQuery("Entity")).',unclosedQuote:'Unclosed quote in "%0".',unclosedToken:'Unclosed "%0".',unexpectedProperty:'Unexpected property "%0".',unexpectedToken:"Unexpected %0.",unknownDataType:"Unknown data type: %0.",unknownExpression:"Unknown expression.",unknownFunction:"Unknown function: %0.",unknownParameter:"Unknown parameter: %0.",unknownValidator:"Unknown validator type: %0.",unsoppertedState:"Unsupported entity state: %0.",validationErrors:"Validation errors",validationFailed:"Validation failed.",valueCannotBeNull:"Value cannot be null: %0.",operatorNotSupportedForOData:"Operator is not supported for OData: %0."}),n.beetleI18N}(),y=function(){return{version:"2.0",i18N:r,helper:t,assert:f,libs:h,baseTypes:i,impls:c,metadata:l,querying:o,core:e,services:v,enums:u,events:a,settings:s,MetadataManager:l.MetadataManager,EntityManager:e.EntityManager,WebApiService:v.WebApiService,MvcService:v.MvcService,Event:e.Event,Validator:e.Validator,ValueNotifyWrapper:e.ValueNotifyWrapper,entityStates:u.entityStates,filterOps:u.filterOps,mergeStrategy:u.mergeStrategy,executionStrategy:u.executionStrategy,arraySetBehaviour:u.arraySetBehaviour,serviceTypes:u.serviceTypes}}();return t.tryFreeze(y),n.beetle=y,y})(window);