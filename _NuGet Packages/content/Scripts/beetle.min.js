(function(n,t){var i={jQuery:n.$,angularjs:n.angular,ko:n.ko,Q:n.Q},e,r,u,f;if(typeof exports=="object"){try{i.jQuery=require("jQuery")}catch(o){}try{i.angularjs=require("angular")}catch(o){}try{i.ko=require("ko")}catch(o){}try{i.Q=require("Q")}catch(o){}try{i.http=require("http");i.https=require("https")}catch(o){}try{e=require("@angular/core");r=require("@angular/http");require("rxjs/add/operator/toPromise");i.angularHttp=e.ReflectiveInjector.resolveAndCreate([r.Http,r.BrowserXhr,{provide:r.ConnectionBackend,useClass:r.XHRBackend},{provide:r.RequestOptions,useClass:r.BaseRequestOptions},{provide:r.ResponseOptions,useClass:r.BaseResponseOptions},{provide:r.XSRFStrategy,useValue:new r.CookieXSRFStrategy}]).get(r.Http);i.AngularHeaders=r.Headers}catch(o){console.log(o)}return module.exports=t(n,i.jQuery,i.angularjs,i.ko,i.Q,i.http,i.https,i.angularHttp,i.AngularHeaders),module.exports}if(typeof define=="function"&&define.amd){u=[];for(f in i)require.specified(f)&&u.push(f);define(u,function(){for(var f,r=0;r<arguments.length;r++)f=arguments[r],f&&(i[u[r]]=f);n.beetle=t(n,i.jQuery,i.angularjs,i.ko,i.Q)})}else return n.beetle=t(n,i.jQuery,i.angularjs,i.ko,i.Q),n.beetle})(this,function(n,t,i,r,u,f,e,o,s,h){"use strict";var c=function(){return{assertPrm:function(n,t){return new v(n,t)},combine:function(n,t){var i,u,r;if(n==t)return n;if(i={},n!=null)for(u in n)i[u]=n[u];if(t!=null)for(r in t){var e=i[r],f=t[r],o=v.isTypeOf(e,"object")&&v.isTypeOf(f,"object")?c.combine(e,f):f;i[r]=o}return i},extend:function(n,t){if(n!=null&&t!=null)for(var i in t)n.hasOwnProperty(i)||(n[i]=t[i])},objEquals:function(n,t){var r,u,i,f;if(n==t)return!0;if(n==null||t==null)return!1;if(v.isObject(n)&&v.isObject(t)){r=0;u=0;for(i in n){if(!(i in t)||c.getValue(n,i)!=c.getValue(t,i))return!1;r++}for(f in t)u++;return r==u}return!1},isCaseSensitive:function(n){var t=n&&n.isCaseSensitive;return t==null?b.isCaseSensitive:t},ignoreWhiteSpaces:function(n){var t=n&&n.ignoreWhiteSpaces;return t==null?b.ignoreWhiteSpaces:t},handleStrOptions:function(n,t){return n==null||typeof n!="string"?n:(c.isCaseSensitive(t)||(n=n.replace("İ","i"),n=n.toLowerCase(),n=n.replace("ı","i")),c.ignoreWhiteSpaces(t)&&(n=n.trim()),n)},equals:function(n,t,i,r){return typeof n=="string"&&typeof t=="string"&&(n=c.handleStrOptions(n,r),t=c.handleStrOptions(t,r)),n!=null&&t!=null&&p.dataTypes.date.isValid(n)&&p.dataTypes.date.isValid(t)&&(n=n.valueOf(),t=t.valueOf()),i?n===t:n==t},formatString:function(n){var t=arguments,i=RegExp("%([0-"+(arguments.length-1)+"])","g"),r=RegExp("{([0-"+(arguments.length-2)+"])}","g");return n.replace(i,function(n,i){return t[Number(i)+1]||""}).replace(r,function(n,i){return t[Number(i)+1]||""})},tryFreeze:function(n,t){var r,i;if(!n||!Object.freeze)return n;if(Object.freeze(n),t===!0)for(r in n)i=n[r],v.isArray(i)?this.tryFreezeArray(i,t):v.isObject(i)&&this.tryFreeze(i,t);return n},tryFreezeArray:function(n,t){if(n&&Object.freeze)for(var i=0;i<n.length;i++)this.tryFreeze(n[i],t)},indexOf:function(n,t,i){for(var r=i||0;r<n.length;r++)if(n[r]===t)return r;return-1},forEach:function(n,t){for(var r,i=0;i<n.length;i++)r=n[i],t.call(null,r,i)},forEachProperty:function(n,t){var i,r;for(i in n)i[0]!="$"&&((r=n[i],v.isFunction(r))||t(i,r))},findInArray:function(n,t,i){for(var r=0;r<n.length;r++)if(i){if(n[r][i]===t)return n[r]}else if(n[r]===t)return t;return null},filterArray:function(n,t){for(var r,u=[],i=0;i<n.length;i++)r=n[i],t(r)===!0&&u.push(r);return u},removeFromArray:function(n,t,i){var r=[],u;for(this.forEach(n,function(n,u){i?n[i]===t&&r.push(u):n===t&&r.push(u)}),u=r.length-1;u>=0;u--)n.splice(r[u],1);return r.length},mapArray:function(n,t){for(var r,u=[],i=0;i<n.length;i++)r=n[i],u.push(t.call(r,r,i));return u},createGuid:function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()},funcToLambda:function(n){var f,i,r,e,u;c.assertPrm(n,"func").isFunction().check();var t=n.toString().replace(/function(.*?){/g,"$1=>").replace(/{|}|;|return /g,"").trim(),o=t.indexOf("=>"),s=t.substr(0,o).trim();for(t=t.substr(o+2).trim(),f=t.split(","),i=[],r=0;r<f.length;r++)e=f[r],u=e.split(":"),u.length>1?i.push(u[1].trim()+" as "+u[0].trim()):i.push(e.trim());return t=i.join(", "),s?s+" => "+t:t},getFuncName:function(n){var t=/function (.*?)[\s|\(]|class (.*?)\s|\{/.exec(n.toString());return t[1]||t[2]},inherit:function(n,t){var i=new Function;i.prototype=t.prototype;n.prototype=new i;n.prototype.constructor=n;n.baseClass=t.prototype},getValue:function(n,t){function e(n,t){var i=n.$tracker;return i?i.getValue(t):u.isObservable(n,t)?u.getValue(n,t):n[t]}var r;if(n==null)return undefined;var u=b.getObservableProvider(),f=t.trim().split("."),i=n;for(r=0;r<f.length;r++)if(i=e(i,f[r]),i==null)break;return i},getResourceValue:function(n,t){var i=b.getLocalizeFunction();return i&&n&&i(n)||t},createValidationError:function(n,t,i,r,u){var f={message:r,entity:n,validator:u,value:t,property:i};return this.tryFreeze(f)},createError:function(n,t,i){var r=null,u=i,f,e;if(v.isArray(t)?r=t:v.isObject(t)&&(u=t),r&&r.length>0&&(r.splice(0,0,n),n=c.formatString.apply(null,r)),f=new Error(n),u)for(e in u)f[e]=u[e];return nt.error.notify(f),f},runSelectExp:function(n,t,i){if(n.length==0)return n;t=k.jsep(t);var r=t.type=="Compound"?t.body:[t],u=c.jsepToProjector(r,i);return c.mapArray(n,u)},setForeignKeys:function(n,t,i){for(var u,f,e,o,s,r=0;r<t.foreignKeyNames.length;r++)u=t.foreignKeyNames[r],f=n.$tracker,i?(e=i.$tracker.entityType.keys[r],o=i.$tracker.getValue(e.name),f.setValue(u,o)):(s=c.findInArray(f.entityType.dataProperties,u,"name"),f.setValue(u,s.getDefaultValue()))},createTrackableArray:function(n,t,i,r){function f(n,t){var u=t.object,i=t.property,r;i&&(u.$tracker&&u.$tracker.manager&&(r=u.$tracker.manager.handleUnmappedProperties),r==null&&(r=b.handleUnmappedProperties),v.isInstanceOf(i,d.NavigationProperty)?c.forEach(n,function(n){i.checkAssign(n)}):v.isInstanceOf(i,d.DataProperty)?c.forEach(n,function(t,r){n[r]=i.handle(t)}):r===!0&&c.forEach(n,function(t,i){n[i]=p.dataTypes.handle(t)}))}var u=n||[];return u.object=t,u.property=i,u.after=r,u.changing=new p.Event(i+"ArrayChanging",u),u.changed=new p.Event(i+"ArrayChanged",u),u.pop=function(){var n=[this[this.length-1]],t;return this.changing.notify({added:[],removed:n}),t=Array.prototype.pop.call(this),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),t},u.push=function(){this.changing.notify({added:arguments,removed:[]});f(arguments,this);var n=Array.prototype.push.apply(this,arguments);return this.after(this.object,this.property,this,null,arguments),this.changed.notify({added:arguments,removed:[]}),n},u.unshift=function(){this.changing.notify({added:arguments,removed:[]});f(arguments,this);var n=Array.prototype.unshift.apply(this,arguments);return this.after(this.object,this.property,this,null,arguments),this.changed.notify({added:arguments,removed:[]}),n},u.shift=function(){var n=[this[0]],t;return this.changing.notify({added:[],removed:n}),t=Array.prototype.shift.call(this),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),t},u.splice=function(n,t){var i,r,u;return t=t||this.length,i=null,arguments.length>2&&(i=Array.prototype.slice.call(arguments).slice(2)),r=this.slice(n,n+t),this.changing.notify({added:i,removed:r}),i&&f(i,this),u=Array.prototype.splice.apply(this,arguments),this.after(this.object,this.property,this,r,i),this.changed.notify({added:i,removed:r}),u},u.remove=function(){var n=[],t;return this.changing.notify({added:[],removed:arguments}),t=this,c.forEach(arguments,function(i){var r=c.indexOf(t,i);r>=0&&(Array.prototype.splice.call(t,r,1),n.push(i))}),this.after(this.object,this.property,this,n,null),this.changed.notify({added:[],removed:n}),n},u.load=function(n,t,i,r,u){return this.object.$tracker.loadNavigationProperty(this.propertyName,n,t,i,r,u)},u},jsepToODataQuery:function(n,t,i){var ft,d,g,nt,s,u,o,v,ut,b,k,ot;if(i=i||n,t?t.aliases||(t.aliases=[]):t={aliases:[]},n.type=="LogicalExpression"||n.type=="BinaryExpression"){if(n.operator=="=>"){if(n!=i)throw c.createError(a.odataDoesNotSupportAlias);return t.aliases.push({alias:n.left.name,value:null}),ft=c.jsepToODataQuery(n.right,t,i),n!=i&&t.aliases.pop(),ft}if(d=y.langOperators.find(n.operator).oData,!d)throw c.createError(a.operatorNotSupportedForOData,[n.operator],{expression:n});return"("+c.jsepToODataQuery(n.left,t,i)+" "+d+" "+c.jsepToODataQuery(n.right,t,i)+")"}if(n.type=="UnaryExpression")return n.operator+c.jsepToODataQuery(n.argument,t,i);if(n.type=="Identifier"){var r=n.name,h=undefined,et=!1;if(r[0]=="@"&&(et=!0,r=r.slice(1)),t.expVarContext&&t.expVarContext[r]!==undefined?h=t.expVarContext[r]:t.varContext&&t.varContext[r]!==undefined&&(h=t.varContext[r]),h!==undefined)return p.dataTypes.toODataValue(h);if(et)throw c.createError(a.unknownParameter,[r],{expression:n,queryContext:t});return(g=c.findInArray(t.aliases,r,"alias"),g)?g.value:r}if(n.type=="Literal")return p.dataTypes.toODataValue(n.value);if(n.type=="MemberExpression")return t.currentAlias&&n.object.name==t.currentAlias.alias?n.property.name:(nt=c.findInArray(t.aliases,n.object.name,"alias"),s=nt?nt.value:c.jsepToODataQuery(n.object,t,i),s&&s[n.property.name]!==undefined)?p.dataTypes.toODataValue(s[n.property.name]):s?s+"/"+n.property.name:n.property.name;if(n.type=="Compound"){for(u=[],o=0;o<n.body.length;o++){var tt=n.body[o],it=c.jsepToODataQuery(tt,t),rt=it.toLowerCase();if(rt=="desc"||rt=="asc"){if(u.length==0)throw c.createError(a.invalidStatement,{expression:n,statement:tt});u[u.length-1]+=" "+it}else if(rt=="as"){if(u.length==0||n.body.length<o+1)throw c.createError(a.invalidStatement,{expression:n,statement:tt});u[u.length-1]+=" as "+n.body[o+1].name;o++}else u.push(it)}return u.join(", ")}if(n.type=="CallExpression"){var f=n.arguments,l=[],e=null;for(f.length==1&&f[0]&&f[0].type=="BinaryExpression"&&f[0].operator=="=>"&&(e={alias:f[0].left.name},e.value=e.alias,f=[f[0].right]),e&&(t.currentAlias=e,t.aliases.push(e)),v=0;v<f.length;v++)ut=f[v],ut!=null&&l.push(c.jsepToODataQuery(ut,t,i));if(n.callee.type=="MemberExpression"?(l.splice(0,0,c.jsepToODataQuery(n.callee.object,t,i)),b=n.callee.property.name):b=n.callee.name,k=w.queryFuncs.getFunc(b),k.needsAlias==!0)if(e)l.splice(0,0,e);else throw c.createError(a.functionNeedsAlias,[b],{expression:n});return ot=k.toODataFunction.apply(k,l),e&&(t.currentAlias=null,t.aliases.pop()),ot}throw c.createError(a.unknownExpression,{expression:n});},jsepToBeetleQuery:function(n,t,i){var ut,ft,v,b,h,u,e,l,tt,it,rt,ot;if(i=i||n,t?t.aliases||(t.aliases=[]):t={aliases:[]},n.type=="LogicalExpression"||n.type=="BinaryExpression")return n.operator=="=>"?(t.aliases.push({alias:n.left.name,value:"it"}),ut=c.jsepToBeetleQuery(n.right,t,i),n!=i&&t.aliases.pop(),ut):(ft=y.langOperators.find(n.operator).code,"("+c.jsepToBeetleQuery(n.left,t,i)+" "+ft+" "+c.jsepToBeetleQuery(n.right,t,i)+")");if(n.type=="UnaryExpression")return n.operator+c.jsepToBeetleQuery(n.argument,t,i);if(n.type=="Identifier"){var r=n.name,s=undefined,et=!1;if(r[0]=="@"&&(et=!0,r=r.slice(1)),t.expVarContext&&t.expVarContext[r]!==undefined?s=t.expVarContext[r]:t.varContext&&t.varContext[r]!==undefined&&(s=t.varContext[r]),s!==undefined)return p.dataTypes.toBeetleValue(s);if(et)throw c.createError(a.unknownParameter,[r],{expression:n,queryContext:t});return(v=c.findInArray(t.aliases,r,"alias"),v)?v.value:r}if(n.type=="Literal")return p.dataTypes.toBeetleValue(n.value);if(n.type=="MemberExpression")return t.currentAlias&&n.object.name==t.currentAlias.alias?n.property.name:(b=c.findInArray(t.aliases,n.object.name,"alias"),h=b?b.value:c.jsepToBeetleQuery(n.object,t,i),h[n.property.name]!==undefined)?p.dataTypes.toBeetleValue(h[n.property.name]):h+"."+n.property.name;if(n.type=="Compound"){for(u=[],e=0;e<n.body.length;e++){var k=n.body[e],d=c.jsepToBeetleQuery(k,t),g=d.toLowerCase();if(g=="desc"||g=="asc"){if(u.length==0)throw c.createError(a.invalidStatement,{expression:n,statement:k});u[u.length-1]+=" "+d}else if(g=="as"){if(u.length==0||n.body.length<e+1)throw c.createError(a.invalidStatement,{expression:n,statement:k});u[u.length-1]+=" as "+n.body[e+1].name;e++}else u.push(d)}return u.join(", ")}if(n.type=="CallExpression"){var f=n.arguments,nt=[],o=null;for(f.length==1&&f[0]&&f[0].type=="BinaryExpression"&&f[0].operator=="=>"&&(o={alias:f[0].left.name},o.value=o.alias,f=[f[0].right]),o&&(t.currentAlias=o,t.aliases.push(o)),l=0;l<f.length;l++)tt=f[l],tt!=null&&nt.push(c.jsepToBeetleQuery(tt,t,i));return n.callee.type=="MemberExpression"?(nt.splice(0,0,c.jsepToBeetleQuery(n.callee.object,t,i)),it=n.callee.property.name):it=n.callee.name,rt=w.queryFuncs.getFunc(it),ot=rt.toBeetleFunction.apply(rt,nt),o&&(t.currentAlias=null,t.aliases.pop()),ot}throw c.createError(a.unknownExpression,{expression:n});},jsepToFunction:function(n,t){return function(i){var nt,it,rt,r,h,l,b,k,d,o,g,e,s,p;if(t?t.aliases||(t.aliases=[]):t={aliases:[]},t.currentAlias&&(t.currentAlias.value=i),n.type===undefined)return i;if(n.type=="LogicalExpression"||n.type=="BinaryExpression"){if(n.operator=="=>")return t.currentAlias&&t.aliases.push(t.currentAlias),t.currentAlias={alias:n.left.name},nt=c.jsepToFunction(n.right,t)(i),t.currentAlias=t.aliases.pop(),nt;var ut=y.langOperators.find(n.operator),tt=t.varContext,ft=function(){return c.jsepToFunction(n.left,t)(i)},et=function(){return c.jsepToFunction(n.right,t)(i)};return ut.asFunc.call(tt,ft,et)}if(n.type=="UnaryExpression")return it=function(){return c.jsepToFunction(n.argument,t)(i)},rt=y.langOperators.find(n.operator),rt.asFunc.call(tt,it);if(n.type=="Identifier"){if(r=n.name,r=="null")return null;if(r=="true")return!0;if(r=="false")return!1;if(r[0]=="@"){if(h=undefined,l=r.slice(1),t.expVarContext&&t.expVarContext[l]!==undefined?h=t.expVarContext[l]:t.varContext&&(h=t.varContext[l]),h===undefined)throw c.createError(a.unknownParameter,[r],{expression:n,queryContext:t});return h}return t.currentAlias&&t.currentAlias.alias==r?i:(b=c.findInArray(t.aliases,r,"alias"),b)?b.value:(k=c.getValue(i,r),k===undefined)?window[r]:k}if(n.type=="Literal")return n.value;if(n.type=="MemberExpression"){if(n.object.name){if(t.currentAlias&&n.object.name==t.currentAlias.alias)return c.getValue(i,n.property.name);if(d=c.findInArray(t.aliases,n.object.name,"alias"),d)return c.getValue(d.value,n.property.name)}return c.getValue(c.jsepToFunction(n.object,t)(i),n.property.name)}if(n.type=="CallExpression"){var u=n.arguments,f=[],v=null;if(u.length==1&&u[0]&&u[0].type=="BinaryExpression"&&u[0].operator=="=>"&&(v=u[0].left.name,u=[u[0].right]),v&&(t.currentAlias&&t.aliases.push(t.currentAlias),t.currentAlias={alias:v}),c.forEach(u,function(n){n!=null&&f.push(c.jsepToFunction(n,t))}),o=n.callee.type=="MemberExpression"?n.callee.property.name:n.callee.name,e=w.queryFuncs.getFunc(o,!1),e)n.callee.type=="MemberExpression"&&f.splice(0,0,c.jsepToFunction(n.callee.object,t)),f.splice(0,0,i),g=e.impl.apply(t,f);else{if(o[0]=="@")if(s=o.slice(1),t.expVarContext&&t.expVarContext[s])e=t.expVarContext[s];else if(t.varContext&&t.varContext[s])e=t.varContext[s];else throw c.createError(a.unknownParameter,[s],{expression:n,queryContext:t});else if(p=n.callee.type=="MemberExpression"?c.jsepToFunction(n.callee.object,t)(i):window,p==null||(e=p[o])==null)throw c.createError(a.unknownFunction,[o]);f=c.mapArray(f,function(){return this(i)});g=e.apply(p,f)}return v&&(t.currentAlias=t.aliases.pop()),g}throw c.createError(a.unknownExpression,{expression:n});}},jsepToProjector:function(n,t){var e=[],i,r,u,f;for(v.isArray(n)||(n=[n]),i=0;i<n.length;i++){r=null;u=n[i];switch(u.type){case"Identifier":r=u.name;break;case"MemberExpression":r=u.property.name}if(n.length>i+2&&n[i+1].name&&n[i+1].name.toLowerCase()=="as"){if(i=i+2,f=n[i],f.type!="Identifier")throw c.createError(a.invalidPropertyAlias,{expressions:n,aliasExpression:f});r=f.name}if(n.length>1&&!r)throw c.createError(a.projectionsMustHaveAlias,{expressions:n,expression:u});e.push({p:r,func:c.jsepToFunction(u,t)})}return function(t){for(var r,u,f={},i=0;i<e.length;i++){if(r=e[i],u=r.func(t),n.length==1)return u;f[r.p]=u}return f}}}}(),v=function(){var n=function(n,t){this.value=n;this.name=t;this.errors=[];c.tryFreeze(this)},t=n.prototype;return t.hasValue=function(){return n.hasValue(this.value,this.errors,this.name),this},t.isObject=function(){return n.isObject(this.value,this.errors,this.name),this},t.isFunction=function(){return n.isFunction(this.value,this.errors,this.name),this},t.isNotEmptyString=function(){return n.isNotEmptyString(this.value,this.errors,this.name),this},t.isTypeOf=function(t){return n.isTypeOf(this.value,t,this.errors,this.name),this},t.isArray=function(){return n.isArray(this.value,this.errors,this.name),this},t.isEnum=function(t){return n.isEnum(this.value,t,this.errors,this.name),this},t.isInstanceOf=function(t){return n.isInstanceOf(this.value,t,this.errors,this.name),this},t.check=function(){if(this.errors.length>0)throw c.createError(this.errors.join("\n"),{name:this.name,value:this.value});},n.hasValue=function(n,t,i){return n==null?(t&&t.push(c.formatString(a.valueCannotBeNull,i)),!1):!0},n.isObject=function(n,t,i){return n==null||!p.dataTypes.object.isValid(n)?(t&&t.push(c.formatString(a.typeError,i,"object")),!1):!0},n.isFunction=function(n,t,i){return n==null||!p.dataTypes.func.isValid(n)?(t&&t.push(c.formatString(a.typeError,i,"function")),!1):!0},n.isNotEmptyString=function(t,i,r){return t==null||t===""||!n.isTypeOf(t,"string",i)?(i&&i.push(c.formatString(a.cannotBeEmptyString,r)),!1):!0},n.isTypeOf=function(t,i,r,u){if(!n.hasValue(t))return!1;var f=p.dataTypes.byName(i);return f.isValid(t)?!0:(r&&r.push(c.formatString(a.typeMismatch,u,i,f,t)),!1)},n.isArray=function(n,t,i){return n==null||!p.dataTypes.array.isValid(n)?(t&&t.push(c.formatString(a.typeError,i,"array")),!1):!0},n.isEnum=function(n,t,i){return t.contains(n)?!0:(i&&i.push(c.formatString(a.invalidEnumValue,t,n)),!1)},n.isInstanceOf=function(n,t,i,r){return n==null?(i&&i.push(a.cannotCheckInstanceOnNull),!1):(n instanceof t)?!0:(i&&i.push(c.formatString(a.instanceError,r,t)),!1)},n}(),k=function(){var n={};return n.Enum=function(){function i(n,t){for(var i in t)n[i]=t[i];return n}function n(n,t){this.name=n;t&&i(this,t);c.tryFreeze(this)}n.prototype={};n.prototype.constructor=n;n.prototype.toString=function(){return this.name};c.tryFreeze(n.prototype);var t=function(t){var r=this,i;if(arguments.length===1&&t!==null&&typeof t=="object")for(i in t)r[i]=new n(i,t[i]);else c.forEach(arguments,function(t){r[t]=new n(t)});c.tryFreeze(this)};return t.prototype.symbols=function(){var t=[],i,n;for(i in this)(n=this[i],v.isFunction(n))||t.push(n);return t},t.prototype.contains=function(t){return(t instanceof n)?this[t.name]===t:!1},t}(),n.jsep=function(){var c="Compound",p="Identifier",l="MemberExpression",o="Literal",w="ThisExpression",b="CallExpression",k="UnaryExpression",d="BinaryExpression",g="LogicalExpression",i=!0,r={"-":i,"!":i,"~":i,"+":i},t={"=>":0,"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},e=function(n){var t=0,i;for(var r in n)(i=r.length)>t&&n.hasOwnProperty(r)&&(t=i);return t},s=e(r),u=e(t),a={"true":!0,"false":!1,"null":null},nt="this",v=function(n){return t[n]||0},y=function(n,t,i){var r=n==="||"||n==="&&"?g:d;return{type:r,operator:n,left:t,right:i}},f=function(n){return n>=48&&n<=57},h=function(n){return n===36||n===95||n===64||n>=65&&n<=90||n>=97&&n<=122},tt=function(n){return n===36||n===95||n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57},n=function(n){for(var i=0,ct=n.charAt,lt=n.charCodeAt,e=function(t){return ct.call(n,t)},d=function(t){return lt.call(n,t)},it=n.length,g=function(){for(var n=d(i);n===32||n===9;)n=d(++i)},ot=function(){g();for(var r=n.substr(i,u),f=r.length;f>0;){if(t.hasOwnProperty(r))return i+=f,r;r=r.substr(0,--f)}return!1},rt=function(){var r,t,o,n,s,f,e,u;if(f=ut(),t=ot(),!t)return f;if(s={value:t,prec:v(t)},e=ut(),!e)throw new Error("Expected expression after "+t+" at character "+i);for(n=[f,s,e];t=ot();){if(o=v(t),o===0)break;for(s={value:t,prec:o};n.length>2&&o<=n[n.length-2].prec;)e=n.pop(),t=n.pop().value,f=n.pop(),r=y(t,f,e),n.push(r);if(r=ut(),!r)throw new Error("Expected expression after "+t+" at character "+i);n.push(s);n.push(r)}for(u=n.length-1,r=n[u];u>1;)r=y(n[u-1].value,n[u-2],r),u-=2;return r},ut=function(){var t,u,e;if(g(),t=d(i),f(t)||t===46)return at();if(t===39||t===34)return vt();if(h(t))return pt();if(t===40)return wt();for(u=n.substr(i,s),e=u.length;e>0;){if(r.hasOwnProperty(u))return i+=e,{type:k,operator:u,argument:ut(),prefix:!0};u=u.substr(0,--e)}return!1},at=function(){for(var n="";f(d(i));)n+=e(i++);if(e(i)===".")for(n+=e(i++);f(d(i));)n+=e(i++);if(e(i)==="e"||e(i)==="E"){for(n+=e(i++),(e(i)==="+"||e(i)==="-")&&(n+=e(i++));f(d(i));)n+=e(i++);if(!f(d(i-1)))throw new Error("Expected exponent ("+n+e(i)+") at character "+i);}if(h(d(i)))throw new Error("Variable names cannot start with a number ("+n+e(i)+") at character "+i);return{type:o,value:parseFloat(n),raw:n}},vt=function(){for(var n="",r=e(i++),u=!1,t;i<it;)if(t=e(i++),t===r){u=!0;break}else if(t==="\\"){t=e(i++);switch(t){case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\x0b"}}else n+=t;if(!u)throw new Error('Unclosed quote after "'+n+'"');return{type:o,value:n,raw:r+n+r}},st=function(){var r=d(i),u=i,t;if(h(r))i++;else throw new Error("Unexpected "+e(i)+"at character "+i);while(i<it)if(r=d(i),tt(r))i++;else break;return t=n.slice(u,i),a.hasOwnProperty(t)?{type:o,value:a[t],raw:t}:t===nt?{type:w}:{type:p,name:t}},yt=function(){for(var t,r=[],n;i<it;)if(g(),t=e(i),t===")"){i++;break}else if(t===",")i++;else{if(n=rt(),!n||n.type===c)throw new Error("Expected comma at character "+i);r.push(n)}return r},pt=function(){var n,t,r;for(t=st(),g(),n=e(i);n==="."||n==="["||n==="(";){if(n===".")i++,g(),t={type:l,computed:!1,object:t,property:st()};else if(n==="["){if(r=i,i++,t={type:l,computed:!0,object:t,property:rt()},g(),n=e(i),n!=="]")throw new Error("Unclosed [ at character "+i);i++;g()}else n==="("&&(i++,t={type:b,arguments:yt(),callee:t});g();n=e(i)}return t},wt=function(){i++;var n=rt();if(g(),e(i)===")")return i++,n;throw new Error("Unclosed ( at character "+i);},ft=[],et,ht;i<it;)if(et=e(i),et===";"||et===",")i++;else if(ht=rt())ft.push(ht);else if(i<it)throw new Error("Unexpected '"+e(i)+"' at character "+i);return ft.length===1?ft[0]:{type:c,body:ft}};return n.version="0.2.8",n.toString=function(){return"JavaScript Expression Parser (JSEP) v"+n.version},n.addUnaryOp=function(n){return r[n]=i,this},n.addBinaryOp=function(n,i){return u=Math.max(n.length,u),t[n]=i,this},n.removeUnaryOp=function(n){return delete r[n],n.length===s&&(s=e(r)),this},n.removeBinaryOp=function(n){return delete t[n],n.length===u&&(u=e(t)),this},n}(),n}(),l=function(){return{DateConverterBase:function(){var t=function(n){this.name=n},n=t.prototype;return n.toString=function(){return this.name},n.parse=function(){throw c.createError(a.notImplemented,["DateConverterBase","parse"]);},n.toISOString=function(){throw c.createError(a.notImplemented,["DateConverterBase","toISOString"]);},t}(),DataTypeBase:function(){var t=function(n){this.name=n||"DataTypeBase";this.isComplex=!1},n=t.prototype;return n.toString=function(){return this.name},n.getRawValue=function(n){return n},n.isValid=function(n){return typeof n===this.name},n.toODataValue=function(n){return n.toString()},n.toBeetleValue=function(n){return n.toString()},n.defaultValue=function(){throw c.createError(a.notImplemented,[this.name,"defaultValue"]);},n.autoValue=function(){throw c.createError(a.notImplemented,[this.name,"autoValue"]);},n.handle=function(){throw c.createError(a.notImplemented,[this.name,"handle"]);},t}(),ExpressionBase:function(){var t=function(n,t,i,r){this.name=n||"ExpressionBase";this.order=t;this.onlyBeetle=i;this.isProjection=r},n=t.prototype;return n.toString=function(){return this.toBeetleQuery({})},n.toODataQuery=function(n){if(this.onlyBeetle===!0)return this.toBeetleQuery(n);var t=v.isFunction(this.exp)?c.funcToLambda(this.exp):this.exp;return c.jsepToODataQuery(k.jsep(t),n)},n.toBeetleQuery=function(n){if(!this.exp)return"";var t=v.isFunction(this.exp)?c.funcToLambda(this.exp):this.exp;return c.jsepToBeetleQuery(k.jsep(t),n)},n.clone=function(){throw c.createError(a.notImplemented,[this.name,"clone"]);},n.execute=function(){throw c.createError(a.notImplemented,[this.name,"execute"]);},t}(),QueryFuncBase:function(){var t=function(n,t,i){this.name=n;this.beetleName=t;this.argCount=i},n=t.prototype;return n.toODataFunction=function(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);return this.name+"("+t.join(", ")+")"},n.toBeetleFunction=function(){var i="",n=0,t;for(arguments.length==this.argCount&&(i=arguments[0]+".",++n),t=[],n;n<arguments.length;n++)t.push(arguments[n]);return i+this.beetleName+"("+t.join(", ")+")"},n.impl=function(){throw c.createError(a.notImplemented,[this.name,"impl"]);},t}(),QueryBase:function(){var t=function(){this.expressions=[];this.inlineCountEnabled=!1;this.lastExpOrder=0;this.isMultiTyped=!1;this.lastProjection=0;this.isClosed=!1;this.hasBeetlePrm=!1;this.options=null},n=t.prototype;return n.executeAfterExecuter=!1,n.toString=function(){var n=[],t;return c.forEach(this.parameters,function(t){n.push(t.name+": "+(t.value==null?"":t.value))}),this.inlineCountEnabled===!0&&n.push("inlinecount: allpages"),t={},c.forEach(this.expressions,function(i){t.expVarContext=i.varContext;n.push(i.name+": "+i.toBeetleQuery(t));t.expVarContext=undefined}),n.join(", ")},n.addExpression=function(n){if(this.isClosed)throw c.createError(a.queryClosed,null,{query:this});if(c.assertPrm(n,"expression").isInstanceOf(l.ExpressionBase).check(),this.expressions.push(n),n.isExecuter===!0){var t=this.options&&this.options.executeAfterExecuter;if(t==null&&(t=this.executeAfterExecuter),t)return this.execute();this.isClosed=!0}return(n.order<this.lastExpOrder||this.hasBeetlePrm&&!n.onlyBeetle)&&(this.isMultiTyped=!0),n.isProjection===!0&&(this.lastProjection=this.expressions.length-1),n.onlyBeetle&&(this.hasBeetlePrm=!0),this},n.inlineCount=function(n){var t=this.clone();return t.inlineCountEnabled=n!==!1,t},n.ofType=function(n){var t=this.clone();return t.addExpression(new w.expressions.OfTypeExp(n))},n.where=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.WhereExp(n,t))},n.orderBy=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.OrderByExp(n,t))},n.orderByDesc=function(n){return this.orderBy(n,!0)},n.select=function(n){var i=this.clone(),t;return arguments.length==1?(t=arguments[0],v.isArray(t)&&(n=t.join(", "))):n=Array.prototype.slice.call(arguments).join(", "),i.addExpression(new w.expressions.SelectExp(n))},n.skip=function(n){var t=this.clone();return t.addExpression(new w.expressions.SkipExp(n))},n.take=function(n){return this.top(n)},n.top=function(n){var t=this.clone();return t.addExpression(new w.expressions.TopExp(n))},n.groupBy=function(n,t){var i=this.clone();return v.isArray(n)&&(n=n.join(", ")),v.isArray(t)&&(t=t.join(", ")),i.addExpression(new w.expressions.GroupByExp(n,t))},n.distinct=function(n){var t=this.clone();return v.isArray(n)&&(n=n.join(", ")),t.addExpression(new w.expressions.DistinctExp(n))},n.reverse=function(){var n=this.clone();return n.addExpression(new w.expressions.ReverseExp)},n.selectMany=function(n){var t=this.clone();return t.addExpression(new w.expressions.SelectManyExp(n))},n.skipWhile=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.SkipWhileExp(n,t))},n.takeWhile=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.TakeWhileExp(n,t))},n.all=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.AllExp(n,t))},n.any=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.AnyExp(n,t))},n.avg=function(n){var t=this.clone();return t.addExpression(new w.expressions.AvgExp(n))},n.max=function(n){var t=this.clone();return t.addExpression(new w.expressions.MaxExp(n))},n.min=function(n){var t=this.clone();return t.addExpression(new w.expressions.MinExp(n))},n.sum=function(n){var t=this.clone();return t.addExpression(new w.expressions.SumExp(n))},n.count=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.CountExp(n,t))},n.first=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.FirstExp(n,t))},n.firstOrDefault=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.FirstOrDefaultExp(n,t))},n.single=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.SingleExp(n,t))},n.singleOrDefault=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.SingleOrDefaultExp(n,t))},n.last=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.LastExp(n,t))},n.lastOrDefault=function(n,t){var i=this.clone();return i.addExpression(new w.expressions.LastOrDefaultExp(n,t))},n.withOptions=function(n){var t=this.clone();return t.options=c.combine(this.options,n),t},n.execute=function(){throw c.createError(a.notImplemented,["Query","execute"]);},n.x=function(){return this.execute.apply(this,arguments)},n.toFunction=function(){var n=this;return function(t,i){var r={varContext:i};return r.aliases=[],n.inlineCountEnabled&&(r.inlineCount=t.length),c.forEach(n.expressions,function(i){r.expVarContext=i.varContext;t=i.execute(t,r);!n.inlineCountEnabled||v.isInstanceOf(i,w.expressions.TopExp)||v.isInstanceOf(i,w.expressions.SkipExp)||(r.inlineCount=t.length);r.expVarContext=undefined}),n.inlineCountEnabled&&(t.$inlineCount=r.inlineCount),t}},n.clone=function(){throw c.createError(a.notImplemented,["Query","clone"]);},n.copy=function(n){c.forEach(this.expressions,function(t){n.expressions.push(t.clone())});n.inlineCountEnabled=this.inlineCountEnabled;n.lastExpOrder=this.lastExpOrder;n.isMultiTyped=this.isMultiTyped;n.lastProjection=this.lastProjection;n.isClosed=this.isClosed;n.hasBeetlePrm=this.hasBeetlePrm;this.options&&(n.options=c.combine(null,this.options))},n.getExpression=function(n,t){for(var r,i=this.lastProjection;i<this.expressions.length;i++)if(r=this.expressions[i],v.isInstanceOf(r,n))return r;if(t===!0)throw c.createError(a.expressionCouldNotBeFound,{type:n,query:this});return null},n.removeExpression=function(n){for(var i,t=this.expressions.length-1;t>=0;t--)i=this.expressions[t],v.isInstanceOf(i,n)&&this.expressions.splice(t,1);return this},t}(),ObservableProviderBase:function(){var t=function(n){this.name=n||"ObservableProviderBase"},n=t.prototype;return n.toString=function(){return this.name},n.isObservable=function(){throw c.createError(a.notImplemented,[this.name,"isObservable"]);},n.toObservable=function(){throw c.createError(a.notImplemented,[this.name,"toObservable"]);},n.getValue=function(){throw c.createError(a.notImplemented,[this.name,"getValue"]);},n.setValue=function(){throw c.createError(a.notImplemented,[this.name,"setValue"]);},t}(),AjaxProviderBase:function(){var t=function(n){this.name=n||"AjaxProviderBase";this.syncSupported=!0},n=t.prototype;return n.toString=function(){return this.name},n.doAjax=function(){throw c.createError(a.notImplemented,[this.name,"doAjax"]);},n.createError=function(n){var t={status:n.status,xhr:n};if(n.responseText)try{t.detail=JSON.parse(n.responseText)}catch(i){}return c.createError(n.statusText,t)},n.getHeaderGetter=function(n){return function(t){return n.getResponseHeader(t)}},t}(),SerializationServiceBase:function(){var t=function(n){this.name=n||"SerializationServiceBase"},n=t.prototype;return n.toString=function(){return this.name},n.serialize=function(){throw c.createError(a.notImplemented,[this.name,"serialize"]);},n.deserialize=function(){throw c.createError(a.notImplemented,[this.name,"deserialize"]);},t}(),PromiseProviderBase:function(){var t=function(n){this.name=n||"PromiseProviderBase"},n=t.prototype;return n.toString=function(){return this.name},n.deferred=function(){throw c.createError(a.notImplemented,[this.name,"deferred"]);},n.getPromise=function(){throw c.createError(a.notImplemented,[this.name,"getPromise"]);},n.resolve=function(){throw c.createError(a.notImplemented,[this.name,"resolve"]);},n.reject=function(){throw c.createError(a.notImplemented,[this.name,"reject"]);},t}(),DataServiceBase:function(){function e(n,t,f,e){if(e._awaitingMetadata=!1,e._readyCallbacks=[],n==null?n="":n[n.length-1]!=="/"&&(n+="/"),e.uri=n,f=f||{},e.ajaxProvider=f.ajaxProvider||b.getAjaxProvider(),e.serializationService=f.serializationService||b.getSerializationService(),e.ajaxTimeout=f.ajaxTimeout,e.dataType=f.dataType||"json",e.contentType=f.contentType||"application/json; charset=utf-8",i=f.registerMetadataTypes,i==null&&(i=b.registerMetadataTypes),t!==!1||t===undefined)if(t==null){var o=null;b.cacheMetadata===!0&&(o=c.findInArray(u,n,"uri"));o?e.metadataManager=o.data:(e._awaitingMetadata=!0,e.fetchMetadata(null,function(t){e._awaitingMetadata=!1;e.metadataManager=new d.MetadataManager(t);b.cacheMetadata===!0&&u.push({uri:n,data:e.metadataManager});r(e)},function(n){throw c.createError(a.couldNotLoadMetadata,{exception:n,args:arguments,dataService:this});}))}else if(v.isInstanceOf(t,d.MetadataManager))e.metadataManager=t;else if(v.isObject(t))try{e.metadataManager=new d.MetadataManager(t)}catch(s){throw c.createError(a.invalidArguments,{exception:s,args:arguments,dataService:this});}e._awaitingMetadata||r(e)}function r(t){var u,f,e,r,o;if(t.isReady())for(u=t.metadataManager,i&&u&&(f=u.name,f in n||(n[f]=p.EntityManager)),e=t._readyCallbacks.slice(0),t._readyCallbacks=[],r=0;r<e.length;r++)o=e[r],o&&o.call(t)}var u=[],f=function(n,t,i){e(n,t,i,this)},t=f.prototype,i;return t.toString=function(){return this.uri},t.isReady=function(){return!this._awaitingMetadata},t.ready=function(n){this._readyCallbacks.push(n);r(this)},t.getEntityType=function(n){return this.metadataManager?this.metadataManager.getEntityType(n):null},t.createQuery=function(n,t,i){return(c.assertPrm(n,"resourceName").isNotEmptyString().check(),t)?this.createEntityQuery(t,n,i):this.metadataManager?this.metadataManager.createQuery(n,null,i):new w.EntityQuery(n,null,i)},t.createEntityQuery=function(n,t,i){if(!this.metadataManager)throw c.createError(a.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createQuery(t,n,i)},t.registerCtor=function(n,t,i){if(this.metadataManager==null)throw c.createError(a.noMetadataEntityQuery);this.metadataManager.registerCtor(n,t,i)},t.createEntity=function(n,t){if(!this.metadataManager)throw c.createError(a.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createEntity(n,t)},t.createRawEntity=function(n,t){if(!this.metadataManager)throw c.createError(a.noMetadataEntityQuery,{dataService:this});return this.metadataManager.createRawEntity(n,t)},t.toEntity=function(n,t){var i=null;return this.metadataManager&&(i=this.metadataManager.getEntityTypeByFullName(t)),i||(i=new d.EntityType(t)),p.EntityTracker.toEntity(n,i,b.getObservableProvider())},t.toODataQueryParams=function(n,t){if(n.isMultiTyped===!0)throw c.createError(a.oDataNotSupportMultiTyped,{query:n});var i={varContext:t},r=[];return c.forEach(n.parameters,function(n){r.push({name:n.name,value:n.value==null?"":n.value})}),n.inlineCountEnabled===!0&&r.push({name:"$inlinecount",value:"allpages"}),c.forEach(n.expressions,function(n,t){i.expVarContext=n.varContext;var f,u;n.onlyBeetle===!0?(f="!e"+t,u=n.toBeetleQuery(i),u=n.name+":"+u):(f="$"+n.name,u=n.toODataQuery(i));r.push({name:f,value:u});i.expVarContext=undefined}),r},t.toBeetleQueryParams=function(n,t){var r={varContext:t},i=[];return c.forEach(n.parameters,function(n){i.push({name:n.name,value:n.value==null?"":n.value})}),n.inlineCountEnabled===!0&&i.push({name:"!e0",value:"inlinecount:allpages"}),c.forEach(n.expressions,function(n,t){r.expVarContext=n.varContext;i.push({name:"!e"+(t+1),value:n.name+":"+n.toBeetleQuery(r)});r.expVarContext=undefined}),i},t.fetchMetadata=function(){throw c.createError(a.notImplemented,["DataServiceBase","fetchMetadata"]);},t.createEntityAsync=function(){throw c.createError(a.notImplemented,["DataServiceBase","createEntityAsync"]);},t.executeQuery=function(){throw c.createError(a.notImplemented,["DataServiceBase","executeQuery"]);},t.executeQueryParams=function(){throw c.createError(a.notImplemented,["DataServiceBase","executeQueryParams"]);},t.saveChanges=function(){throw c.createError(a.notImplemented,["DataServiceBase","saveChanges"]);},f}()}}(),g=function(){return{DefaultDateConverter:function(){var n=function(){l.DateConverterBase.call(this,"Default Date Converter")},t;return c.inherit(n,l.DateConverterBase),t=n.prototype,t.parse=function(n){if(typeof n!="string"||n.length<10||!/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(n.substr(0,10)))return null;/.\d{3}$/.test(n)&&(n+="Z");try{var t=Date.parse(n);return isNaN(t)?null:new Date(t)}catch(i){return null}},t.toISOString=function(n){return n.toISOString()},n}(),KoObservableProvider:function(){var t=function(n){l.ObservableProviderBase.call(this,"Knockout Observable Provider");this.ko=n;n.extenders.intercept==null&&(n.extenders.intercept=function(t,i){return n.computed({read:t,write:function(n){var r=i&&i.callback;r&&r(i.object,i.property,t,n)}})});c.tryFreeze(this)},n;return c.inherit(t,l.ObservableProviderBase),n=t.prototype,n.isObservable=function(n,t){return this.ko.isObservable(n[t])},n.toObservable=function(n,t,i){function f(t,i,r){var f=u.ko.observable(i);return r?u.ko.observable(i).extend({intercept:{object:n,property:t,callback:r}}):f}function o(t,i,r,f,e){var o;return r=r||[],f&&(r=c.createTrackableArray(r,n,t,function(t,r,u,e,s){o.$fromKo!==!0&&n[i].valueHasMutated();o.$fromKo=!1;f(t,r,u,e,s)})),o=u.ko.observableArray(r),o.subscribe(function(){o.$fromKo=!0},null,"beforeChange"),e&&(o.equalityComparer=function(i,r){e(n,t,i,r)}),o}var s=i&&i.propertyChange,h=i&&i.arrayChange,l=i&&i.dataPropertyChange,a=i&&i.scalarNavigationPropertyChange,y=i&&i.pluralNavigationPropertyChange,e=i&&i.arraySet,u=this,r=[];c.forEachProperty(n,function(n,t){r.push({p:n,v:t})});t&&t.hasMetadata&&(c.forEach(t.dataProperties,function(t){var i=n[t.name];i=i===undefined?null:t.handle(i);n[t.name]=f(t,i,l);c.removeFromArray(r,t.name,"p")}),c.forEach(t.navigationProperties,function(t){var i=n[t.name];i===undefined&&(i=null);n[t.name]=t.isScalar?f(t,i,a):o(t,t.name,i,y,e);c.removeFromArray(r,t.name,"p")}));c.forEach(r,function(i){var r=i.p,u=i.v;n[r]=v.isArray(u)?o(r,r,u,h,e):f(r,u,s);c.findInArray(t.properties,r)||t.properties.push(r)})},n.getValue=function(n,t){return this.ko.utils.unwrapObservable(n[t])},n.setValue=function(n,t,i){n[t](i)},t}(),PropertyObservableProvider:function(){var t=function(){l.ObservableProviderBase.call(this,"Property Observable Provider");c.tryFreeze(this)},n;return c.inherit(t,l.ObservableProviderBase),n=t.prototype,n.isObservable=function(n,t){return n.$fields!==undefined&&n.$fields[t]!==undefined},n.toObservable=function(n,t,i){function f(t,i,r){return Object.defineProperty(n,i,{get:function(){return n.$fields[i]},set:function(u){if(r){var f=p(n,i);r(n,t,f,u)}else n.$fields[i]=u},enumerable:!0,configurable:!0})}function o(t,i,u,f,e){return u=u||[],f&&(u=c.createTrackableArray(u,n,t,f)),r[i]=u,Object.defineProperty(n,i,{get:function(){return n.$fields[i]},set:function(r){e?e(n,t,items,r):n.$fields[i]=r}})}function p(n,t){return function(){return arguments.length==0?n.$fields[t]:n.$fields[t]=arguments[0]}}var s=i&&i.propertyChange,h=i&&i.arrayChange,l=i&&i.dataPropertyChange,a=i&&i.scalarNavigationPropertyChange,y=i&&i.pluralNavigationPropertyChange,e=i&&i.arraySet,r={},u=[];return c.forEachProperty(n,function(n,t){u.push({p:n,v:t})}),t&&t.hasMetadata&&(c.forEach(t.dataProperties,function(t){var i=n[t.name];i=i===undefined?null:t.handle(i);delete n[t.name];f(t,t.name,l);c.removeFromArray(u,t.name,"p");r[t.name]=i}),c.forEach(t.navigationProperties,function(t){var i=n[t.name];i===undefined&&(i=null);delete n[t.name];t.isScalar?(f(t,t.name,a),r[t.name]=i):o(t,t.name,i,y,e);c.removeFromArray(u,t.name,"p")})),c.forEach(u,function(i){var u=i.p,l=i.v;delete n[u];v.isArray(l)?o(u,u,l,h,e):(f(u,u,s),r[u]=l);c.findInArray(t.properties,u)||t.properties.push(u)}),n.$fields=r,n},n.getValue=function(n,t){return n[t]},n.setValue=function(n,t,i){n[t]=i},t}(),JQueryAjaxProvider:function(){var n=function(n){l.AjaxProviderBase.call(this,"jQuery Ajax Provider");this.$=n;c.tryFreeze(this)},t;return c.inherit(n,l.AjaxProviderBase),t=n.prototype,t.doAjax=function(n,t,i,r,u,f,e,o,s,h,c){var a=this,l={url:n,accepts:{json:"application/json; odata=verbose",xml:"text/xml; application/xhtml+xml;application/xml",text:"text/xml"},type:t,dataType:i,contentType:r,traditional:!1,data:u,async:f,headers:s,success:function(n,t,i){if(i.onreadystatechange=null,i.abort=null,n&&n.Error){var r=a.createError(i);r.message=n.Error;c(r)}else h(n,a.getHeaderGetter(i),i)},error:function(n){n.onreadystatechange=null;n.abort=null;c(a.createError(n))}};return f!==!1&&(l.timeout=e),o!=null&&this.$.extend(l,o),l.cache==null&&(l.cache=!1),this.$.ajax(l)},n}(),AngularjsAjaxProvider:function(){var n=function(n){l.AjaxProviderBase.call(this,"Angular.js Ajax Provider");this.syncSupported=!1;this.$http=n.injector(["ng"]).get("$http");c.tryFreeze(this)},t;return c.inherit(n,l.AjaxProviderBase),t=n.prototype,t.doAjax=function(n,t,i,r,u,f,e,o,s,h,l){if(f===!1)throw c.createError(a.syncNotSupported,[this.name]);var v={method:t,url:n,contentType:r,data:u,timeout:e,headers:s,responseType:i,transformResponse:[function(n){return n}]};return o!=null&&c.extend(v,o),v.cache==null&&(v.cache=!1),this.$http(v).then(function(n){var t=n.headers();h(n.data,function(n){return n?t[n.toLowerCase()]:t})},function(n){var t={status:n.status,config:n.config,detail:n.data,error:n};l(c.createError(n.statusText,t))})},n}(),AngularAjaxProvider:function(){var n=function(n){l.AjaxProviderBase.call(this,"Angular Ajax Provider");this.syncSupported=!1;this.http=n;c.tryFreeze(this)},t;return c.inherit(n,l.AjaxProviderBase),t=n.prototype,t.doAjax=function(n,t,i,r,u,f,e,o,l,a,v){var y=new h,p,w,b;if(y.append("Content-Type",r),l!=null)for(p in l)y.append(p,l[p]);w={url:n,method:t,body:u,headers:y,timeout:e};o!=null&&c.extend(w,o);b=new s(w);this.http.request(b).toPromise().then(n=>{a(n.text(),t=>n.headers[t])},n=>v(n))},n}(),VanillajsAjaxProvider:function(){var n=function(){l.AjaxProviderBase.call(this,"Vanilla-js Ajax Provider");this.syncSupported=!0;c.tryFreeze(this)},t;return c.inherit(n,l.AjaxProviderBase),t=n.prototype,t.doAjax=function(n,t,i,r,u,f,e,o,s,h,c){var v=this,l=new XMLHttpRequest,a;if(l.open(t,n,f),l.setRequestHeader("Accept","application/json; odata=verbose, text/xml;application/xhtml+xml;application/xml"),l.setRequestHeader("Content-Type",r),f!==!1&&(l.timeout=e),s)for(a in s)l.setRequestHeader(a,s[a]);l.onload=function(){l.onreadystatechange=null;l.abort=null;l.status===200?h(l.responseText,v.getHeaderGetter(l),l):c(v.createError(l))};l.ontimeout=function(n){l.onreadystatechange=null;l.abort=null;c(n)};l.send(u)},n}(),NodejsAjaxProvider:function(){var n=function(n,t){l.AjaxProviderBase.call(this,"Node.js Ajax Provider");this.syncSupported=!1;this.http=n;this.https=t;c.tryFreeze(this)},t;return c.inherit(n,l.AjaxProviderBase),t=n.prototype,t.doAjax=function(n,t,i,r,u,f,e,o,s,h,l){var w,v;if(f===!1)throw c.createError(a.syncNotSupported,[this.name]);var b=new RegExp("^(https?:)//(([^:/?#]*)(?::([0-9]+))?)(/{0,1}[^?#]*)(\\?[^#]*|)(#.*|)$"),y=n.match(b),k=y[1]=="https:"?this.https:this.http,d=y[3],g=y[4],p=y[5],nt=y[6];if(p+=nt,s=s||{},s["Content-Type"]=r,s.Accept="application/json; odata=verbose, text/xml;application/xhtml+xml;application/xml",s["Content-Length"]=u&&u.length||0,w={host:d,path:p,method:t,headers:s,port:g||80},v=k.request(w,function(n){n.setEncoding("utf8");var t="";n.on("data",function(n){t+=n});n.on("end",function(){h(t,function(t){return t?n.headers[t.toLowerCase()]:n.headers})})}),u&&v.write(u),e)v.on("socket",function(n){n.setTimeout(e);n.on("timeout",function(){v.abort()})});v.on("error",function(n){l(n)});v.end()},n}(),JsonSerializationService:function(){var n=function(){l.SerializationServiceBase.call(this,"Json Serializer");c.tryFreeze(this)},t;return c.inherit(n,l.SerializationServiceBase),t=n.prototype,t.serialize=function(n){return JSON.stringify(n)},t.deserialize=function(n){return v.isTypeOf(n,"string")?JSON.parse(n):n},n}(),QPromiseProvider:function(){var t=function(n){l.PromiseProviderBase.call(this,"Q Promise Provider");this.Q=n;c.tryFreeze(this)},n;return c.inherit(t,l.PromiseProviderBase),n=t.prototype,n.deferred=function(){return this.Q.defer()},n.getPromise=function(n){return n.promise},n.resolve=function(n,t){n.resolve(t)},n.reject=function(n,t){n.reject(t)},t}(),AngularjsPromiseProvider:function(){var t=function(n){l.PromiseProviderBase.call(this,"Angular.js Promise Provider");this.ng=n.injector(["ng"]);this.$q=this.ng.get("$q");this.$rootScope=this.ng.get("$rootScope");c.tryFreeze(this)},n;return c.inherit(t,l.PromiseProviderBase),n=t.prototype,n.deferred=function(){return this.$q.defer()},n.getPromise=function(n){return n.promise},n.resolve=function(n,t){n.resolve(t);this.$rootScope.$apply()},n.reject=function(n,t){n.reject(t);this.$rootScope.$apply()},t}(),JQueryPromiseProvider:function(){var t=function(n){l.PromiseProviderBase.call(this,"jQuery Promise Provider");this.$=n;c.tryFreeze(this)},n;return c.inherit(t,l.PromiseProviderBase),n=t.prototype,n.deferred=function(){return this.$.Deferred()},n.getPromise=function(n){return n.promise()},n.resolve=function(n,t){n.resolve(t)},n.reject=function(n,t){n.reject(t)},t}(),Es6PromiseProvider:function(){var t=function(){l.PromiseProviderBase.call(this,"ES6 Promise Provider");c.tryFreeze(this)},n;return c.inherit(t,l.PromiseProviderBase),n=t.prototype,n.deferred=function(){var n={resolve:null,reject:null};return n.promise=new Promise(function(t,i){n.resolve=t;n.reject=i}),n},n.getPromise=function(n){return n.promise},n.resolve=function(n,t){n.resolve(t)},n.reject=function(n,t){n.reject(t)},t}()}}(),d=function(){return{DataProperty:function(){var t=function(n,t,i,r,u,f,e,o,s){this.owner=n;this.name=t;this.displayName=i||t;this.dataType=r;this.isNullable=u;this.isKeyPart=f;this.generationPattern=e;this.defaultValue=o;this.useForConcurrency=s;this.relatedNavigationProperties=[];this.validators=[];this.isEnum=r instanceof p.dataTypes.enumeration;this.isComplex=r.isComplex},n=t.prototype;return n.toString=function(){return this.displayName},n.isValid=function(n){return n==null?!this.isNullable:this.dataType.isValid(n,this)},n.handle=function(n){if(this.dataType!=p.dataTypes.string&&n===""&&(n=null),n==null){if(!this.isNullable)throw c.createError(a.notNullable,[this.displayName],{property:this});return null}if(n=this.dataType.handle(n,this),this.dataType==p.dataTypes.number&&this.precision&&n.toString().replace(/\./g,"").length>this.precision)throw c.createError(a.maxPrecisionError,[n,this.precision],{dataType:dataType,value:n});return this.dataType==p.dataTypes.number&&this.scale!=null&&(n=Number(n.toFixed(this.scale))),n},n.getDefaultValue=function(){return this.defaultValue!=null?this.defaultValue:this.isNullable?null:this.generationPattern==y.generationPattern.Identity&&this.isKeyPart===!0?this.dataType.autoValue():this.dataType.defaultValue()},n.addValidation=function(n,t,i,r){c.assertPrm(n,"name").isNotEmptyString().check();c.assertPrm(t,"func").isFunction().check();this.validators.push(new p.Validator(n,t,i,r))},n.validate=function(n){var i=[],r,t;return this.validators.length>0&&(r=this,t=c.getValue(n,this.name),c.forEach(this.validators,function(u){var f=u.validate(t,n);f&&i.push(c.createValidationError(n,t,r,f,u))})),i},t}(),NavigationProperty:function(){var t=function(n,t,i,r,u,f,e,o){this.owner=n;this.name=t;this.displayName=i||t;this.entityTypeName=r;this.entityType=null;this.isScalar=u;this.isComplex=f===undefined;this.associationName=f;this.cascadeDelete=e===!0;this.foreignKeyNames=o||[];this.inverse=null;this.foreignKeys=[];this.validators=[];this.triggerOwnerModify=!1},n=t.prototype;return n.toString=function(){return this.displayName},n.checkAssign=function(n){if(n!=null){if(!n.$tracker)throw c.createError(a.assignErrorNotEntity,[this],{property:this,value:n});var t=n.$tracker.entityType;if(!this.entityType.isAssignableWith(t))throw c.createError(a.assignError,[this.name,t.shortName],{property:this,value:n});}},n.addValidation=function(n,t,i,r){c.assertPrm(n,"name").isNotEmptyString().check();c.assertPrm(t,"func").isFunction().check();this.validators.push(new p.Validator(n,t,i,r))},n.validate=function(n){var r=[],t,i;return this.validators.length>0&&(t=this,i=c.getValue(n,t.name),c.forEach(this.validators,function(u){var f=u.validate(i);f&&r.push(c.createValidationError(n,i,t,f,u))})),r},t}(),EntityType:function(){function i(n,t){n.baseType&&i(n.baseType,t);n.constructor&&n.constructor.call(t,t)}function f(n,t){for(var r,u,f,e=n.length,i=0;i<e;i++){if(r=n[i],i==e-1)return u=c.findInArray(t.dataProperties,r,"name"),u?u:c.findInArray(t.navigationProperties,r,"name");if(f=c.findInArray(t.navigationProperties,r,"name"),f)t=f.entityType;else return null}return null}function r(n,t){return n.name===t.name?!0:t.baseType!=null?r(n,t.baseType):!1}function u(n,t){var i=v.isTypeOf(t,"string")?t:t.name;return n.name===i?!0:n.baseType!=null?u(n.baseType,t):!1}var t=function(n,t,i,r,u,f,e,o,s){this.name=n;this.displayName=t||n;this.shortName=i;this.keyNames=r||[];this.baseTypeName=u;this.setName=f;this.setTypeName=e;this.metadataManager=s;this.hasMetadata=s!=null;this.properties=[];this.dataProperties=[];this.navigationProperties=[];this.keys=[];this.floorType=this;this.baseType=null;this.validators=[];this.isComplexType=o==!0;this.constructor=null;this.initializer=null},n=t.prototype;return n.toString=function(){return this.name},n.getProperty=function(n){return f(n.split("."),this)},n.createQuery=function(n,t){if(n)return new w.EntityQuery(n,this,t);var i=new w.EntityQuery(this.setName,this,t);return this.shortName==this.setTypeName?i:i.ofType(this.shortName)},n.registerCtor=function(n,t){n!=null&&c.assertPrm(n,"constructor").isFunction().check();t!=null&&c.assertPrm(t,"initializer").isFunction().check();this.constructor=n;this.initializer=t},n.createEntity=function(n){var t=this.createRawEntity(n);return p.EntityTracker.toEntity(t,this,b.getObservableProvider())},n.createRawEntity=function(n){var t=n||{};return c.forEach(this.dataProperties,function(n){t[n.name]===undefined&&(t[n.name]=n.getDefaultValue())}),c.forEach(this.navigationProperties,function(n){t[n.name]=n.isComplex?n.entityType.createRawEntity():n.isScalar?null:[]}),i(this,t),t.$type=this.name,t},n.isAssignableWith=function(n){return r(this,n)},n.isAssignableTo=function(n){return u(this,n)},n.hasSameBaseType=function(n){return this.floorType.name===n.floorType.name},n.addDataProperty=function(n,t,i,r,u){var f,e;if(c.assertPrm(n,"name").isNotEmptyString().check(),f=c.findInArray(this.dataProperties,n,"name"),f)throw c.createError(a.dataPropertyAlreadyExists,[n],{entityType:this,existing:f});if(v.isNotEmptyString(i)&&(i=p.dataTypes.byName(i)),c.assertPrm(i,"dataType").isInstanceOf(p.dataTypes.baseType).check(),u!=null&&!i.isValid(u))throw c.createError(a.invalidDefaultValue,[u,i.name],{entityType:this,dataType:i,defaultValue:u});e=new d.DataProperty(this,n,t,i,r===!0,!1,null,u);this.dataProperties.push(e)},n.addValidation=function(n,t,i,r){c.assertPrm(n,"name").isNotEmptyString().check();c.assertPrm(t,"func").isFunction().check();this.validators.push(new p.Validator(n,t,i,r))},n.validate=function(n){var t=[];return this.validators.length>0&&c.forEach(this.validators,function(i){var r=i.validate(n);r&&t.push(c.createValidationError(n,null,null,r,i))}),c.forEach(this.dataProperties,function(i){var r=i.validate(n);r&&(t=t.concat(r))}),c.forEach(this.navigationProperties,function(i){var r=i.validate(n);r&&(t=t.concat(r))}),t},t}(),MetadataManager:function(){var t=function(n){this.types=[];this.typesDict={};this.enums={};this.name=null;this.displayName=null;n&&this.parseBeetleMetadata(n)},n=t.prototype;return n.toString=function(){return this.types.join(", ")},n.getEntityTypeByFullName=function(n,t){var i=c.findInArray(this.types,n,"name");if(!i&&t===!0)throw c.createError(a.notFoundInMetadata,[n],{metadataManager:this,typeName:n});return i},n.getEntityType=function(n,t){v.isFunction(n)&&(n=c.getFuncName(n));var i=this.typesDict[n];if(!i&&t===!0)throw c.createError(a.notFoundInMetadata,[n],{metadataManager:this,typeShortName:n});return i},n.createQuery=function(n,t,i){if(v.isFunction(t)&&(t=c.getFuncName(t)),t)return this.getEntityType(t,!0).createQuery(n,i);var r=c.filterArray(this.types,function(t){return t.setName==n});return r.length==1?r[0].createQuery(n,i):new w.EntityQuery(n,null,i)},n.registerCtor=function(n,t,i){v.isFunction(n)&&(n=c.getFuncName(n));var r=this.getEntityType(n,!0);r.registerCtor(t,i)},n.createEntity=function(n,t){v.isFunction(n)&&(n=c.getFuncName(n));var i=this.getEntityType(n,!0);return i.createEntity(t)},n.createRawEntity=function(n,t){v.isFunction(n)&&(n=c.getFuncName(n));var i=this.getEntityType(n,!0);return i.createRawEntity(t)},n.parseBeetleMetadata=function(n){var u,o,f,r,s,h,l,a,e,t,i,w,b;if(v.isTypeOf(n,"string")&&(n=JSON.parse(n)),this.types=[],this.typesDict={},this.enums={},this.name=n.n,this.displayName=c.getResourceValue(n.r,n.l||n.n),u=n.e,o={},u)for(f=0;f<u.length;f++)r=u[f],s={},c.forEach(r.m,function(n){s[n.n]={name:n.n,value:n.v,displayName:c.getResourceValue(n.r,n.l||n.n)}}),h=new k.Enum(s),this.enums[r.n]=h,o[r.n]=new p.dataTypes.enumeration(h,r.n,c.getResourceValue(r.r,r.l||r.n));for(l=this,a=n.m,e=0;e<a.length;e++)t=a[e],i=new d.EntityType(t.n,c.getResourceValue(t.rn,t.s),t.s,t.k,t.b,t.q,t.t,t.c,this),c.forEach(t.d,function(n){var u,f,r;u=n.e?o[n.t]:p.dataTypes.byName(n.t);f=c.getResourceValue(n.r,n.l||n.n);r=new d.DataProperty(i,n.n,f,u,n.i===!0,t.k&&c.findInArray(t.k,n.n)!=null,n.g?n.g=="I"?y.generationPattern.Identity:y.generationPattern.Computed:null,n.d?u.handle(n.d):null,n.c);n.v&&c.forEach(n.v,function(t){r.validators.push(p.Validator.byCode(t.t,t.a,t.m,t.r,r.displayName,n.r))});n.p&&(r.precision=Number(n.p));n.s&&(r.scale=Number(n.s));i.dataProperties.push(r)}),w=t.r,w&&c.forEach(w,function(n){var t=new d.NavigationProperty(i,n.n,c.getResourceValue(n.r,n.l||n.n),n.t,n.s===!0,n.a,n.c);n.f&&c.forEach(n.f,function(n){t.foreignKeyNames.push(n)});n.v&&c.forEach(n.v,function(i){t.validators.push(p.Validator.byCode(i.t,i.a,i.m,i.r,t.displayName,n.r))});i.navigationProperties.push(t)}),b=t.x,b&&c.forEach(b,function(n){var t=new d.NavigationProperty(i,n.n,c.getResourceValue(n.r,n.l||n.n),n.t,!0);i.navigationProperties.push(t)}),this.types.push(i),this.typesDict[i.shortName]=i;c.forEach(this.types,function(n){n.baseTypeName&&(n.baseType=l.getEntityType(n.baseTypeName,!0));delete n.baseTypeName});c.forEach(this.types,function(n){for(var t=n.baseType;t;)n.floorType=t,c.forEach(t.dataProperties,function(t){c.findInArray(n.dataProperties,t.name,"name")||n.dataProperties.push(t)}),c.forEach(t.navigationProperties,function(t){c.findInArray(n.navigationProperties,t.name,"name")||n.navigationProperties.push(t)}),t=t.baseType;c.forEach(n.navigationProperties,function(t){var i,r;if(!t.entityType)for(t.entityType=l.getEntityType(t.entityTypeName,!0),i=0;i<t.entityType.navigationProperties.length;i++)if(r=t.entityType.navigationProperties[i],r.associationName===t.associationName&&t!==r){t.inverse=r;break}c.forEach(t.foreignKeyNames,function(i){if(!c.findInArray(t.foreignKeys,i,"name")){var r=c.findInArray(n.dataProperties,i,"name");r&&(r.relatedNavigationProperties.push(t),t.foreignKeys.push(r))}})});c.forEach(n.keyNames,function(t){n.keys.push(c.findInArray(n.dataProperties,t,"name"))})})},t}()}}(),w=function(){return function(){String.prototype.hasOwnProperty("substringOf")||(String.prototype.substringOf=function(n){return v.isNotEmptyString(n)&&n.indexOf(this)>=0});String.prototype.hasOwnProperty("startsWith")||(String.prototype.startsWith=function(n){return this.indexOf(n)==0});String.prototype.hasOwnProperty("endsWith")||(String.prototype.endsWith=function(n){return this.indexOf(n)==this.length-n.length});Number.prototype.hasOwnProperty("round")||(Number.prototype.round=function(){return Math.round(this)});Number.prototype.hasOwnProperty("ceiling")||(Number.prototype.ceiling=function(){return Math.ceil(this)});Number.prototype.hasOwnProperty("floor")||(Number.prototype.floor=function(){return Math.floor(this)})}(),{expressions:function(){return{OfTypeExp:function(){var n=function(n){v.isFunction(n)&&(n=c.getFuncName(n));l.ExpressionBase.call(this,"oftype",-1,!0,!0);this.typeName=n},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.toBeetleQuery=function(){return this.typeName},t.clone=function(){return new n(this.typeName)},t.execute=function(n){var t=this;return c.filterArray(n,function(n){return n&&(n.$tracker&&n.$tracker.entityType.isAssignableTo(t.typeName)||typeof n===t.typeName)})},n}(),WhereExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"filter",2,!1,!1);this.exp=n;this.varContext=t},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);return c.filterArray(n,i)},n}(),OrderByExp:function(){function i(n){return n+=",",n=n.replace(/\,/," ,").replace(/ desc.*?\,/g," x,").replace(/ \,/g," desc,").replace(/ x\,/g,","),n.substr(0,n.length-1)}var r="x => x",t=function(n,t){l.ExpressionBase.call(this,"orderby",1,!1,!1);this.exp=n||r;this.isDesc=t||!1},n;return c.inherit(t,l.ExpressionBase),n=t.prototype,n.clone=function(){return new t(this.exp,this.isDesc)},n.toODataQuery=function(n){var t=v.isFunction(this.exp)?c.funcToLambda(this.exp).replace(" as "," "):this.exp;return this.isDesc&&(t=i(t)),c.jsepToODataQuery(k.jsep(t),n)},n.toBeetleQuery=function(n){if(!this.exp)return"";var t=v.isFunction(this.exp)?c.funcToLambda(this.exp).replace(" as "," "):this.exp;return this.isDesc&&(t=i(t)),c.jsepToBeetleQuery(k.jsep(t),n)},n.execute=function(n,t){var o,s,u,y,p,e;if(v.isFunction(this.exp)){if(s=this,this.exp.length==2)return n.sort(function(n,t){var i=s.exp(n,t);return s.isDesc?-1*i:i});o=c.funcToLambda(this.exp).replace(/ as /g," ")}else o=this.exp;var h=[],l=k.jsep(o),i=l.type=="Compound"?l.body:[l],r;for(i[0].operator=="=>"&&(r={},r.alias=i[0].left.name,t.aliases=[r],i[0]=i[0].right),u=0;u<i.length;u++){var f=!1,w=i[u],a=i[u+1];a&&a.type=="Identifier"&&(y=a.name.toLowerCase(),y=="desc"?(f=!0,u++):y=="asc"&&u++);f=f!=this.isDesc;p=function(n,i){return function(u,f){var h=c.jsepToFunction(n,t),e,o,s;return(r&&(r.value=u),e=h(u),r&&(r.value=f),o=h(f),typeof e=="string"&&typeof o=="string")?(s=e.localeCompare(o),i?s*-1:s):e==o?0:e>o?i?-1:1:i?1:-1}}(w,f);h.push(p)}return e=[],e.push.apply(e,n),e.sort(function(n,t){for(var r,i=0;i<h.length;i++)if(r=h[i](n,t),r!=0)return r;return 0})},t}(),ExpandExp:function(){var n=function(n){l.ExpressionBase.call(this,"expand",1,!1,!1);this.exp=n},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n){return n},n}(),SelectExp:function(){var n=function(n){l.ExpressionBase.call(this,"select",2,!1,!0);this.exp=n},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){return v.isFunction(this.exp)?c.mapArray(n,this.exp):c.runSelectExp(n,this.exp,t)},n}(),SkipExp:function(){var t=function(n){l.ExpressionBase.call(this,"skip",2,!1,!1);this.count=n},n;return c.inherit(t,l.ExpressionBase),n=t.prototype,n.toODataQuery=function(){return this.count},n.toBeetleQuery=function(){return this.count},n.clone=function(){return new t(this.count)},n.execute=function(n){return n.slice(this.count)},t}(),TopExp:function(){var t=function(n){l.ExpressionBase.call(this,"top",2,!1,!1);this.count=n},n;return c.inherit(t,l.ExpressionBase),n=t.prototype,n.toODataQuery=function(){return this.count},n.toBeetleQuery=function(){return this.count},n.clone=function(){return new t(this.count)},n.execute=function(n){return n.slice(0,this.count)},t}(),GroupByExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"groupby",3,!0,!0);this.keySelector=n;this.elementSelector=t},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.toBeetleQuery=function(n){var t="",i,r;return this.keySelector&&(i=v.isFunction(this.keySelector)?c.funcToLambda(this.keySelector):this.keySelector,t+=c.jsepToBeetleQuery(k.jsep(i),n)),this.elementSelector&&(r=v.isFunction(this.elementSelector)?c.funcToLambda(this.elementSelector):this.elementSelector,t+=";"+c.jsepToBeetleQuery(k.jsep(r),n)),t},t.clone=function(){return new n(this.keySelector,this.elementSelector)},t.execute=function(n,t){var i=[],o,u,r,s,f,h,l,e,a;if(this.keySelector)for(o=v.isFunction(this.keySelector)?c.mapArray(n,this.keySelector):c.runSelectExp(n,this.keySelector,t),u=0;u<o.length;u++){for(r=null,s=o[u],f=0;f<i.length;f++)if(h=i[f],c.objEquals(h.Key,s)){r=h;break}r||(r={Key:s,Items:[]},i.push(r));r.Items.push(n[u])}else i.push({Key:null,Items:n});return this.elementSelector&&(v.isFunction(this.elementSelector)?l=this.elementSelector:(e=k.jsep(this.elementSelector),a=e.type=="Compound"?e.body:[e],l=c.jsepToProjector(a,t)),c.forEach(i,function(n,t){var u=n.Items,r;u.Key=n.Key;r=l(n.Items);i[t]=r})),i},n}(),DistinctExp:function(){function i(n){var t=[];return c.forEach(n,function(n){for(var r=!1,i=0;i<t.length;i++)if(c.objEquals(t[i],n)){r=!0;break}r===!1&&t.push(n)}),t}var n=function(n){l.ExpressionBase.call(this,"distinct",3,!0,!0);this.exp=n},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){return this.exp?v.isFunction(this.exp)?i(c.mapArray(n,this.exp)):i(c.runSelectExp(n,this.exp,t)):i(n)},n}(),ReverseExp:function(){var n=function(){l.ExpressionBase.call(this,"reverse",3,!0,!1)},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.toBeetleQuery=function(){return""},t.clone=function(){return new n},t.execute=function(n){return n.reverse()},n}(),SelectManyExp:function(){function i(n,t){var i,r,u;if(n.length==0)return n;for(i=[],r=0;r<n.length;r++)u=t(n[r]),i=i.concat.apply(i,u);return i}var n=function(n){l.ExpressionBase.call(this,"selectMany",3,!0,!0);this.exp=n},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){return n.length==0?n:v.isFunction(this.exp)?i(n,this.exp):i(n,c.jsepToFunction(k.jsep(this.exp),t))},n}(),SkipWhileExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"skipWhile",3,!0,!1);this.exp=n;this.varContext=t},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){for(var r=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t),i=0;r(n[i])==!0;)i++;return n.slice(i+1)},n}(),TakeWhileExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"takeWhile",3,!0,!1);this.exp=n;this.varContext=t},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){for(var r=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t),i=0;r(n[i])==!0;)i++;return n.slice(0,i)},n}(),AllExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;all",3,!0,!0);this.exp=n;this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);return w.queryFuncs.all.impl(n,function(){return n},i)},n}(),AnyExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;any",3,!0,!0);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);return w.queryFuncs.any.impl(n,function(){return n},i)}return n.length>0},n}(),AvgExp:function(){var n=function(n){l.ExpressionBase.call(this,"exec;avg",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t):function(n){return n};return w.queryFuncs.avg.impl(n,function(){return n},i)},n}(),MaxExp:function(){var n=function(n){l.ExpressionBase.call(this,"exec;max",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t):function(n){return n};return w.queryFuncs.max.impl(n,function(){return n},i)},n}(),MinExp:function(){var n=function(n){l.ExpressionBase.call(this,"exec;min",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t):function(n){return n};return w.queryFuncs.min.impl(n,function(){return n},i)},n}(),SumExp:function(){var n=function(n){l.ExpressionBase.call(this,"exec;sum",3,!0,!0);n&&(this.exp=n);this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp)},t.execute=function(n,t){var i=this.exp?v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t):function(n){return n};return w.queryFuncs.sum.impl(n,function(){return n},i)},n}(),CountExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;count",3,!0,!0);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);return c.filterArray(n,i).length}return n.length},n}(),FirstExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;first",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);n=c.filterArray(n,i)}if(n.length==0)throw c.createError(a.arrayEmpty,{array:n,expression:this});return n[0]},n}(),FirstOrDefaultExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;firstOD",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);n=c.filterArray(n,i)}return n.length==0?null:n[0]},n}(),SingleExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;single",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);n=c.filterArray(n,i)}if(n.length!=1)throw c.createError(a.arrayNotSingle,{array:n,expression:this});return n[0]},n}(),SingleOrDefaultExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;singleOD",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);n=c.filterArray(n,i)}if(n.length>1)throw c.createError(a.arrayNotSingleOrEmpty,{array:n,expression:this});return n.length==0?null:n[0]},n}(),LastExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;last",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);n=c.filterArray(n,i)}if(n.length==0)throw c.createError(a.arrayEmpty,{array:n,expression:this});return n[n.length-1]},n}(),LastOrDefaultExp:function(){var n=function(n,t){l.ExpressionBase.call(this,"exec;lastOD",3,!0,!1);n&&(this.exp=n);this.varContext=t;this.isExecuter=!0},t;return c.inherit(n,l.ExpressionBase),t=n.prototype,t.clone=function(){return new n(this.exp,this.varContext)},t.execute=function(n,t){if(this.exp){var i=v.isFunction(this.exp)?this.exp:c.jsepToFunction(k.jsep(this.exp),t);n=c.filterArray(n,i)}return n.length==0?null:n[n.length-1]},n}()}}(),queryFuncs:function(){var n={};return n.toupper=function(){var n=function(){l.QueryFuncBase.call(this,"toupper","ToUpper",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t){return(t?t(n):n).toUpperCase()},new n}(),n.touppercase=n.toupper,n.tolower=function(){var n=function(){l.QueryFuncBase.call(this,"tolower","ToLower",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t){return(t?t(n):n).toLowerCase()},new n}(),n.tolowercase=n.tolower,n.substring=function(){var n=function(){l.QueryFuncBase.call(this,"substring","Substring",3)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i,r){arguments.length==3?(r=i,i=t,t=n):t=t(n);i=i(n);r=r(n);var u=Number(i)+Number(r);return t&&t.substring(i,u)},new n}(),n.substringof=function(){var n=function(){l.QueryFuncBase.call(this,"substringof","Contains",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n,t){return t=t?t+".":"",t+"Contains("+n+")"},t.impl=function(n,t,i){return i=i?i(n):n,i=c.handleStrOptions(i,this.varContext),t=c.handleStrOptions(t(n),this.varContext),i?i.indexOf(t)>=0:!1},new n}(),n.length=function(){var n=function(){l.QueryFuncBase.call(this,"length","Length",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Length"},t.impl=function(n,t){return(t?t(n):n).length},new n}(),n.trim=function(){var n=function(){l.QueryFuncBase.call(this,"trim","Trim",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t){return(t?t(n):n).trim()},new n}(),n.concat=function(){var n=function(){l.QueryFuncBase.call(this,"concat","Concat",null)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(){return"string.Concat("+Array.prototype.slice.call(arguments).join(", ")+")"},t.impl=function(n){for(var i=arguments[1](n).toString(),r=Array.prototype.slice.call(arguments,2),u=[],t=0;t<r.length;t++)u.push(r[t](n));return i.concat.apply(i,u)},new n}(),n.replace=function(){var n=function(){l.QueryFuncBase.call(this,"replace","Replace",3)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i,r){return arguments.length==3?(r=i,i=t,t=n):t=t(n),i=i(n),c.ignoreWhiteSpaces(this.varContext)&&(i=i.trim()),c.isCaseSensitive(this.varContext)||(i=new RegExp(i,"gi")),t.replace(i,r(n))},new n}(),n.startswith=function(){var n=function(){l.QueryFuncBase.call(this,"startswith","StartsWith",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i){return arguments.length==2?(i=t,t=n):t=t(n),t=c.handleStrOptions(t,this.varContext),i=c.handleStrOptions(i(n),this.varContext),t?t.indexOf(i,0)===0:!1},new n}(),n.endswith=function(){var n=function(){l.QueryFuncBase.call(this,"endswith","EndsWith",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i){arguments.length==2?(i=t,t=n):t=t(n);t=c.handleStrOptions(t,this.varContext);i=c.handleStrOptions(i(n),this.varContext);var r=t.length-i.length;return t?t.indexOf(i,r)!==-1:!1},new n}(),n.indexof=function(){var n=function(){l.QueryFuncBase.call(this,"indexof","IndexOf",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.impl=function(n,t,i){return arguments.length==2?(i=t,t=n):t=t(n),t&&!t.indexOf&&(t=t.toString()),t=c.handleStrOptions(t,this.varContext),i=c.handleStrOptions(i(n),this.varContext),t?t.indexOf(i):-1},new n}(),n.contains=function(){var i=function(){l.QueryFuncBase.call(this,"contains","Contains",2)},t;return c.inherit(i,l.QueryFuncBase),t=i.prototype,t.toODataFunction=function(t,i){if(v.isTypeOf(t,"string"))return n.substringof.toODataFunction(i,t);var r=[];return c.forEach(t,function(n){r.push(i+" eq "+p.dataTypes.toODataValue(n))}),"("+r.join(" or ")+")"},t.toBeetleFunction=function(t,i){if(v.isTypeOf(t,"string"))return n.substringof.toBeetleFunction(i,t);var r=[];return c.forEach(t,function(n){r.push(i+" == "+p.dataTypes.toBeetleValue(n))}),"("+r.join(" || ")+")"},t.impl=function(n,t,i){var r,u;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),i=i?i(n):n,v.isArray(t)){for(r=0;r<t.length;r++)if(u=t[r],u==i)return!0;return!1}return t=c.handleStrOptions(t,this.varContext),i=c.handleStrOptions(i,this.varContext),t?t.indexOf(i)>=0:-1},new i}(),n.round=function(){var n=function(){l.QueryFuncBase.call(this,"round","Math.Round",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return"Math.Round("+n+")"},t.impl=function(n,t){return Math.round(t?t(n):n)},new n}(),n.ceiling=function(){var n=function(){l.QueryFuncBase.call(this,"ceiling","Math.Ceiling(%1)",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return"Math.Ceiling("+n+")"},t.impl=function(n,t){return Math.ceil(t?t(n):n)},new n}(),n.floor=function(){var n=function(){l.QueryFuncBase.call(this,"floor","Math.Floor",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return"Math.Floor("+n+")"},t.impl=function(n,t){return Math.floor(t?t(n):n)},new n}(),n.second=function(){var n=function(){l.QueryFuncBase.call(this,"second","Second",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Second"},t.impl=function(n,t){return t=p.dataTypes.date.handle(t?t(n):n),t.getSeconds()},new n}(),n.getseconds=n.second,n.minute=function(){var n=function(){l.QueryFuncBase.call(this,"minute","Minute",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Minute"},t.impl=function(n,t){return t=p.dataTypes.date.handle(t?t(n):n),t.getMinutes()},new n}(),n.getminutes=n.minute,n.hour=function(){var n=function(){l.QueryFuncBase.call(this,"hour","Hour",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Hour"},t.impl=function(n,t){return t=p.dataTypes.date.handle(t?t(n):n),t.getHours()},new n}(),n.gethours=n.hour,n.day=function(){var n=function(){l.QueryFuncBase.call(this,"day","Day",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Day"},t.impl=function(n,t){return t=p.dataTypes.date.handle(t?t(n):n),t.getDate()},new n}(),n.getdate=n.day,n.month=function(){var n=function(){l.QueryFuncBase.call(this,"month","Month",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Month"},t.impl=function(n,t){return t=p.dataTypes.date.handle(t?t(n):n),t.getMonth()+1},new n}(),n.getmonth=n.month,n.year=function(){var n=function(){l.QueryFuncBase.call(this,"year","Year",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toBeetleFunction=function(n){return n=n?n+".":"",n+"Year"},t.impl=function(n,t){return t=p.dataTypes.date.handle(t?t(n):n),t.getFullYear()},new n}(),n.getfullyear=n.year,n.max=function(){var n=function(){l.QueryFuncBase.call(this,"max","Max",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw c.createError(a.functionNotSupportedForOData,["Max"]);},t.impl=function(n,t,i){var u,r,f;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),t.length==0)return null;for(u=i?i(t[0]):t[0],r=1;r<t.length;r++)f=i?i(t[r]):t[r],f>u&&(u=f);return u},new n}(),n.min=function(){var n=function(){l.QueryFuncBase.call(this,"min","Min",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw c.createError(a.functionNotSupportedForOData,["Min"]);},t.impl=function(n,t,i){var u,r,f;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),t.length==0)return null;for(u=i?i(t[0]):t[0],r=1;r<t.length;r++)f=i?i(t[r]):t[r],f<u&&(u=f);return u},new n}(),n.sum=function(){var n=function(){l.QueryFuncBase.call(this,"sum","Sum",2)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw c.createError(a.functionNotSupportedForOData,["Sum"]);},t.impl=function(n,t,i){var u,r,f;for(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),u=0,r=0;r<t.length;r++)f=t[r],u+=i?i(f):f;return u},new n}(),n.count=function(){var n=function(){l.QueryFuncBase.call(this,"count","Count",1)},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toODataFunction=function(){throw c.createError(a.functionNotSupportedForOData,["Count"]);},t.impl=function(n,t){return(t?t(n):n).length},new n}(),n.avg=function(){var t=function(){l.QueryFuncBase.call(this,"avg","Average",2)},i;return c.inherit(t,l.QueryFuncBase),i=t.prototype,i.toODataFunction=function(){throw c.createError(a.functionNotSupportedForOData,["Avg"]);},i.impl=function(t,i,r){return(arguments.length==1?i=t:arguments.length==2?(r=i,i=t):i=i(t),i.length==0)?null:n.sum.impl(t,function(){return i},r)/i.length},new t}(),n.any=function(){var n=function(){l.QueryFuncBase.call(this,"any","Any",2);this.needsAlias=!0},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toODataFunction=function(n,t,i){return t+"/any("+n+": "+i+")"},t.impl=function(n,t,i){var r,u;if(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),!i)return t.length>0;for(r=0;r<t.length;r++)if(u=t[r],i(u)===!0)return!0;return!1},new n}(),n.all=function(){var n=function(){l.QueryFuncBase.call(this,"all","All",2);this.needsAlias=!0},t;return c.inherit(n,l.QueryFuncBase),t=n.prototype,t.toODataFunction=function(n,t,i){return t+"/all("+n+": "+i+")"},t.impl=function(n,t,i){var r,u;for(arguments.length==1?t=n:arguments.length==2?(i=t,t=n):t=t(n),r=0;r<t.length;r++)if(u=t[r],i(u)!==!0)return!1;return!0},new n}(),n.getFunc=function(t,i){var r=n[t.toLowerCase()];if(r==null&&i!==!1)throw c.createError(a.unknownFunction,[t]);return r},n}(),ArrayQuery:function(){var t,n;return Array.prototype.asQueryable=function(){return new w.ArrayQuery(this)},Array.hasOwnProperty("q")||(Array.prototype.q=function(){return this.asQueryable()}),t=function(n){this.array=n;l.QueryBase.call(this)},c.inherit(t,l.QueryBase),n=t.prototype,n.executeAfterExecuter=!0,n.execute=function(n){return this.options&&(n=c.combine(this.options.varContext,n)),this.toFunction()(this.array,n)},n.clone=function(){var n=new w.ArrayQuery(this.array);return this.copy(n),n},n.copy=function(n){l.QueryBase.prototype.copy.call(this,n)},t}(),EntityQuery:function(){function i(n,t){if(n==null)return null;if(v.isTypeOf(n,"string")){if(t==null)throw c.createError(a.onlyManagerCreatedCanAcceptEntityShortName);return t.getEntityType(n,!0)}return c.assertPrm(n,"type").isInstanceOf(d.EntityType).check(),n}var t=function(n,t,r){this.resource=n;this.entityType=i(t,r);this.manager=r;this.liveValidate=r&&r.liveValidate;this.parameters=[];l.QueryBase.call(this)},n;return c.inherit(t,l.QueryBase),n=t.prototype,n.toString=function(){var n=[];return n.push("resource: ("+this.resource+")"),this.entityType&&n.push("entityType: ("+this.entityType.shortName+")"),this.manager&&n.push("manager: ("+this.manager.toString()+")"),n.push(l.QueryBase.prototype.toString.call(this)),n.join(", ")},n.expand=function(n){var t=this.clone();return t.addExpression(new w.expressions.ExpandExp(n))},n.include=function(){return this.expand.apply(this,arguments)},n.setParameter=function(n,t){var i=this.clone(),r=c.findInArray(i.parameters,n,"name");return r?r.value=t:i.parameters.push({name:n,value:t}),i},n.setEntityType=function(n){n=i(n,this.manager);var t=this.clone();return t.entityType=n,t},n.execute=function(n,t,i){if(!this.manager)throw c.createError(a.onlyManagerCreatedCanBeExecuted,{query:this,options:n});return this.manager.executeQuery(this,n,t,i)},n.executeLocally=function(n){if(!this.manager)throw c.createError(a.onlyManagerCreatedCanBeExecuted,{query:this,options:options});return this.manager.executeQueryLocally(this,n)},n.clone=function(){var n=new w.EntityQuery(this.resource,this.entityType,this.manager);return this.copy(n),n},n.copy=function(n){l.QueryBase.prototype.copy.call(this,n);c.forEach(this.parameters,function(t){n.parameters.push(t)})},n.then=function(n,t,i){var r=this.execute(i);return t?r.fail?r.then(n).fail(t):r.then(n,t):r.then(n)},t}()}}(),p=function(){return{ValueNotifyWrapper:function(){return function(n,t){this.value=n;this.fromBeetle=t===!0;c.tryFreeze(this)}}(),Event:function(){var t=function(n,t){this.name=n;this.subscribers=[];this.publisher=t},n=t.prototype;return n.toString=function(){return this.name},n.subscribe=function(n){c.findInArray(this.subscribers,n)||this.subscribers.push(n)},n.unsubscribe=function(n){c.removeFromArray(this.subscribers,n)},n.notify=function(){var n=arguments;c.forEach(this.subscribers,function(t){t.apply(t,n)})},t}(),dataTypes:function(){function t(n,t){throw c.createError(a.assignError,[n.name,t],{dataType:n,value:t});}var i=function(){var i=function(n){l.DataTypeBase.call(this,"dateBase");this.name=n},n;return c.inherit(i,l.DataTypeBase),n=i.prototype,n.defaultValue=function(){return new Date(Date.UTC(1753,1,1))},n.isValid=function(n){return Object.prototype.toString.call(n)==="[object Date]"},n.handle=function(n){if(!this.isValid(n)){var i=n;n=this.tryParse(i);n||t(this,i)}return n},n.autoValue=function(){return new Date},n.getRawValue=function(n){return n==null?null:b.getDateConverter().toISOString(n)},n.tryParse=function(n){return b.getDateConverter().parse(n)},n.toODataValue=function(n){return n=this.handle(n),"datetime'"+b.getDateConverter().toISOString(n)+"'"},n.toBeetleValue=function(n){return n=this.handle(n),'"'+b.getDateConverter().toISOString(n)+'"'},i}(),n={};return n.object=function(){var n=function(){l.DataTypeBase.call(this,"object");c.tryFreeze(this)},t;return c.inherit(n,l.DataTypeBase),t=n.prototype,t.toODataValue=function(n){return n},t.toBeetleValue=function(n){return n},new n}(),n.array=function(){var t=function(){l.DataTypeBase.call(this,"array");c.tryFreeze(this)},n;return c.inherit(t,l.DataTypeBase),n=t.prototype,n.isValid=function(n){return n instanceof Array},n.defaultValue=function(){return[]},n.handle=function(n){return this.isValid(n)||(n=n.split(",")),n},n.autoValue=function(){throw c.createError(a.notImplemented,[this.name,"defaultValue"]);},n.toODataValue=function(n){return n},n.toBeetleValue=function(n){return n},new t}(),n.func=function(){var n=function(){l.DataTypeBase.call(this,"function");c.tryFreeze(this)};return c.inherit(n,l.DataTypeBase),new n}(),n.string=function(){var i=0,t=function(){l.DataTypeBase.call(this,"string");c.tryFreeze(this)},n;return c.inherit(t,l.DataTypeBase),n=t.prototype,n.defaultValue=function(){return""},n.handle=function(n){return this.isValid(n)||(n=n.toString()),n},n.autoValue=function(){return"key_"+--i},n.toODataValue=function(n){return"'"+n.replace(/'/g,"''")+"'"},n.toBeetleValue=function(n){return'"'+n.replace(/"/g,'""')+'"'},new t}(),n.guid=function(){var i=function(){l.DataTypeBase.call(this,"guid");c.tryFreeze(this)},n;return c.inherit(i,l.DataTypeBase),n=i.prototype,n.defaultValue=function(){return"00000000-0000-0000-0000-000000000000"},n.isValid=function(n){return typeof n=="string"&&n.match(/^\{?[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}\}?$/i)},n.handle=function(n){return this.isValid(n)||t(this,n),n},n.autoValue=function(){return c.createGuid()},n.toODataValue=function(n){return"guid'"+n+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new i}(),n.date=function(){var n=function(){i.call(this,"date");c.tryFreeze(this)};return c.inherit(n,i),new n}(),n.dateTimeOffset=function(){var n=function(){i.call(this,"dateTimeOffset");c.tryFreeze(this)},t;return c.inherit(n,i),t=n.prototype,t.toODataValue=function(n){return n=this.handle(n),"datetimeoffset'"+b.getDateConverter().toISOString(n)+"'"},new n}(),n.time=function(){var i=function(){l.DataTypeBase.call(this,"time");c.tryFreeze(this)},n;return c.inherit(i,l.DataTypeBase),n=i.prototype,n.defaultValue=function(){return"00:00:00"},n.isValid=function(n){return/^([01]?\d|2[0-3])(((:[0-5]?\d){2}(\.\d{1,3}){0,1})|(:[0-5]?\d){0,2})?$/.test(n)},n.handle=function(n){return this.isValid(n)||t(this,n),n},n.autoValue=function(){return"00:00:00"},n.toODataValue=function(n){return"time'"+n+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new i}(),n.boolean=function(){var i=function(){l.DataTypeBase.call(this,"boolean");c.tryFreeze(this)},r;return c.inherit(i,l.DataTypeBase),r=i.prototype,r.defaultValue=function(){return!1},r.handle=function(i){if(!this.isValid(i)){if(n.string.isValid(i)){var r=i.toLowerCase();if(r=="true"||r=="1")return!0;if(r=="false"||r=="0")return!1}throw t(this,i);}return i},new i}(),n.int=function(){var r=0,i=function(){l.DataTypeBase.call(this,"int");c.tryFreeze(this)},n;return c.inherit(i,l.DataTypeBase),n=i.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return typeof n=="number"&&n%1==0},n.handle=function(n){var i=n;return typeof n!="number"&&(n=Number(n)),this.isValid(n)||t(this,i),n},n.autoValue=function(){return--r},new i}(),n.number=function(){var r=0,i=function(){l.DataTypeBase.call(this,"number");c.tryFreeze(this)},n;return c.inherit(i,l.DataTypeBase),n=i.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return!isNaN(n)&&typeof n=="number"},n.handle=function(n){var i=n;return typeof n!="number"&&(n=Number(n)),this.isValid(n)||t(this,i),n},n.autoValue=function(){return--r},new i}(),n.byte=function(){var r=0,i=function(){l.DataTypeBase.call(this,"byte");c.tryFreeze(this)},n;return c.inherit(i,l.DataTypeBase),n=i.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return typeof n=="number"&&n%1==0&&n>=0&&n<256},n.handle=function(n){var i=n;return typeof n!="number"&&(n=Number(n)),this.isValid(n)||t(this,i),n},n.autoValue=function(){return--r},new i}(),n.binary=function(){var t=function(){l.DataTypeBase.call(this,"binary");c.tryFreeze(this)},n;return c.inherit(t,l.DataTypeBase),n=t.prototype,n.defaultValue=function(){return'"AAAAAAAAAAA="'},n.isValid=function(){return!0},n.handle=function(n){return n},n.toODataValue=function(n){return n=this.handle(n),"X'"+b.getDateConverter().toISOString(n)+"'"},n.toBeetleValue=function(n){return'"'+n+'"'},new t}(),n.enumeration=function(){function i(n,t){var r,u,f,i,e;if(v.isArray(n))return r=0,c.forEach(n,function(n){r|=n.value}),r;if(u=Number(n),isNaN(u)||(n=u),v.isTypeOf(n,"string")){for(f=n.split(","),n=0,i=0;i<f.length;i++)if(e=t[f[i]],e!=null)n|=e.value;else return null;return n}return v.isTypeOf(n,"number")?n:v.isEnum(n,t)?n.value:null}var t=function(n,t,i){l.DataTypeBase.call(this,"enum");this.enumType=n;this.enumTypeName=t;this.displayName=i||t;c.tryFreeze(this)},n;return c.inherit(t,l.DataTypeBase),n=t.prototype,n.defaultValue=function(){return 0},n.isValid=function(n){return i(n,this.enumType)!=null},n.handle=function(n){var t=i(n,this.enumType);if(t==null)throw c.createError(a.invalidEnumValue,[n,this.enumTypeName],{enumType:this.enumType,value:n});return t},n.getRawValue=function(n){return v.isEnum(n,this.enumType)?n.value:n},n.toODataValue=function(n){return this.getRawValue(n)},n.toBeetleValue=function(n){return this.getRawValue(n)},t}(),n.geometry=function(){var t=function(){l.DataTypeBase.call(this,"geometry");this.isComplex=!0;c.tryFreeze(this)},n;return c.inherit(t,l.DataTypeBase),n=t.prototype,n.defaultValue=function(){return{$type:"System.Data.Spatial.DbGeometry",CoordinateSystemId:null,WellKnownText:"",WellKnownBinary:null}},n.isValid=function(n){return n.$tracker&&n.$tracker.getValue("WellKnownText")},n.handle=function(n){return n.$tracker&&(n.$tracker.entityType.isComplexType=!0),n},new t}(),n.geography=function(){var t=function(){l.DataTypeBase.call(this,"geography");this.isComplex=!0;c.tryFreeze(this)},n;return c.inherit(t,l.DataTypeBase),n=t.prototype,n.defaultValue=function(){return{$type:"System.Data.Spatial.DbGeography",CoordinateSystemId:null,WellKnownText:"",WellKnownBinary:null}},n.isValid=function(n){return n.$tracker&&n.$tracker.getValue("WellKnownText")},n.handle=function(n){return n.$tracker&&(n.$tracker.entityType.isComplexType=!0),n},new t}(),n.byName=function(t){var i=n[t];if(!i)throw c.createError(a.unknownDataType,[t]);return i},n.byValue=function(t){return n.string.isValid(t)?n.guid.isValid(t)?n.guid:n.date.tryParse(t)?n.date:n.string:n.date.isValid(t)?n.date:n.boolean.isValid(t)?n.boolean:n.int.isValid(t)?n.int:n.number.isValid(t)?n.number:n.array.isValid(t)?n.array:v.isObject(t)?n.object:n.binary},n.handle=function(t){var i=n.date.tryParse(t);return i!=null?i:t},n.toODataValue=function(t){return t==null?"null":n.byValue(t).toODataValue(t)},n.toBeetleValue=function(t){return t==null?"null":n.byValue(t).toBeetleValue(t)},n}(),Validator:function(){function t(t,i,r,u){var f=function(n){return n==null?!1:i.test(n)};return r=c.formatString(r||a.invalidValue,u),new n(t,f,r,{pattern:i})}var n=function(n,t,i,r){this.name=n;this.func=t;this.message=i;this.args=r;c.tryFreeze(this)},i=n.prototype;return i.toString=function(){var n=[],t;if(this.args)for(t in this.args)n.push(t+": "+this.args[t]);return n.length>0?this.name+" ("+n.join(", ")+")":this.name},i.validate=function(n,t){return this.func(n,t)==!0?null:this.message},n.byCode=function(t,i,r,u,f,e){var o=b.getLocalizeFunction();o&&(r=u&&o(u)||r,f=e&&o(e)||f);i=i||[];i.push(r);i.push(f);switch(t){case"re":return n.required.apply(null,i);case"sl":return n.stringLength.apply(null,i);case"ma":return n.maxLength.apply(null,i);case"mi":return n.minLength.apply(null,i);case"ra":return n.range.apply(null,i);case"rx":return n.regularExpression.apply(null,i);case"ea":return n.emailAddress.apply(null,i);case"cc":return n.creditCard.apply(null,i);case"ur":return n.url.apply(null,i);case"ph":return n.phone.apply(null,i);case"po":return n.postalCode.apply(null,i);case"ti":return n.time.apply(null,i);case"co":return n.compare.apply(null,i);default:throw c.createError(a.unknownValidator,[t]);}},n.required=function(t,i,r){var u=function(n){return n==null?!1:v.isTypeOf(n,"string")&&!t&&n==""?!1:!0};return i=c.formatString(i||a.requiredError,r),new n("Required",u,i,{allowEmptyStrings:t})},n.stringLength=function(t,i,r,u){var f=function(n){return!t&&!i?!0:v.isNotEmptyString(n)?t&&n.length<t?!1:i&&n.length>i?!1:!0:!1};return r=c.formatString(r||a.stringLengthError,u,t,i),new n("StringLength",f,r,{min:t,max:i})},n.maxLength=function(t,i,r){var u=function(n){return n==null?!0:t&&n.length>t?!1:!0};return i=c.formatString(i||a.maxLenError,r,t),new n("MaxLength",u,i,{length:t})},n.minLength=function(t,i,r){var u=function(n){return n==null?!1:t&&n.length<t?!1:!0};return i=c.formatString(i||a.minLenError,r,t),new n("MinLength",u,i,{length:t})},n.range=function(t,i,r,u){var f=function(n){return!t&&!i?!0:t&&n<t?!1:i&&n>i?!1:!0};return r=c.formatString(r||a.rangeError,u,t,i),new n("Range",f,r,{min:t,max:i})},n.regularExpression=function(n,i,r){return v.isTypeOf(n,"string")&&(n=new RegExp(n)),t("RegularExpression",n,i,r)},n.emailAddress=function(n,i){return t("EmailAddress",/^\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,3}$/,n,i)},n.creditCard=function(n,i){return t("CreditCard",/^((4\d{3})|(5[1-5]\d{2})|(6011)|(3[68]\d{2})|(30[012345]\d))[ -]?(\d{4})[ -]?(\d{4})[ -]?(\d{4}|3[4,7]\d{13})$/,n,i)},n.url=function(n,i){return t("Url",/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/,n,i)},n.phone=function(n,i){return t("Phone",/^(?!.*-.*-.*-)(?=(?:\d{8,10}$)|(?:(?=.{9,11}$)[^-]*-[^-]*$)|(?:(?=.{10,12}$)[^-]*-[^-]*-[^-]*$)  )[\d-]+$/,n,i)},n.postalCode=function(n,i){return t("PostalCode",/^\d{5}([\-]?\d{4})?$/,n,i)},n.time=function(n,i){return t("Time",/^([01]?\d|2[0-3])(((:[0-5]?\d){2}(\.\d{1,3}){0,1})|(:[0-5]?\d){0,2})?$/,n,i)},n.compare=function(t,i,r){var f=function(n,i){var r=c.getValue(i,t);return n==r},u=b.getLocalizeFunction(),e=u&&u(t)||t;return i=c.formatString(i||a.compareError,r,e),new n("Compare",f,i,{property:t})},n}(),EntityContainer:function(){function i(n,t){var i=new r(n);return t.push(i),i}var r=function(){function r(n,t){var r=i(n,t);return r>-1?t[r]:null}function i(n,t){var f=t.length,r,u,i;if(f>0)for(r=0,u=f-1;r<=u;){if(i=Math.floor((r+u)/2),t[i].key<n){r=i+1;continue}if(t[i].key>n){u=i-1;continue}return i}return-1}function u(n,t){for(var i=0;i<t.length&&n>t[i].key;)i++;return i}var t=function(n){this.typeName=n.name;this.keyIndex=[];c.tryFreeze(this)},n=t.prototype;return n.toString=function(){return this.typeName+": "+this.keyIndex.length},n.push=function(n,t){var i=u(n,this.keyIndex);this.keyIndex.splice(i,0,{key:n,entity:t})},n.remove=function(n){var t=i(n,this.keyIndex);this.keyIndex.splice(t,1)},n.getEntity=function(n){var t=r(n,this.keyIndex);return t?t.entity:null},n.getRelations=function(n,t){for(var r,u=[],i=0;i<this.keyIndex.length;i++)r=this.keyIndex[i],r.entity.$tracker.foreignKey(t)===n&&u.push(r.entity);return u},n.relocateKey=function(n,t,i){this.remove(t);i&&this.push(i,n)},n.getEntities=function(){var n=[];return c.forEach(this.keyIndex,function(t){n.push(t.entity)}),n},t}(),t=function(){this.entitySets=[];this.allEntities=[];c.tryFreeze(this)},n=t.prototype;return n.toString=function(){return this.allEntities.length},n.push=function(n){var u;this.allEntities.push(n);var i=n.$tracker,t=i.entityType,r=i.key;if(r)while(t)u=this.getEntitySet(t),u.push(r,n),t=t.baseType},n.remove=function(n){var i;c.removeFromArray(this.allEntities,n);var r=n.$tracker,t=r.entityType,u=r.key;if(u)while(t)i=this.findEntitySet(t),i&&(i.remove(u),t=t.baseType)},n.getEntities=function(){return this.allEntities},n.getEntityByKey=function(n,t){if(!n)return null;var i=this.findEntitySet(t);return i?i.getEntity(n):null},n.getRelations=function(n,t){var u=t.entityType,r=n.$tracker.key,i;return r?(i=this.findEntitySet(u),i)?i.getRelations(r,t):null:null},n.relocateKey=function(n,t,r){for(var u=n.$tracker.entityType,f;u;)f=this.findEntitySet(u),f?f.relocateKey(n,t,r):(f=i(u,this.entitySets),f.push(r,n)),u=u.baseType},n.getChanges=function(){return c.filterArray(this.allEntities,function(n){return!(n.$tracker.entityType.isComplexType&&n.$tracker.owners.length>0)&&n.$tracker.isChanged()})},n.count=function(){return this.allEntities.length},n.findEntitySet=function(n){return c.findInArray(this.entitySets,n.name,"typeName")},n.getEntitySet=function(n){var t=this.findEntitySet(n);return t||(t=i(n,this.entitySets)),t},t}(),EntitySet:function(){function i(n,t){var r,i,u;if(n==null)throw c.createError(a.cannotCheckInstanceOnNull);if(r=t.entityType,!r.isAssignableWith(n)&&(i=n.$tracker&&n.$tracker.entityType,u=i&&i.shortName||"Object",!i||!r.isAssignableWith(i)))throw c.createError(a.typeError,[u,r.shortName]);}var t=function(n,t){this.local=t.entities.getEntitySet(n);w.EntityQuery.call(this,n.setName,n,t)},n;return c.inherit(t,w.EntityQuery),n=t.prototype,n.toString=function(){return"EntitySet: "+this.entityType.shortName},n.create=function(n){var t=this.entityType.createEntity(n);return this.manager.addEntity(t),t},n.createDetached=function(n){return this.entityType.createEntity(n)},n.createRaw=function(n){return this.entityType.createRawEntity(n)},n.add=function(n){i(n,this);this.manager.addEntity(n)},n.attach=function(n){i(n,this);this.manager.attachEntity(n)},n.remove=function(n){i(n,this);this.manager.deleteEntity(n)},t}(),EntityTracker:function(){function h(n,t,i,r){r.entity=n;n.$tracker=r;r.entityType=t;r.entityState=y.entityStates.Detached;r.observableProvider=i;r.forceUpdate=!1;r.originalValues=[];r.changedValues=[];r.manager=null;r.owners=[];r.validationErrors=[];r.validationErrorsChanged=new p.Event("validationErrorsChanged",r);r.entityStateChanged=new p.Event("entityStateChanged",r);r.propertyChanged=new p.Event("propertyChanged",r);r.arrayChanged=new p.Event("arrayChanged",r);t.hasMetadata&&(r.key=e(r))}function l(n,t,i){var r={propertyChange:w,arrayChange:k,dataPropertyChange:d,scalarNavigationPropertyChange:g,pluralNavigationPropertyChange:nt,arraySet:tt};return i.observableProvider.toObservable(n,t,r)}function f(n,t){n.baseType&&f(n.baseType,t);n.initializer&&n.initializer.call(t,t)}function e(n,t,i){var e=n.entityType,o,r,u,f;if(e.keys.length==0)return null;for(o=[],r=0;r<e.keys.length;r++)u=e.keys[r],f=u===t?i:n.getValue(u.name),u.dataType.name=="guid"&&(f=f.toLowerCase()),o.push(f);return o.join(",")}function o(n,t,i,r){if(!n)throw c.createError(a.propertyNotFound,[t],{propertyName:t,entity:r.entity,manager:r.manager});var u=n.entityType.createQuery(i,r.manager);return n.isScalar?c.forEach(n.foreignKeys,function(t,i){var f=n.entityType.keys[i],e=r.getValue(t.name);u=u.where(f.name+" == @0",[e])}):c.forEach(n.foreignKeyNames,function(n,t){var i=r.getValue(r.entityType.keys[t]);u=u.where(n+" == @0",[i])}),u}function w(n,i,r,u){var s=!1,e,f,o;(v.isInstanceOf(u,p.ValueNotifyWrapper)&&(s=!u.fromBeetle,u=u.value),e=r(),e!==u)&&(f=n.$tracker,f.manager&&(o=f.manager.handleUnmappedProperties),o==null&&(o=b.handleUnmappedProperties),o!==!0||(u=p.dataTypes.handle(u),e!==u))&&(r(u),f.manager&&t(n,i,e,f),s||f.propertyChanged.notify({entity:n,property:i,oldValue:e,newValue:u}))}function k(n,i,r,u,f){var e=n.$tracker;e.manager&&t(n,null,null,e);e.arrayChanged.notify({entity:n,property:i,items:r,removedItems:u,addedItems:f})}function d(n,r,u,f){var rt=!1,nt=!1,s,k,h,y,w,g,d;if((v.isInstanceOf(f,p.ValueNotifyWrapper)&&(rt=f.fromBeetle,nt=!f.fromBeetle,f=f.value),s=u(),s!==f)&&(f=r.handle(f),s!==f)&&(r.dataType!==p.dataTypes.date&&r.dataType!==p.dataTypes.dateTimeOffset||s==null||f==null||s.valueOf()!==f.valueOf())){var o=n.$tracker,tt=null,l=null;if(r.isKeyPart){if(tt=o.key,l=e(o,r,f),o.manager&&(k=o.manager.getEntityByKey(l,o.entityType.floorType),k&&k!==n))throw c.createError(a.sameKeyExists,{key:l,entity:k});o.key=l}if(h=o.liveValidate,o.manager?(t(n,r.name,r.dataType.getRawValue(s),o),h==null&&(h=o.manager.liveValidate)):o.entityType.isComplexType&&c.forEach(o.owners,function(n){t(n.entity,n.property.name+"."+r.name,f,n.entity.$tracker)}),u(f),h==null&&(h=b.liveValidate),h===!0&&i(r.validate(n),o,r),nt||o.propertyChanged.notify({entity:n,property:r,oldValue:s,newValue:f}),r.isKeyPart&&(o.manager&&o.manager.entities.relocateKey(n,tt,l),it(n)),r.isComplex){for(y=s.$tracker.owners,w=y.length-1;w>=0;w--)g=y[w],g.entity==n&&g.property==r&&y.splice(w,1);y.length==0&&s.$tracker.manager&&s.$tracker.manager.detachEntity(s);f.$tracker.owners.push({entity:n,property:r})}o.manager&&(d=o.manager.autoFixScalar,d==null&&(d=b.autoFixScalar),c.forEach(r.relatedNavigationProperties,function(n){var t,i,r;if(n.isScalar===!0)if(t=o.foreignKey(n),t){if(i=o.getValue(n.name),i&&i.$tracker.key===t)return;r=null;d&&(r=o.manager.getEntityByKey(t,n.entityType));r?o.setValue(n.name,r):i&&o.setValue(n.name,new p.ValueNotifyWrapper(null,!0))}else o.setValue(n.name,null)}))}}function g(n,r,f,e){var g=!1,nt=!1,o,s,l,w,y,k,h,d;if(v.isInstanceOf(e,p.ValueNotifyWrapper)&&(g=e.fromBeetle,nt=!e.fromBeetle,e=e.value),o=f(),o!==e)if(r.checkAssign(e),f(e),s=n.$tracker,l=s.liveValidate,l==null&&s.manager&&(l=s.manager.liveValidate),l==null&&(l=b.liveValidate),l===!0&&i(r.validate(n),s,r),nt||s.propertyChanged.notify({entity:n,property:r,oldValue:o,newValue:e}),u(e,s.manager),r.isComplex){if(e==null)throw c.createError(a.complexCannotBeNull,[r.displayName],{entity:n,property:r});for(w=o.$tracker.owners,y=w.length-1;y>=0;y--)k=w[y],k.entity==n&&k.property==r&&w.splice(y,1);o.$tracker.owners.length==0&&o.$tracker.manager&&o.$tracker.manager.detachEntity(o);e.$tracker.owners.push({entity:n,property:r});t(n,r.name,e.$tracker.toRaw(),s)}else g||(r.triggerOwnerModify&&r.foreignKeys.length==0&&t(n,null,null,s),c.setForeignKeys(n,r,e)),h=r.inverse,h&&(h.isScalar?(o&&o.$tracker.setValue(h.name,null),e&&e.$tracker.setValue(h.name,n)):(o&&o.$tracker.getValue(h.name).remove(n),e&&(d=e.$tracker.getValue(h.name),c.findInArray(d,n)||d.push(n))))}function nt(n,r,f,e,o){var s=n.$tracker,h=s.liveValidate,l;h==null&&s.manager&&(h=s.manager.liveValidate);h==null&&(h=b.liveValidate);h===!0&&i(r.validate(n),s,r);r.triggerOwnerModify&&t(n,null,null,s);s.arrayChanged.notify({entity:n,property:r,items:f,removedItems:e,addedItems:o});l=r.inverse;l?(e&&c.forEach(e,function(t){t.$tracker.getValue(l.name)==n&&t.$tracker.setValue(l.name,null)}),o&&c.forEach(o,function(t){u(t,s.manager);t.$tracker.setValue(l.name,n)})):(e&&c.forEach(e,function(n){c.setForeignKeys(n,r,null)}),o&&c.forEach(o,function(t){u(t,s.manager);c.setForeignKeys(t,r,n)}))}function tt(n,t,i,r){var e,f,u,o;if(i!==r){if(e=b.getArraySetBehaviour(),e==y.arraySetBehaviour.NotAllowed)throw c.createError(a.settingArrayNotAllowed,{entity:n,property:t});if(f=[],u=c.filterArray(r,function(){return!0}),e==y.arraySetBehaviour.Replace?c.forEach(i,function(n){c.findInArray(u,n)?c.removeFromArray(u,n):f.push(n)}):e==y.arraySetBehaviour.Append&&c.forEach(r,function(n){c.findInArray(i,n)&&c.removeFromArray(u,n)}),f.length>0)for(o=f.length-1;o>=0;o--)i.splice(c.indexOf(i,f[o]),1);u.length>0&&i.push.apply(i,u)}}function it(n){var t=n.$tracker;c.forEach(t.entityType.navigationProperties,function(i){var r,f,u;i.isScalar?(r=i.inverse,r&&r.isScalar&&(f=t.getValue(i.name),f&&c.setForeignKeys(f,r,n))):(u=t.getValue(i.name),u&&u.length>0&&c.forEach(u,function(t){c.setForeignKeys(t,i,n)}))})}function u(n,t){if(n&&t&&!n.$tracker.entityType.isComplexType&&!t.isInManager(n)&&n.$tracker.manager!=t){if(n.$tracker.manager)throw c.createError(a.entityAlreadyBeingTracked,null,{entity:n,manager:t});t.addEntity(n)}}function t(n,i,r,u){var f=u.entityState;f==y.entityStates.Unchanged&&(c.forEach(u.entityType.navigationProperties,function(n){var r=n.inverse,i;r&&r.triggerOwnerModify&&(i=u.getValue(n.name),i&&(n.isScalar?t(i,null,null,i.$tracker):c.forEach(i,function(n){t(n,null,null,n.$tracker)})))}),u.toModified());rt(i,r,u.originalValues,u.changedValues)}function rt(n,t,i,r){var u,f;n!=null&&(t==null||t.$tracker==null||t.$tracker.entityType.isComplexType)&&(u=c.findInArray(i,n,"p"),u||i.push({p:n,v:t}),f=c.findInArray(r,n,"p"),f||r.push({p:n,v:t}))}function i(n,t,i){var r=[],u=i?c.filterArray(t.validationErrors,function(n){return n.property===i}):c.filterArray(t.validationErrors,function(){return!0});c.forEach(u,function(i){c.findInArray(n,i.validator,"validator")?c.removeFromArray(n,i.validator,"validator"):(c.removeFromArray(t.validationErrors,i),r.push(i))});t.validationErrors=t.validationErrors.concat(n);(r.length>0||n.length>0)&&t.validationErrorsChanged.notify({errors:t.validationErrors,added:n,removed:r})}function s(n){if(n.manager==null)throw c.createError(a.entityNotBeingTracked,{entity:entity,manager:n});}var r=function(n,t,i){delete n.$type;delete n.$id;h(n,t,i||b.getObservableProvider(),this);l(n,t,this);f(t,n)},n=r.prototype;return n.toString=function(){return"EntityTracker: "+this.entityType.shortName+", key: "+this.key},n.setManagerInfo=function(n){if(this.manager)throw c.createError(a.entityAlreadyBeingTracked,{otherManager:this.manager});c.assertPrm(n,"manager").isInstanceOf(p.EntityManager).check();this.manager=n},n.isChanged=function(){return this.entityState===y.entityStates.Added||this.entityState===y.entityStates.Deleted||this.entityState===y.entityStates.Modified},n.delete=function(){s(this);this.manager.deleteEntity(this.entity)},n.detach=function(){s(this);this.manager.detachEntity(this.entity)},n.toAdded=function(){if(this.entityState!=y.entityStates.Added){var n={entity:this.entity,oldState:this.entityState,newState:y.entityStates.Added,newChanged:!this.isChanged()};this.entityState=y.entityStates.Added;this.entityStateChanged.notify(n)}},n.toModified=function(){if(this.entityState!=y.entityStates.Modified){var n={entity:this.entity,oldState:this.entityState,newState:y.entityStates.Modified,newChanged:!this.isChanged()};this.entityState=y.entityStates.Modified;this.entityStateChanged.notify(n)}},n.toDeleted=function(){if(this.entityState!=y.entityStates.Deleted){var n={entity:this.entity,oldState:this.entityState,newState:y.entityStates.Deleted,newChanged:!this.isChanged()};this.entityState=y.entityStates.Deleted;this.entityStateChanged.notify(n)}},n.toUnchanged=function(){if(this.entityState!=y.entityStates.Unchanged){var n={entity:this.entity,oldState:this.entityState,newState:y.entityStates.Unchanged,newUnchanged:this.isChanged()};this.originalValues.length=0;this.changedValues.length=0;this.entityState=y.entityStates.Unchanged;this.entityStateChanged.notify(n)}},n.toDetached=function(){if(this.entityState!=y.entityStates.Detached){var n={entity:this.entity,oldState:this.entityState,newState:y.entityStates.Detached,newUnchanged:this.isChanged()};this.entityState=y.entityStates.Detached;this.entityStateChanged.notify(n)}},n.rejectChanges=function(){var n=this;c.forEach(this.originalValues,function(t){n.setValue(t.p,t.v)});this.originalValues.length=0},n.undoChanges=function(){var n=this;c.forEach(this.changedValues,function(t){n.setValue(t.p,t.v)});this.changedValues.length=0},n.acceptChanges=function(){this.changedValues.length=0},n.getValue=function(n){return this.observableProvider.getValue(this.entity,n)},n.setValue=function(n,t){this.observableProvider.setValue(this.entity,n,t)},n.getOriginalValue=function(n){var t=c.findInArray(this.originalValues,n,"p");return t?t.v:this.getValue(n)},n.foreignKey=function(n){var r=n.entityType,u,t;if(r.keys.length==0)return null;for(u=[],t=0;t<r.keys.length;t++){var f=r.keys[t],e=n.foreignKeyNames[t],i=this.getValue(e);if(i==null)return null;f.dataType.name=="guid"&&(i=i.toLowerCase());u.push(i)}return u.join(",")},n.createLoadQuery=function(n,t){var i=c.findInArray(this.entityType.navigationProperties,n,"name");return o(i,n,t,this)},n.loadNavigationProperty=function(n,t,i,r,u,f){var s,e,h;if(this.manager==null)throw c.createError(a.entityNotBeingTracked,{entity:this.entity});return s=c.findInArray(this.entityType.navigationProperties,n,"name"),e=o(s,n,i,this),t&&c.forEach(t,function(n){e=e.expand(n)}),h=this,r=r||{},r.merge==null&&(r.merge=y.mergeStrategy.Preserve),r.autoFixScalar==null&&(r.autoFixScalar=!0),r.autoFixPlural==null&&(r.autoFixPlural=!0),this.manager.executeQuery(e,r,function(){s.inverse||h.manager.fixNavigations(entity);u&&u.apply(null,arguments)},f)},n.validate=function(){return this.entityState==y.entityStates.Deleted?this.validationErrors=[]:i(this.entityType.validate(this.entity),this),this.validationErrors},n.toRaw=function(n,t){t=t||[];t.push(this.entity);var r=this.entityType,i={},u=this;return r.hasMetadata&&(c.forEach(r.dataProperties,function(r){var f=u.getValue(r.name);f!=null&&f.$tracker?(n==!0||f.$tracker.entityType.isComplexType)&&(i[r.name]=f.$tracker.toRaw(n,t)):i[r.name]=r.dataType.getRawValue(f)}),n==!0&&c.forEach(r.navigationProperties,function(n){var r=u.getValue(n.name);r==null?i[n.name]=null:v.isArray(r)?(i[n.name]=[],c.forEach(r,function(r){r==null||t.indexOf(r)>=0||(r.$tracker?i[n.name].push(r.$tracker.toRaw(!0,t)):i[n.name].push(r))})):i[n.name]=t.indexOf(r)>=0?null:r.$tracker.toRaw(!0,t)})),c.forEach(r.properties,function(r){var f=u.getValue(r);v.isArray(f)?(i[r]=[],c.forEach(f,function(u){u==null||t.indexOf(f)>=0||(u.$tracker?n==!0&&i[r].push(u.$tracker.toRaw(!0,t)):i[r].push(u))})):f!=null&&f.$tracker?(n==!0||f.$tracker.entityType.isComplexType)&&(i[r]=t.indexOf(f)>=0?null:f.$tracker.toRaw(n,t)):i[r]=f}),i},r.toEntity=function(n,t,i){return new p.EntityTracker(n,t,i).entity},r}(),EntityManager:function(){function f(n,t,f,e,o,s){var c,h,l,a,w,p;return(f=f||{},c=f.async,c==null&&(c=s.workAsync),c==null&&(c=b.workAsync),f.async=c,h=c?s.promiseProvider:null,l=null,h&&(l=h.deferred()),a=f.makeObservable,a==null&&(a=!0),w=f.state==y.entityStates.Detached,p=null,s.dataService.createEntityAsync(n,t,f,function(n,t,c,b){var g,k,d;try{g=!1;v.isArray(n)||(n=[n],g=!0);a&&!w&&r(n,t,y.mergeStrategy.ThrowError,y.entityStates.Added,s);g&&(n=n[0]);k={};k.userData=c("X-UserData");d=k.userData!=null;f.includeHeaderGetter===!0&&(k.headerGetter=c,d=!0);f.includeXhr===!0&&(k.xhr=b,d=!0);d&&(n.$extra=k);u(e,h,l,n);h||(p=n)}catch(nt){i(o,h,l,n,s)}},function(t){t.typeName=n;i(o,h,l,t,s)}),h)?h.getPromise(l):p}function o(n,t,i,u){var f=y.mergeStrategy.ThrowError,e=i;t?(t.merge!=null&&(f=t.merge),t.state!=null&&(e=t.state)):t={};v.isArray(n)||(n=[n]);r(n,null,f,e,u,t.autoFixScalar,t.autoFixPlural)}function ht(t,i){function w(n,t){return function(i){c.extend(this,i);t.createEntity(n,this)}}function k(n){return function(t,i){c.extend(this,t);i==!0?n.createRawEntity(this):n.createEntity(this)}}var o,h,f;if(i._readyCallbacks=[],i._readyPromises=[],t.length<1||t.length>3)throw c.createError(a.managerInvalidArgs,{entityManager:i});var e=t[0],u=t[1],r=t[2];if(v.isInstanceOf(e,l.DataServiceBase))i.dataService=e,r=t[1];else if(v.isTypeOf(e,"string"))t.length===2&&v.isObject(u)&&!v.isInstanceOf(u,d.MetadataManager)&&(r=u,u=undefined),o=b.getDefaultServiceType(),h=o===y.serviceTypes.WebApi?tt.WebApiService:tt.MvcService,i.dataService=new h(e,u,r);else throw c.createError(a.managerInvalidArgs,{entityManager:this,arguments:t});r=r||{};i.promiseProvider=r.promiseProvider||b.getPromiseProvider();i.autoFixScalar=r.autoFixScalar;i.autoFixPlural=r.autoFixPlural;i.validateOnMerge=r.validateOnMerge;i.validateOnSave=r.validateOnSave;i.liveValidate=r.liveValidate;i.handleUnmappedProperties=r.handleUnmappedProperties;i.forceUpdate=r.forceUpdate;i.workAsync=r.workAsync;i.minimizePackage=r.minimizePackage;i.pendingChangeCount=0;i.entities=new p.EntityContainer;i.validationErrors=[];i.entityStateChanged=new p.Event("entityStateChanged",i);i.validationErrorsChanged=new p.Event("validationErrorsChanged",i);i.hasChangesChanged=new p.Event("hasChangesChanged",i);i.queryExecuting=new p.Event("queryExecuting",i);i.queryExecuted=new p.Event("queryExecuted",i);i.saving=new p.Event("saving",i);i.saved=new p.Event("saved",i);f=r.registerMetadataTypes;f==null&&(f=b.registerMetadataTypes);i.dataService.ready(function(){var l=i.dataService.metadataManager,u,e,r,t,o,a,h,c;if(l){if(u=l.types,u)for(i.entitySets={},e=0;e<u.length;e++)r=u[e],t=r.shortName,f&&(t in i||(i[t]=w(t,i)),t in n||(n[t]=k(r))),o=r.setName,o&&!i.entitySets.hasOwnProperty(o)&&(a=i.createSet(r),f&&(i[o]=a),i.entitySets[t]=a);if(h=l.enums,h)for(c in h)c in n||(n[c]=h[c])}s(i)})}function s(n){var i,e,t,r,u,f;if(n.isReady())for(i=n._readyCallbacks.slice(0),e=n._readyPromises.slice(0),n._readyCallbacks=[],n._readyPromises=[],t=0;t<i.length;t++)r=i[t],r&&r.call(n),u=e[t],u&&(f=n.promiseProvider,f&&f.resolve(u))}function r(n,t,i,r,u,f,e){var s;if(r){if(r===y.entityStates.Detached)return}else r=y.entityStates.Added;i||(i=y.mergeStrategy.Preserve);f==null&&(f=u.autoFixScalar);f==null&&(f=b.autoFixScalar);e==null&&(e=u.autoFixPlural);e==null&&(e=b.autoFixPlural);s=u.validateOnMerge;s==null&&(s=b.validateOnMerge);t=t||u.flatEntities(v.isArray(n)?n:[n]);var l=[],p=[],h=[],o=u;c.forEach(t,function(n){var r;if(n!=null){if(r=n.$tracker,!r&&n.$type)r=o.toEntity(n,n.$type).$tracker;else if(r.entityType.isComplexType||u.isInManager(n))return;var f=r.entityType,e=r.key,t=null;if(e&&(t=o.entities.getEntityByKey(e,f.floorType)),t){if(f.name!==t.$tracker.entityType.name)throw c.createError(a.sameKeyOnDifferentTypesError,[t.$tracker.entityType.shortName,f.shortName],{existingEntity:t,entity:n,manager:o});if(i===y.mergeStrategy.ThrowError)throw c.createError(a.sameKeyExists,{existingEntity:t,entity:n,manager:o});else i===y.mergeStrategy.Preserve?h.push({o:n,n:t}):(h.push({o:n,n:t}),p.push({o:t,n:n}))}else o.entities.push(n),n.$tracker.setManagerInfo(o),l.push(n)}});c.forEach(l,function(n){g(n,f,e,o);yt(n,o);k(n,r);s===!0&&n.$tracker.validate()});c.forEach(p,function(n){ct(n.o,n.n);k(n.o,r)});c.forEach(h,function(t){var i=c.indexOf(n,t.o);i>=0&&(n[i]=t.n);lt(t.o,t.n,f,e,o)})}function h(n,t){if(!t.isInManager(n))throw c.createError(a.entityNotBeingTracked,{entity:n,manager:t});}function k(n,t){if(t===y.entityStates.Unchanged)n.$tracker.toUnchanged();else if(t===y.entityStates.Modified)n.$tracker.toModified();else if(t===y.entityStates.Added)n.$tracker.toAdded();else if(t===y.entityStates.Deleted)n.$tracker.toDeleted();else throw c.createError(a.mergeStateError,[t],{entity:n,state:t});}function ct(n,t){var i=t.$tracker;c.forEach(i.entityType.dataProperties,function(t){n.$tracker.setValue(t.name,i.getValue(t.name))})}function g(n,t,i,r){if(t==!0||i==!0){var u=n.$tracker,f=u.entityType;c.forEach(f.navigationProperties,function(f){var e=u.getValue(f.name),o,h,s,c;if(f.isComplex){for(o=e.$tracker.owners,h=!1,s=0;s<o.length;s++)if(c=o[s],c.entity==n&&c.property==f){h=!0;break}h||o.push({entity:n,property:f})}else f.isScalar?it(u,e,f,f.name,t,r):(rt(e,r),i&&ft(n,f,e,r))});c.forEach(f.dataProperties,function(t){var f,i,e,r,o;if(t.isComplex){for(f=u.getValue(t.name),f.$tracker.entityType.isComplexType=!0,i=f.$tracker.owners,e=!1,r=0;r<i.length;r++)if(o=i[r],o.entity==n&&o.property==t){e=!0;break}e||i.push({entity:n,property:t})}});c.forEach(u.entityType.properties,function(n){var t=u.getValue(n);v.isArray(t)?rt(t,r):it(u,t,null,n,!1,r)})}}function it(n,t,i,r,u,f){t?(t.$tracker&&t.$tracker.manager!=f&&(t=f.getEntityByKey(t.$tracker.key,t.$tracker.entityType),n.setValue(r,t)),i&&c.setForeignKeys(n.entity,i,t)):i&&u&&ut(n,i,f)}function rt(n,t){for(var r,u,i=n.length-1;i>=0;i--)r=n[i],r&&r.$tracker&&r.$tracker.manager!=t&&(u=t.getEntityByKey(r.$tracker.key,r.$tracker.entityType),u?n.splice(i,1,u):n.splice(i,1))}function lt(n,t,i,r,u){var e=t.$tracker,s,f,o,h;e.entityState!=y.entityStates.Deleted&&(s=n.$tracker,h=s.entityType,c.forEach(h.navigationProperties,function(h){var y,p,l,a,v;h.isComplex||(f=s.getValue(h.name),o=e.getValue(h.name),h.isScalar?o||(i==!0?ut(e,h,u):i===!0&&h.inverse&&h.inverse.isScalar||r===!0&&h.inverse&&!h.inverse.isScalar||(y=s.foreignKey(h),p=e.foreignKey(h),y==p&&f!=null&&u.isInManager(f)&&(l=h.inverse,l?l.isScalar?f.$tracker.setValue(l.name,t):(a=f.$tracker.getValue(l.name),v=c.indexOf(a,n),v>=0&&a.splice(v,1,t)):e.setValue(h.name,f)))):r?ft(t,h,o,u):i===!0&&h.inverse||c.forEach(f,function(n){u.isInManager(n)&&!c.findInArray(o,n)&&o.push(n)}))}))}function ut(n,t,i){var u=n.foreignKey(t),r=i.entities.getEntityByKey(u,t.entityType);r&&r.$tracker.entityState==y.entityStates.Deleted&&(r=null);n.setValue(t.name,r)}function ft(n,t,i,r){var u=r.entities.getRelations(n,t);u&&c.forEach(u,function(n){n.$tracker.entityState==y.entityStates.Deleted||c.findInArray(i,n)||i.push(n)})}function et(n,t){var i=n.$tracker,r=i.entityType,u=t?new p.ValueNotifyWrapper(null,!0):null;r.hasMetadata&&c.forEach(r.navigationProperties,function(n){n.isScalar?i.setValue(n.name,u):i.getValue(n.name).splice(0)})}function at(n,t,i){c.forEach(n,function(n){n.$tracker.entityState==y.entityStates.Deleted?(n.$tracker.toDetached(),ot(n,i),t.remove(n)):n.$tracker.toUnchanged()})}function vt(n,t,i){if(t.removed.length>0)for(var r=t.removed.length-1;r>=0;r--)i.validationErrors.splice(c.indexOf(i.validationErrors,t.removed[r]),1);t.added.length>0&&i.validationErrors.push.apply(i.validationErrors,t.added);(t.removed.length>0||t.added.length>0)&&i.validationErrorsChanged.notify({errors:i.validationErrors,added:t.added,removed:t.removed})}function yt(n,t){n.$tracker.entityStateChanged.subscribe(function(n){var i=t.pendingChangeCount;n.newChanged===!0?t.pendingChangeCount++:n.newUnchanged===!0&&t.pendingChangeCount--;t.entityStateChanged.notify(n);i==0&&t.pendingChangeCount>0?t.hasChangesChanged.notify({hasChanges:!0}):i>0&&t.pendingChangeCount==0&&t.hasChangesChanged.notify({hasChanges:!1})});n.$tracker.validationErrorsChanged.subscribe(function(i){vt(n,i,t)})}function ot(n,t){n.$tracker.entityStateChanged.unsubscribe(t.entityStateChanged.notify);n.$tracker.validationErrorsChanged.unsubscribe(t.validationErrorsChanged.notify);var i=c.filterArray(t.validationErrors,function(t){return t.entity==n});c.removeFromArray(t.validationErrors,n,"entity");t.validationErrorsChanged.notify({errors:t.validationErrors,removed:i,added:[]})}function pt(n,t,i){var r={manager:n,query:t,options:i};return n.queryExecuting.notify(r),nt.queryExecuting.notify(r),r}function st(n,t,i,r){var u={manager:n,query:t,options:i,result:r};return n.queryExecuted.notify(u),nt.queryExecuted.notify(u),u.result}function wt(n,t,i,r){var u={manager:n,changes:t,savePackage:i,options:r};return n.saving.notify(u),nt.saving.notify(u),u.options}function bt(n,t,i,r){var u={manager:n,changes:t,savePackage:i,options:r};n.saved.notify(u);nt.saved.notify(u)}function u(n,t,i,r){n&&n(r);t&&t.resolve(i,r)}function i(n,t,i,r,u){if(r.manager=u,n&&n(r),t&&t.reject(i,r),!n&&!t)throw r;}var e=function(){ht(arguments,this)},t=e.prototype;return t.toString=function(){return this.dataService.toString()+", "+a.pendingChanges+": "+this.pendingChangeCount+", "+a.validationErrors+": "+this.validationErrors.length},t.isReady=function(){return this.dataService.isReady()},t.ready=function(n){var t,i,r,u;return this._readyCallbacks.push(n),t=this.promiseProvider,i=null,t&&(r=t.deferred(),this._readyPromises.push(r),i=t.getPromise(r)),u=this,setTimeout(function(){s(u)},10),i},t.getEntityType=function(n){return this.dataService.getEntityType(n)},t.createQuery=function(n,t){return this.dataService.createQuery(n,t,this)},t.createEntityQuery=function(n,t){return this.dataService.createEntityQuery(n,t,this)},t.registerCtor=function(n,t,i){this.dataService.registerCtor(n,t,i)},t.createEntity=function(n,t){var i=this.dataService.createEntity(n,t),u=[i];return r(u,null,y.mergeStrategy.ThrowError,y.entityStates.Added,this),i},t.createDetachedEntity=function(n,t){return this.dataService.createEntity(n,t)},t.createRawEntity=function(n,t){return this.dataService.createRawEntity(n,t)},t.createEntityAsync=function(n,t,i,r,u){return f(n,t,i,r,u,this)},t.createDetachedEntityAsync=function(n,t,i,r,u){return i?i.state=y.entityStates.Detached:i={state:y.entityStates.Detached},f(n,t,i,r,u,this)},t.createRawEntityAsync=function(n,t,i,r,u){return i?i.makeObservable=!1:i={makeObservable:!1},f(n,t,i,r,u,this)},t.executeQuery=function(n,t,f,e){var d,l,o,p,g,nt,k;n.options&&(t=c.combine(n.options,t));d=pt(this,n,t);n=d.query;t=d.options;t=t||{};l=t.async;l==null&&(l=this.workAsync);l==null&&(l=b.workAsync);o=l?this.promiseProvider:null;p=null;o&&(p=o.deferred());var h=y.mergeStrategy.Preserve,s=y.executionStrategy.Server,w=null;if(v.isEnum(t,y.mergeStrategy)?(h=t,t={makeObservable:h!=y.mergeStrategy.NoTrackingRaw}):v.isEnum(t,y.executionStrategy)?s=t:(t.merge&&(h=t.merge),t.execution&&(s=t.execution),t.async=l,t.makeObservable=h!=y.mergeStrategy.NoTrackingRaw,t.handleUnmappedProperties==null&&(t.handleUnmappedProperties=this.handleUnmappedProperties)),g=h==y.mergeStrategy.NoTracking||h==y.mergeStrategy.NoTrackingRaw,g&&s==y.executionStrategy.Both)throw c.createError(a.executionBothNotAllowedForNoTracking,{executionStrategy:s,mergeStrategy:h});return((s==y.executionStrategy.Local||s==y.executionStrategy.LocalIfEmptyServer)&&(w=this.executeQueryLocally(n,t.varContext)),nt=null,s==y.executionStrategy.Local||s==y.executionStrategy.LocalIfEmptyServer&&w&&(w.length==null||w.length>0)?(w=st(this,n,t,w),u(f,o,p,w)):(k=this,this.dataService.executeQuery(n,t,function(c,l,a,w){var it,b,d,tt;try{it=!1;b=a("X-InlineCount");b!=null&&(b=Number(b));c&&(g||(v.isArray(c)||(c=[c],it=!0),r(c,l,h,y.entityStates.Unchanged,k,t.autoFixScalar,t.autoFixPlural),it&&(c=c[0])));s==y.executionStrategy.Both&&(c=k.executeQueryLocally(n,t.varContext,!0),c.$inlineCountDiff!=null&&(b!=null&&(b+=c.$inlineCountDiff),delete c.$inlineCountDiff));c&&v.isObject(c)&&(n.inlineCountEnabled&&b!=null&&(c.$inlineCount=b),d={},d.userData=a("X-UserData"),tt=d.userData!=null,t.includeHeaderGetter===!0&&(d.headerGetter=a,tt=!0),t.includeXhr===!0&&(d.xhr=w,tt=!0),tt&&(c.$extra=d));c=st(k,n,t,c);u(f,o,p,c);o||(nt=c)}catch(rt){i(e,o,p,rt,k)}},function(t){t.query=n;i(e,o,p,t,k)})),o)?o.getPromise(p):nt},t.executeQueryLocally=function(n,t,i){var s=n.entityType,h,f,u,l,v;if(s)if(f=this.entities.findEntitySet(s),f)h=f.getEntities();else return[];else throw c.createError(a.typeRequiredForLocalQueries);i&&n.getExpression(w.expressions.GroupByExp,!1)&&(nt.warning.notify({message:a.countDiffCantBeCalculatedForGrouped,query:n,options:t}),i=!1);var r=[],e=[],o=[];return c.forEach(h,function(n){n.$tracker.entityState==y.entityStates.Added?(i&&e.push(n),r.push(n)):n.$tracker.entityState==y.entityStates.Deleted?i&&o.push(n):r.push(n)}),u=n.toFunction(),r=u(r,t),i&&r.$inlineCount!=null&&(l=e.length>0?u(e,t).$inlineCount:0,v=o.length>0?u(o,t).$inlineCount:0,r.$inlineCountDiff=l-v),r},t.getEntityByKey=function(n,t){var i=v.isInstanceOf(t,d.EntityType)?t:this.getEntityType(t,!0);return this.entities.getEntityByKey(n,i)},t.deleteEntity=function(n){var t,i,r;for(h(n,this),t=this,i=[],c.forEach(n.$tracker.entityType.navigationProperties,function(r){var u,f;if(r.cascadeDelete){if(r.inverse&&r.inverse.cascadeDelete)throw c.createError(a.twoEndCascadeDeleteNotAllowed,{entity:n,property:r});u=n.$tracker.getValue(r.name);u&&(r.isScalar?r.foreignKeys!=null&&r.foreignKeys.length>0?i.push(u):t.deleteEntity(u):(f=c.filterArray(u,function(){return!0}),c.forEach(f,function(n){t.deleteEntity(n)})))}}),n.$tracker.entityState===y.entityStates.Added?this.detachEntity(n):(et(n,!0),n.$tracker.toDeleted()),r=0;r<i.length;r++)t.deleteEntity(i[r])},t.addEntity=function(n,t){o(n,t,y.entityStates.Added,this)},t.attachEntity=function(n,t){o(n,t,y.entityStates.Unchanged,this)},t.detachEntity=function(n,t){var i=this,r;v.isArray(n)||(n=[n]);r=t===!0?this.flatEntities(n):n;c.forEach(r,function(n){if(n.$tracker.entityType.isComplexType&&n.$tracker.owners.length>0)throw c.createError(a.cannotDetachComplexTypeWithOwners);h(n,i);et(n,!0);ot(n,i);n.$tracker.toDetached();n.$tracker.manager=null;i.entities.remove(n)})},t.rejectChanges=function(n,t){var r=this,i;v.isArray(n)||(n=[n]);i=t===!0?this.flatEntities(n):n;c.forEach(i,function(n){var t=n.$tracker;t.entityState==y.entityStates.Added?r.detachEntity(n):t.entityState!=y.entityStates.Detached&&(t.rejectChanges(),t.toUnchanged())})},t.undoChanges=function(n,t){v.isArray(n)||(n=[n]);var i=t===!0?this.flatEntities(n):n;c.forEach(i,function(n){n.$tracker.undoChanges()})},t.acceptChanges=function(n,t){v.isArray(n)||(n=[n]);var i=t===!0?this.flatEntities(n):n;c.forEach(i,function(n){n.$tracker.acceptChanges()})},t.createSavePackage=function(n,t){var u,i,e,r,f,o;if(n=n||this.getChanges(),t=t||{},u=[],i=t.validateOnSave,i==null&&(i=this.validateOnSave),i==null&&(i=b.validateOnSave),i===!0&&c.forEach(n,function(n){if(n.$tracker.entityState!=y.entityStates.Deleted){var t=n.$tracker.validate();t&&t.length>0&&u.push({entity:n,validationErrors:t})}}),u.length>0)throw c.createError(a.validationFailed,{entities:n,entitiesInError:u});return e=t.userData||null,r=t.forceUpdate,r==null&&(r=this.forceUpdate),r==null&&(r=b.forceUpdate),f={userData:e,forceUpdate:r},o=this.exportEntities(n,t),f.entities=o,f},t.exportEntities=function(n,t){var r,i;return t=t||{},r=[],n=n||this.entities.getEntities(),i=t.minimizePackage,i==null&&(i=this.minimizePackage),i==null&&(i=b.minimizePackage),c.forEach(n,function(n,t){var u=n.$tracker,l=u.entityType,e=u.entityState,o=u.forceUpdate,s={},f,h;if(i===!0)if(e==y.entityStates.Modified)if(u.originalValues.length>0)f={},c.forEach(u.originalValues,function(t){var o,r=t.p.split("."),s,e,i;if(r.length>1){for(s=0;s<r.length-1;s++)e=r[s],n=n.$tracker.getValue(e),f[e]==null&&(f[e]={}),f=f[e];o=r[r.length-1]}else o=t.p;i=u.getValue(o);i&&i.$tracker&&(i=i.$tracker.toRaw());f[o]=i}),c.forEach(u.entityType.dataProperties,function(n){(n.isKeyPart===!0||n.useForConcurrency===!0)&&(f[n.name]=u.getValue(n.name))});else if(o===!0)f=u.toRaw(n);else return;else if(e==y.entityStates.Deleted)f={},c.forEach(u.entityType.dataProperties,function(n){(n.isKeyPart===!0||n.useForConcurrency===!0)&&(f[n.name]=u.getValue(n.name))});else if(e==y.entityStates.Added)f=u.toRaw(n);else return;else f=u.toRaw(n);e==y.entityStates.Modified&&c.forEach(u.originalValues,function(n){var t=n.v;t&&t.$tracker&&(t=t.$tracker.toRaw());s[n.p]=t});h={t:l.name,s:e.toString(),o:s,i:t,f:o};f.$t=h;r.push(f)}),r},t.importEntities=function(n,t){var i=this;v.isArray(n)||(n=[n]);c.forEach(n,function(n){var u=n.$t,e,f,o,s;switch(u.s){case"Unchanged":e=y.entityStates.Unchanged;break;case"Added":e=y.entityStates.Added;break;case"Deleted":e=y.entityStates.Deleted;break;case"Modified":e=y.entityStates.Modified;break;default:throw c.createError(a.unsoppertedState,[u.s],{entity:n});}if(f=i.toEntity(n,u.t),r(f,[f],t||y.mergeStrategy.Preserve,e,i,!0,!0),u.o)for(o in u.o)s=u.o[o],f.$tracker.originalValues.push({p:o,v:s});f.$tracker.forceUpdate=u.forceUpdate;delete f.$t})},t.hasChanges=function(){return this.pendingChangeCount>0},t.getChanges=function(){return this.entities.getChanges()},t.saveChanges=function(n,t,i){return this.savePackage(null,n,t,i)},t.savePackage=function(n,t,f,e){var a,s,h,o,p,l;if(t=t||{},a=t.async,a==null&&(a=this.workAsync),a==null&&(a=b.workAsync),t.async=a,s=a?this.promiseProvider:null,h=null,s&&(h=s.deferred()),!n)if(t.entities?(o=t.entities,v.isArray(o)||(o=[o])):o=this.getChanges(),o.length)try{n=this.createSavePackage(o,t)}catch(w){i(e,s,h,w,this)}else u(f,s,h,{AffectedCount:0,GeneratedValues:[]});if(p=null,n){t=wt(this,o,n,t);try{l=this;this.dataService.saveChanges(n,t,function(a,v,w){try{a.GeneratedEntities!=null&&a.GeneratedEntities.length>0&&r(a.GeneratedEntities,null,y.mergeStrategy.Preserve,y.entityStates.Unchanged,l,t.autoFixScalar,t.autoFixPlural);a.GeneratedValues&&c.forEach(a.GeneratedValues,function(n){var u,e,i,f,h,s;if(!(n.Index<0)){if(u=o[n.Index],i=n.Property.split("."),i.length>1){for(f=0;f<i.length-1;f++)u=u.$tracker.getValue(i[f]);e=i[i.length-1]}else e=n.Property;h=u.$tracker;n.Value!=null&&n.Value.$type&&(s=[n.Value],r(s,null,y.mergeStrategy.Preserve,y.entityStates.Unchanged,l,t.autoFixScalar,t.autoFixPlural),n.Value=s[0]);h.setValue(e,n.Value)}});at(o,l.entities,l);a.userData=v("X-UserData");t.includeHeaderGetter===!0&&(a.headerGetter=v);t.includeXhr===!0&&(a.xhr=w);bt(l,o,n,t);u(f,s,h,a);s||(p=a)}catch(b){b.changes=o;b.savePackage=n;i(e,s,h,b,l)}},function(t){t.changes=o;t.savePackage=n;i(e,s,h,t,l)})}catch(w){i(e,s,h,w,this)}}return s?s.getPromise(h):p},t.toEntity=function(n,t){return n.$type&&!t&&(t=n.$type),this.dataService.toEntity(n,t)},t.fixNavigations=function(n){if(!this.isInManager(n))throw c.createError(a.entityNotBeingTracked,null,{entity:n});g(n,!0,!0,this)},t.isInManager=function(n){return n.$tracker.manager==this},t.flatEntities=function(n){var i=this,t=arguments[1]||[];return v.isArray(n)||(n=[n]),c.forEach(n,function(n){var r,e,f,u;if(n!=null){if(v.isArray(n)){i.flatEntities(n,t);return}if(!c.findInArray(t,n))if(r=n.$tracker,e=n.$type,r)t.push(n),r.entityType.hasMetadata?(c.forEach(r.entityType.dataProperties,function(n){if(n.isComplex){var u=r.getValue(n.name);u&&(v.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t))}}),c.forEach(r.entityType.navigationProperties,function(n){var u=r.getValue(n.name);u&&(v.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t))})):c.forEach(r.entityType.properties,function(n){var u=r.getValue(n);u&&(v.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t))});else if(e){t.push(n);for(f in n)f!=="$type"&&(u=n[f],u&&(v.isArray(u)?i.flatEntities(u,t):(u.$tracker||u.$type)&&i.flatEntities([u],t)))}}}),t},t.entry=function(n){return n.$tracker},t.createSet=function(n){return v.isInstanceOf(n,d.EntityType)||(v.isFunction(n)&&(n=c.getFuncName(n)),n=this.getEntityType(n,!0)),new p.EntitySet(n,this)},t.set=function(n){return v.isFunction(n)&&(n=c.getFuncName(n)),this.entitySets&&this.entitySets[n]},t.clear=function(){this.pendingChangeCount=0;this.entities=new p.EntityContainer;this.validationErrors=[]},e}(),EntityBase:function(){return function(n,t,i){i&&c.extend(this,i);n.createEntity(this);t!=null&&t.addEntity(this)}}()}}(),tt=function(){var n={};return n.MvcService=function(){function i(n){var t=0,i,r,u;if(n.length==0)return t;for(i=0,u=n.length;i<u;i++)r=n.charCodeAt(i),t=(t<<5)-t+r|0;return t}var t=function(n,t,i){l.DataServiceBase.call(this,n,t,i)},n;return c.inherit(t,l.DataServiceBase),n=t.prototype,n.fetchMetadata=function(n,t,i){var u=null,o=this,r,f,e;return n=n||{},r=n.async,r==null&&(r=!this.ajaxProvider.syncSupported),f=n.timeout||this.ajaxTimeout||b.ajaxTimeout,e=n.extra,this.ajaxProvider.doAjax(this.uri+"Metadata","GET",this.dataType,this.contentType,null,r,f,e,null,function(n,i,r){u=o.serializationService.deserialize(n);t(u,i,r)},i),u},n.createEntityAsync=function(n,t,i,r,u){var f,e,o;v.isFunction(n)&&(n=c.getFuncName(n));f=this;i=i||{};e=i.makeObservable;e==null&&(e=!0);o=i.async;o==null&&(o=b.workAsync);var h=i.timeout||this.ajaxTimeout||b.ajaxTimeout,l=i.extra,s=f.uri+"CreateType?typeName="+n+"&initialValues=";t!=null&&(s+=f.serializationService.serialize(t));this.ajaxProvider.doAjax(s,"GET",this.dataType,this.contentType,null,o,h,l,null,function(n,t,i){n=f.serializationService.deserialize(n);var u=f.fixResults(n,e);r(n,u,t,i)},function(n){u(n)})},n.executeQuery=function(n,t,i,r){var u=this.toBeetleQueryParams(n,t&&t.varContext);return this.executeQueryParams(n.resource,u,t,i,r)},n.executeQueryParams=function(n,t,r,u,f){var o,a,y,k,p,w;r=r||{};var d=r.makeObservable,g=r.handleUnmappedProperties,nt=r.usePost||!1,tt=r.dataType||this.dataType,it=r.contentType||this.contentType,h=r.async;h==null&&(h=b.workAsync);var rt=r.timeout||this.ajaxTimeout||b.ajaxTimeout,ut=r.extra,s=r.method||"GET",l=null,e=r.uri||this.uri||"";e&&e[e.length-1]!="/"&&(e+="/");e=e+n;nt===!0&&(s="POST");s=="GET"||s=="DELETE"?(a=[],c.forEach(t,function(n){a.push(n.name+"="+encodeURIComponent(n.value))}),o=a.join("&"),e+="?"+o):(y={},c.forEach(t,function(n){y[n.name]=n.value}),l=this.serializationService.serialize(y),o=l);k=i(o);p={"x-beetle-request":k,"x-beetle-request-len":o.length};c.extend(p,r.headers);w=this;this.ajaxProvider.doAjax(e,s,tt,it,l,h,rt,ut,p,function(n,t,i){var r,f;try{n=w.serializationService.deserialize(n)}catch(e){}n!=null&&n.$d!=null&&(n=n.$d);r=null;n&&(f=!1,v.isArray(n)||(n=[n],f=!0),r=w.fixResults(n,d,g),f&&(n=n[0]));u(n,r,t,i)},function(n){f(n)})},n.saveChanges=function(n,t,r,u){var s=this,e,h;t=t||{};e=t.async;e==null&&(e=b.workAsync);var a=t.timeout||this.ajaxTimeout||b.ajaxTimeout,v=t.extra,f=t.uri||this.uri||"";f&&f[f.length-1]!="/"&&(f+="/");h=t.saveAction||"SaveChanges";f=f+h;var o=this.serializationService.serialize(n),y=i(o),l={"x-beetle-request":y,"x-beetle-request-len":o.length},p=t.method||"POST";c.extend(l,t.headers);this.ajaxProvider.doAjax(f,p,this.dataType,this.contentType,o,e,a,v,l,function(n,t,i){try{n=s.serializationService.deserialize(n)}catch(u){}n&&(s.fixResults(n,!1,null),delete n.$id,delete n.$type);r(n,t,i)},function(n){u(n)})},n.fixResults=function(n,t,i){function f(n){var h=n.$id,o,e,s;delete n.$id;r[h-1]=n;for(o in n)o!=="$type"&&(e=n[o],e!=null&&(e.$ref?n[o]=r[e.$ref-1]:e.$id?f(e):v.isArray(e)?u.fixResults(e,t,i,r):i!==!1&&(n[o]=p.dataTypes.handle(e))));t!==!1&&(s=n.$type,u.toEntity(n,s))}var u=this,r=arguments[3]||[];return v.isArray(n)||(n=[n]),i==null&&(i=b.handleUnmappedProperties),c.forEach(n,function(e,o){e!=null&&(e.$ref?n[o]=r[e.$ref-1]:e.$id?f(e):v.isArray(e)?u.fixResults(e,t,i,r):i!==!1&&(n[o]=p.dataTypes.handle(e)))}),r},t}(),n.WebApiService=function(){var t=function(n,t,i){tt.MvcService.call(this,n,t,i);this.useBeetleQueryStrings=!1},i;return c.inherit(t,n.MvcService),i=t.prototype,i.executeQuery=function(n,t,i,r){var u,f,e;return t=t||{},f=t.varContext,e=t.useBeetleQueryStrings!=null?t.useBeetleQueryStrings:this.useBeetleQueryStrings,e===!0?u=this.toBeetleQueryParams(n,f):n.isMultiTyped===!0?(u=this.toBeetleQueryParams(n,f),nt.warning.notify({message:a.beetleQueryChosenMultiTyped,query:n,options:t})):t.usePost?(u=this.toBeetleQueryParams(n,f),nt.warning.notify({message:a.beetleQueryChosenPost,query:n,options:t})):u=this.toODataQueryParams(n,f),this.executeQueryParams(n.resource,u,t,i,r)},t}(),n}(),y=function(){return{entityStates:new k.Enum("Detached","Unchanged","Added","Deleted","Modified"),langOperators:function(){var n=function(n,t,i,r,u){this.name=n;this.code=t;this.asFunc=i;this.oData=r;this.js=u||t},t=[];return t.push(new n("Not","!",function(n){return!n()},"not ")),t.push(new n("Negative","-",function(n){return-1*n()})),t.push(new n("And","&&",function(n,t){return n()&&t()},"and")),t.push(new n("Or","||",function(n,t){return n()||t()},"or")),t.push(new n("Equals","==",function(n,t){return c.equals(n(),t(),!1,this)},"eq")),t.push(new n("StrictEquals","==",function(n,t){return c.equals(n(),t(),!0,this)},"eq","===")),t.push(new n("NotEqual","!=",function(n,t){return!c.equals(n(),t(),!1,this)},"ne")),t.push(new n("StrictNotEqual","!=",function(n,t){return!c.equals(n(),t(),!0,this)},"ne","!==")),t.push(new n("Greater",">",function(n,t){return n()>t()},"gt")),t.push(new n("Lesser","<",function(n,t){return n()<t()},"lt")),t.push(new n("GreaterEqual",">=",function(n,t){var i=n(),r=t();return i==r||i>r},"ge")),t.push(new n("LesserEqual","<=",function(n,t){var i=n(),r=t();return i==r||i<r},"le")),t.push(new n("Sum","+",function(n,t){return n()+t()},"add")),t.push(new n("Subtract","-",function(n,t){return n()-t()},"sub")),t.push(new n("Multiply","*",function(n,t){return n()*t()},"mul")),t.push(new n("Divide","/",function(n,t){return n()/t()},"div")),t.push(new n("Modulo","%",function(n,t){return n()%t()},"mod")),t.push(new n("BitAnd","&",function(n,t){return n()&t()})),t.push(new n("BitOr","|",function(n,t){return n()|t()})),t.push(new n("BitShiftLeft","<<",function(n,t){return n()<<t()})),t.push(new n("BitShiftRight",">>",function(n,t){return n()>>t()})),n.find=function(n){var i=c.filterArray(t,function(t){return t.code==n||t.oData==n||t.js==n});return i.length>0?i[0]:null},n}(),mergeStrategy:new k.Enum("Preserve","Overwrite","ThrowError","NoTracking","NoTrackingRaw"),executionStrategy:new k.Enum("Server","Local","Both","LocalIfEmptyServer"),generationPattern:new k.Enum("Identity","Computed"),arraySetBehaviour:new k.Enum("NotAllowed","Replace","Append"),serviceTypes:new k.Enum("WebApi","Mvc")}}(),nt=function(){return{queryExecuting:new p.Event("beetleQueryExecuting",this),queryExecuted:new p.Event("beetleQueryExecuted",this),saving:new p.Event("beetleSaving",this),saved:new p.Event("beetleSaved",this),info:new p.Event("beetleInfo",this),warning:new p.Event("beetleWarning",this),error:new p.Event("beetleError",this)}}(),b=function(){function s(n,t,i){var u,r,f;if(t&&v.isInstanceOf(n,t))return n;if(i!=null){if(v.isNotEmptyString(n))for(u=i.symbols(),r=0;r<u.length;r++)if(f=u[r],c.equals(f.name,n,!1,{isCaseSensitive:!1,ignoreWhiteSpaces:!1})){n=f;break}if(v.isEnum(n,i))return n.instance}throw c.createError(a.invalidArguments,null,{args:arguments});}var p,h,w;p=r?new g.KoObservableProvider(r):new g.PropertyObservableProvider;u?h=new g.QPromiseProvider(u):i?h=new g.AngularjsPromiseProvider(i):Promise?h=new g.Es6PromiseProvider:t&&(h=new g.JQueryPromiseProvider(t));w=i?new g.AngularjsAjaxProvider(i):o?new g.AngularAjaxProvider(o):t?new g.JQueryAjaxProvider(t):f?new g.NodejsAjaxProvider(f,e):new g.VanillajsAjaxProvider;var b=new g.JsonSerializationService,k=y.arraySetBehaviour.NotAllowed,d=y.serviceTypes.WebApi,nt=new g.DefaultDateConverter,tt,n={};return n.autoFixScalar=!0,n.autoFixPlural=!1,n.validateOnMerge=!0,n.validateOnSave=!0,n.liveValidate=!0,n.handleUnmappedProperties=!0,n.isCaseSensitive=!1,n.ignoreWhiteSpaces=!1,n.forceUpdate=!1,n.cacheMetadata=!0,n.registerMetadataTypes=!1,n.workAsync=!0,n.ajaxTimeout=null,n.minimizePackage=!1,n.getObservableProvider=function(){return p},n.setObservableProvider=function(n){p=s(n,l.ObservableProviderBase)},n.getPromiseProvider=function(){return h},n.setPromiseProvider=function(n){h=s(n,l.PromiseProviderBase)},n.getAjaxProvider=function(){return w},n.setAjaxProvider=function(n){w=s(n,l.AjaxProviderBase)},n.getSerializationService=function(){return b},n.setSerializationService=function(n){b=s(n,l.SerializationServiceBase)},n.getArraySetBehaviour=function(){return k},n.setArraySetBehaviour=function(n){k=s(n,null,y.arraySetBehaviour)},n.getDefaultServiceType=function(){return d},n.setDefaultServiceType=function(n){d=s(n,null,y.serviceTypes)},n.getDateConverter=function(){return nt},n.setDateConverter=function(n){nt=s(n,l.DateConverterBase)},n.getLocalizeFunction=function(){return tt},n.setLocalizeFunction=function(n){c.assertPrm(n,"func").isFunction().check();tt=n},n}(),a={argCountMismatch:'Argument count mismatch for "%0".',arrayEmpty:"The array does not contain any element.",arrayNotSingle:"The array does not contain exactly one element.",arrayNotSingleOrEmpty:"The array does not contain zero or one element.",assignError:"Cannot set %0 property with %1.",assignErrorNotEntity:"Cannot set %0 property, value is not an entity.",autoGeneratedCannotBeModified:"Auto generated properties cannot be modified.",beetleQueryChosenMultiTyped:"Beetle query string is used because query is multi-typed.",beetleQueryChosenPost:"Beetle query string is used because query method is POST.",beetleQueryNotSupported:"Beetle queries are not supported, you may use only OData query parameters (where, orderBy, select, expand, top, skip).",cannotBeEmptyString:"%0 value can not be empty string.",cannotCheckInstanceOnNull:"Cannot check instance on null value.",cannotDetachComplexTypeWithOwners:"Complex types with owners cannot be detached.",compareError:"%0 property value must be equal with %1.",complexCannotBeNull:"%0 complex property can not be null.",couldNotLoadMetadata:"Could not load metadata.",couldNotLocateNavFixer:"Could not locate any observable provider.",couldNotLocatePromiseProvider:"Could not locate any promise provider.",couldNotParseToken:"Could not parse %0.",countDiffCantBeCalculatedForGrouped:'In-line count difference can not be calculated when query contains a "groupBy" expression',dataPropertyAlreadyExists:"Data property already exists: %0.",entityAlreadyBeingTracked:"Entity is already being tracked by another manager.",entityNotBeingTracked:"Entity is not being tracked by a manager.",executionBothNotAllowedForNoTracking:"Execution strategy cannot be Both when merge strategy is NoTracking or NoTrackingRaw.",expressionCouldNotBeFound:"Expression could not be found.",functionNeedsAlias:"%0 function needs alias to work properly. You can set alias like Linq, p => p.Name.",functionNotSupportedForOData:"OData does not support %0 function.",instanceError:"%0 is not an instance of %1.",invalidArguments:"Invalid arguments.",invalidDefaultValue:"%0 is not a valid default value for %0.",invalidEnumValue:"Invalid enum value, %0 cannot be found in %1.",invalidExpression:"%0 can only have %1 type expressions.",invalidPropertyAlias:"Invalid property alias.",invalidStatement:"Invalid statement.",invalidValue:"Invalid value for %0 property.",managerInvalidArgs:"Invalid arguments. Valid args are: {DataService, [Injections]} or {Uri, [Metadata], [Injections]}.",maxLenError:"%0 property length cannot exceed %1.",maxPrecisionError:"Value %0 exceeded maximum precision of %1.",mergeStateError:"Cannot merge entities with %0 state.",minLenError:"%0 property length must be greater than %1.",noMetadataEntityQuery:"Cannot create entity query when no metadata is available.",noMetadataRegisterCtor:"Cannot register constructor when no metadata is available.",noOpenGroup:"Could not find any open group.",notFoundInMetadata:"Could not find %0 in metadata.",notImplemented:"%0 %1 is not implemented.",notNullable:"Cannot set %0 with null, property is not nullable.",oDataNotSupportMultiTyped:"Multi-Typed queries cannot be used for OData services.",odataDoesNotSupportAlias:"OData services does not support query alias and primitive typed resources.",onlyManagerCreatedCanBeExecuted:"Only queries which are created from a manager can be directly executed.",onlyManagerCreatedCanAcceptEntityShortName:"Only queries which are created from a manager can accept entity type short name parameter.",pendingChanges:"Pending changes",pluralNeedsInverse:"To load plural relations, navigation property must have inverse.",projectionsMustHaveAlias:"All projected values must have a property name or alias.",propertyNotFound:"Could not find property: %0.",queryClosed:"Query is closed, expression cannot be added. Queries must be executed after some expressions like first, single, any, all etc..",rangeError:"%0 property value must be between %1 and %2.",requiredError:"%0 property is required.",sameKeyExists:"There is already an entity with same key in the manager.",sameKeyOnDifferentTypesError:"Two different types of entities cannot have same keys when they are from same inheritance root (%0, %1).",settingArrayNotAllowed:"Setting array property is not allowed, you may change this via beetle.settings.setArraySetBehaviour(behavior).",stringLengthError:"%0 property length must be between %1 and %2.",syncNotSupported:"%0 does not support sync ajax calls.",twoEndCascadeDeleteNotAllowed:"Two-end cascade deletes are not supported.",typeError:"%0 type is not %1.",typeMismatch:"%0 value type mismatch. expected type: %1, given type: %2, value: %3",typeRequiredForLocalQueries:'To execute queries locally, entity type must be provided (createQuery("Entities", "Entity") or createEntityQuery("Entity")).',unclosedQuote:'Unclosed quote in "%0".',unclosedToken:'Unclosed "%0".',unexpectedProperty:'Unexpected property "%0".',unexpectedToken:"Unexpected %0.",unknownDataType:"Unknown data type: %0.",unknownExpression:"Unknown expression.",unknownFunction:"Unknown function: %0.",unknownParameter:"Unknown parameter: %0.",unknownValidator:"Unknown validator type: %0.",unsoppertedState:"Unsupported entity state: %0.",validationErrors:"Validation errors",validationFailed:"Validation failed.",valueCannotBeNull:"Value cannot be null: %0.",operatorNotSupportedForOData:"Operator is not supported for OData: %0."},it={en:a};return{version:"2.2.5",registerI18N:function(n,t,i){it[n]=t;i&&(a=t)},setI18N:function(n){var t=it[n];if(!t)throw new Error("Beetle could not find translation for "+n);a=t},helper:c,Assert:v,libs:k,baseTypes:l,impls:g,metadata:d,querying:w,core:p,services:tt,enums:y,events:nt,settings:b,MetadataManager:d.MetadataManager,EntityManager:p.EntityManager,EntityBase:p.EntityBase,EntitySet:p.EntitySet,WebApiService:tt.WebApiService,MvcService:tt.MvcService,Event:p.Event,Validator:p.Validator,ValueNotifyWrapper:p.ValueNotifyWrapper,entityStates:y.entityStates,mergeStrategy:y.mergeStrategy,executionStrategy:y.executionStrategy,arraySetBehaviour:y.arraySetBehaviour,serviceTypes:y.serviceTypes}});